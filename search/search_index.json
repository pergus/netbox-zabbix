{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Home","text":""},{"location":"#netbox-zabbix-plugin-documentation","title":"NetBox Zabbix Plugin Documentation","text":""},{"location":"#introduction","title":"Introduction","text":"<p>The NetBox Zabbix Plugin connects NetBox with Zabbix, integrating your infrastructure documentation with your monitoring system. It automates the synchronization of devices, virtual machines, and their associated monitoring configurations, keeping both platforms aligned.</p>"},{"location":"#objectives","title":"Objectives","text":"<p>The plugin automates synchronization between NetBox and Zabbix, acting as a bridge between infrastructure documentation and monitoring. Its key goals include:</p> <ul> <li>Full lifecycle management for Zabbix hosts from NetBox including creation, configuration, and deletion</li> <li>Import existing Zabbix hosts into NetBox</li> <li>Automatically assigning settings to devices and VMs based on their type and role, including which templates, host groups, and proxies to use</li> <li>Managing proxies, proxy groups, and host groups directly from NetBox</li> <li>Scheduling and managing maintenance windows</li> </ul>"},{"location":"#non-objectives","title":"Non-Objectives","text":"<p>The plugin does not aim to replace or replicate core Zabbix functionality, nor does it provide direct management of Zabbix server configurations. The focus remains on data synchronization and integration rather than:</p> <ul> <li>Direct management of Zabbix server settings or configurations</li> <li>Replacement of Zabbix web interface for monitoring tasks</li> <li>Management of Zabbix user accounts or permissions</li> <li>Direct manipulation of Zabbix triggers, graphs, or dashboards</li> <li>Providing alerting mechanisms beyond what Zabbix natively offers</li> </ul>"},{"location":"#documentation-overview","title":"Documentation Overview","text":"<p>This documentation is organized for three different audiences:</p>"},{"location":"#1-users","title":"1. Users","text":"<p>If you're using the plugin through the NetBox web interface to manage your monitoring configurations, start with the User Guide. This section covers day-to-day operations like creating and managing hosts, understanding job statuses, and troubleshooting common issues.</p>"},{"location":"#2-administrators","title":"2. Administrators","text":"<p>If you're responsible for configuring and maintaining the plugin, the Admin Guide provides detailed information about settings, mappings, proxies, and system configuration. This section builds on the User Guide and covers advanced administrative tasks.</p>"},{"location":"#3-developers-and-programmers","title":"3. Developers and Programmers","text":"<p>If you're extending the plugin, integrating it with other systems, or need to understand the internal workings, the Programmer's Guide provides technical documentation about the code structure, models, jobs, and APIs.</p>"},{"location":"#getting-started","title":"Getting Started","text":"<p>Choose your poision below:</p> <ul> <li>Installation - Plugin installation and initial setup</li> <li>User Guide - For day-to-day use of the plugin</li> <li>Admin Guide - For plugin configuration and administration</li> <li>Programmer's Guide - For developers and advanced customization</li> </ul>"},{"location":"admin_guide/","title":"Admin Guide","text":""},{"location":"admin_guide/#netbox-zabbix-plugin-admin-guide","title":"NetBox Zabbix Plugin Admin Guide","text":""},{"location":"admin_guide/#overview","title":"Overview","text":"<p>This guide is designed for Administrators responsible for configuring and maintaining the NetBox Zabbix plugin. It covers configuration, management of monitoring objects, system jobs, and administrative tasks.</p>"},{"location":"admin_guide/#plugin-configuration","title":"Plugin Configuration","text":""},{"location":"admin_guide/#initial-setup-review","title":"Initial Setup Review","text":"<p>After installation, administrators should review several critical configuration areas to ensure proper operation. Connection settings must be verified to confirm that the plugin can successfully communicate with the Zabbix API endpoint. Security configuration requires careful attention to token permissions and key storage practices to protect sensitive credentials. Default device and virtual machine mappings should be reviewed and adjusted to match organizational requirements, ensuring appropriate monitoring policies are applied automatically. System job intervals need to be configured based on environment size and change frequency to balance synchronization needs with system performance.</p>"},{"location":"admin_guide/#settings-management","title":"Settings Management","text":"<p>Administrators access Settings through the Zabbix plugin menu under Admin \u2192 Settings. Each setting includes a descriptive name and a default vaule when possible.</p> Setting Default Value Description Name N/A (Required) Human-readable identifier for this settings configuration IP Assignment Method PRIMARY Method used to assign IPs to host interfaces Event Log Enabled False Enable or disable logging of plugin events Validate Importables False Automatically validate hosts eligible for import from Zabbix Validate Quick Add False Automatically validate hosts eligible for Quick Add Max Deletions On Import 3 Limit deletions of stale entries during Zabbix imports Maximum Success Notifications 3 Max number of success messages shown per job Zabbix Import Interval Daily Interval in minutes between each Zabbix import Host Config Sync Interval Daily Interval in minutes between Host Config Sync checks Host Config Sync Cutoff 60 Minutes to look back when determining which HostConfigs need syncing Maintenance Cleanup Interval Daily Interval in minutes between maintenance cleanups Version None Zabbix server version (auto-detected) API Endpoint N/A (Required) URL to the Zabbix API endpoint Web Address N/A (Required) URL to the Zabbix web interface Connection False Shows if the plugin can successfully connect to Zabbix Last Checked At None Timestamp of last connectivity check Delete Settings SOFT Method for deleting settings (SOFT moves to graveyard, HARD permanent) Host Group (Graveyard) graveyard Host group used for soft-deleted hosts Deleted Host Suffix _archived Suffix appended to soft-deleted hosts Exclusion Custom Field Exclude from Zabbix Custom field to exclude objects from synchronization Exclude Custom Field Enabled False Enable or disable exclusion based on the custom field Use IP IP Connect via IP or DNS name Inventory Mode MANUAL Method for populating inventory in Zabbix Monitored By ZabbixServer Method used to monitor hosts (direct, proxy, or proxy group) TLS Connect PSK TLS mode for outgoing connections TLS Accept PSK TLS mode accepted for incoming connections PSK Identity None Pre-shared key identity for TLS TLS PSK None Pre-shared key for TLS encryption Agent Port 10050 Default port for Zabbix agent connections SNMP Port 161 Default port for SNMP connections SNMP Bulk YES Whether to use bulk SNMP requests SNMP Max Repetitions 10 Max repetition for SNMP bulk requests SNMP Context Name None SNMP context name SNMP Security Name {$SNMPV3_USER} SNMP security name Security Level authPriv SNMP security level Authentication Protocol SHA1 SNMP authentication protocol Authentication Passphrase {$SNMPV3_AUTHPASS} SNMP authentication passphrase Privacy Protocol AES128 SNMP privacy protocol Privacy Passphrase {$SNMPV3_PRIVPASS} SNMP privacy passphrase Default Tag None Tag applied to all hosts Tag Prefix None Prefix added to all tags Tag Name Formatting KEEP Formatting method for tag names"},{"location":"admin_guide/#mappings-management","title":"Mappings Management","text":"<p>Mappings automate assignment of Zabbix monitoring settings to Devices and VMs in NetBox. They allow hosts to be automatically associated with host groups, templates, and proxies based on characteristics.</p>"},{"location":"admin_guide/#how-mappings-work","title":"How Mappings Work","text":"<p>When creating a new host configuration, the plugin evaluates all non-default mappings for that host type and compares the host's characteristics against mapping rules. The evaluation process considers site membership, role assignments, platform types, and interface configurations to find the most appropriate match. The system applies the most specific mapping available, favoring mappings with more defined filters over broader rules. If no specific mapping matches the host's characteristics, the default mapping is automatically applied to ensure basic monitoring coverage.</p>"},{"location":"admin_guide/#mapping-types","title":"Mapping Types","text":"<ul> <li>Device Mappings: For physical devices.</li> <li>VM Mappings: For virtual machines.</li> </ul> <p>Each mapping defines host groups, templates, proxy or proxy group assignments, interface type restrictions, and optional filters based on sites, roles, or platforms. A default mapping serves as a fallback.</p>"},{"location":"admin_guide/#creating-a-mapping","title":"Creating a Mapping","text":"<ol> <li>Navigate to the Mappings section in the plugin.</li> <li>Select Device Mapping or VM Mapping and click Add.</li> <li>Complete the form with fields such as Name, Host Groups, Templates, Proxy/Proxy Group, Interface Type, Sites, Roles, Platforms, and Description.</li> </ol>"},{"location":"admin_guide/#viewing-matching-objects","title":"Viewing Matching Objects","text":"<p>Click on a mapping name and select \"Matching Devices\" or \"Matching VMs\" to see which objects currently satisfy the mapping criteria.</p>"},{"location":"admin_guide/#proxy-proxy-group-and-host-group-management","title":"Proxy, Proxy Group, and Host Group Management","text":""},{"location":"admin_guide/#proxy-group-management","title":"Proxy Group Management","text":"<ul> <li>Creating: Navigate to Admin &gt; Proxy Groups \u2192 Add, fill out Proxy Group name, Failover period, Minimum proxies, optional Description, and click Create.</li> <li>Editing: Update fields, changes sync automatically with Zabbix.</li> <li>Importing: Import existing groups during setup or manually.</li> <li>Deleting: Removes the group from NetBox; warns if deletion fails in Zabbix.</li> </ul>"},{"location":"admin_guide/#proxy-management","title":"Proxy Management","text":"<ul> <li>Creating: Admin &gt; Proxies \u2192 Add, complete Proxy Name, Proxy Group, Operating Mode, Local/Interface addresses and ports, Allowed Addresses, TLS settings, optional Timeouts, and click Create.</li> <li>Editing: Update fields; changes sync automatically.</li> <li>Importing: Existing proxies can be imported.</li> <li>Deleting: Removes proxy; warns if deletion fails in Zabbix.</li> </ul>"},{"location":"admin_guide/#host-group-management","title":"Host Group Management","text":"<ul> <li>Creating: Admin &gt; Host Groups \u2192 Add, enter Hostgroup Name and optional description, click Create.</li> <li>Editing: Update names or descriptions; syncs automatically.</li> <li>Importing: Import existing groups.</li> <li>Deleting: Removes groups; warns if Zabbix deletion fails.</li> </ul>"},{"location":"admin_guide/#best-practices","title":"Best Practices","text":"<ul> <li>Use descriptive names.</li> <li>Ensure at least one proxy online per group.</li> <li>Regularly review and update proxies and groups.</li> <li>Validate imported objects maintain correct linkage.</li> </ul>"},{"location":"admin_guide/#system-job-configuration","title":"System Job Configuration","text":"<p>Background jobs automate tasks like host creation, synchronization, and maintenance.</p> <ul> <li>Job Types: Zabbix Import, Host Config Sync, Maintenance Cleanup.</li> <li>Intervals: Adjust frequencies based on environment size and criticality.</li> <li>Monitoring: View Job History, track performance metrics, and trigger manual execution as needed.</li> </ul>"},{"location":"admin_guide/#monitoring-and-maintenance","title":"Monitoring and Maintenance","text":""},{"location":"admin_guide/#health-checks","title":"Health Checks","text":"<ul> <li>Connection Status: Verify Zabbix API connectivity.</li> <li>Job Health: Ensure scheduled jobs run successfully.</li> <li>Synchronization Status: Detect out-of-sync hosts.</li> <li>Resource Usage: Monitor database and system performance.</li> </ul> <p>For day-to-day user operations, see the User Guide. For technical implementation details, see the Programmer's Guide.</p>"},{"location":"agentinterface_model/","title":"AgentInterface Model","text":""},{"location":"agentinterface_model/#agentinterface-model","title":"AgentInterface Model","text":""},{"location":"agentinterface_model/#overview","title":"Overview","text":"<p>The <code>AgentInterface</code> model represents a Zabbix agent interface linked to a HostConfig, defining how a monitored host communicates with Zabbix via the Zabbix agent protocol.</p>"},{"location":"agentinterface_model/#model-definition","title":"Model Definition","text":"<p>AgentInterface extends the BaseInterface abstract model and adds fields specific to Zabbix agent monitoring. It defines the configuration for Zabbix agent monitoring, including connection details like IP address, port, and whether this is the primary interface for the host.</p>"},{"location":"agentinterface_model/#fields","title":"Fields","text":"<p>Inherits all fields from BaseInterface plus:</p> Field Type Description Notes <code>host_config</code> ForeignKey (HostConfig) Link to the parent HostConfig related_name=\"agent_interfaces\" <code>interface_type</code> ForeignKey (ContentType) Content type of the associated NetBox interface Limited to Interface or VMInterface models <code>interface_id</code> PositiveIntegerField ID of the associated NetBox interface <code>interface</code> GenericForeignKey Generic foreign key to the NetBox interface <code>ip_address</code> ForeignKey (IPAddress) Associated IP address from NetBox IPAM related_name=\"agent_interface\", nullable <code>type</code> IntegerField Interface type Choices from TypeChoices, default=AGENT <code>port</code> IntegerField Port number used by the interface Default=10050"},{"location":"agentinterface_model/#methods","title":"Methods","text":""},{"location":"agentinterface_model/#saveargs-kwargs","title":"<code>save(*args, **kwargs)</code>","text":"<p>Ensure only one main AgentInterface exists per host_config and validate the instance.</p> <p>Parameters: - <code>*args</code>: Positional arguments passed to the parent save method - <code>**kwargs</code>: Keyword arguments passed to the parent save method</p> <p>Raises: - <code>ValidationError</code>: If the model is invalid</p>"},{"location":"agentinterface_model/#__str__","title":"<code>__str__()</code>","text":"<p>Return a string representation of the agent interface.</p> <p>Returns: - <code>str</code>: String representation of the agent interface</p>"},{"location":"agentinterface_model/#clean","title":"<code>clean()</code>","text":"<p>Validate that the assigned IP address matches the interface.</p> <p>Raises: - <code>ValidationError</code>: If IP does not belong to the selected interface</p>"},{"location":"agentinterface_model/#get_absolute_url","title":"<code>get_absolute_url()</code>","text":"<p>Return the canonical URL for this agent interface within the NetBox plugin UI.</p> <p>Returns: - <code>str</code>: Absolute URL for the agent interface</p>"},{"location":"agentinterface_model/#usage-examples","title":"Usage Examples","text":""},{"location":"agentinterface_model/#creating-an-agent-interface","title":"Creating an Agent Interface","text":"<pre><code>from netbox_zabbix.models import AgentInterface, HostConfig\nfrom dcim.models import Interface\nfrom ipam.models import IPAddress\n\n# Get the host configuration\nhost_config = HostConfig.objects.get(name=\"z-web-server-01\")\n\n# Get the NetBox interface\nnetbox_interface = Interface.objects.get(name=\"eth0\", device__name=\"web-server-01\")\n\n# Get the IP address\nip_address = IPAddress.objects.get(address=\"192.168.1.100/24\")\n\n# Create an agent interface\nagent_interface = AgentInterface.objects.create(\n    host_config=host_config,\n    interface=netbox_interface,\n    ip_address=ip_address,\n    port=10050,\n    useip=1,  # Use IP\n    main=1    # Main interface\n)\n</code></pre>"},{"location":"agentinterface_model/#working-with-agent-interface-properties","title":"Working with Agent Interface Properties","text":"<pre><code># Access resolved IP address\nip_address = agent_interface.resolved_ip_address\nif ip_address:\n    print(f\"Agent connecting on IP: {ip_address}\")\n\n# Access resolved DNS name\ndns_name = agent_interface.resolved_dns_name\nif dns_name:\n    print(f\"Agent connecting on DNS: {dns_name}\")\n\n# Check if this is the main interface\nif agent_interface.main == 1:\n    print(\"This is the main agent interface\")\n</code></pre>"},{"location":"agentinterface_model/#updating-agent-interface-configuration","title":"Updating Agent Interface Configuration","text":"<pre><code># Change the port\nagent_interface.port = 10051\nagent_interface.save()\n\n# Change to DNS connection\nagent_interface.useip = 0  # Use DNS\nagent_interface.save()\n\n# Change main interface status\nagent_interface.main = 0  # Not main\nagent_interface.save()\n</code></pre>"},{"location":"agentinterface_model/#integration-with-other-models","title":"Integration with Other Models","text":"<p>AgentInterface integrates with several other models in the plugin:</p> <ol> <li> <p>HostConfig Model: AgentInterface instances are associated with specific HostConfig objects through a foreign key relationship.</p> </li> <li> <p>BaseInterface Model: AgentInterface inherits from BaseInterface, sharing common interface functionality.</p> </li> <li> <p>NetBox Interface Model: AgentInterface links to NetBox Interface objects for device/VLAN information.</p> </li> <li> <p>NetBox VMInterface Model: AgentInterface can also link to NetBox VMInterface objects for virtual machine interfaces.</p> </li> <li> <p>NetBox IPAddress Model: AgentInterface links to NetBox IPAddress objects for IP connectivity.</p> </li> </ol>"},{"location":"agentinterface_model/#description","title":"Description","text":"<p>AgentInterface objects define the configuration for Zabbix agent monitoring, including connection details like IP address, port, and whether this is the primary interface for the host.</p> <p>Key features: - Links to a specific HostConfig object - Associates with NetBox Interface or VMInterface objects through generic foreign keys - Can reference a specific IP address from NetBox IPAM - Configures agent communication port (default 10050) - Supports designation as the main interface for the host - Ensures only one main agent interface exists per host configuration - Validates that assigned IP addresses belong to the selected interface</p> <p>The model automatically handles ensuring that only one agent interface is marked as \"main\" per host configuration, updating other interfaces if needed when changing the main interface designation. This prevents configuration conflicts in Zabbix where multiple main interfaces could cause monitoring issues.</p>"},{"location":"baseinterface_model/","title":"BaseInterface Model","text":""},{"location":"baseinterface_model/#baseinterface-model","title":"BaseInterface Model","text":""},{"location":"baseinterface_model/#overview","title":"Overview","text":"<p>The <code>BaseInterface</code> model is an abstract base class that defines common fields and functionality for both AgentInterface and SNMPInterface models.</p>"},{"location":"baseinterface_model/#model-definition","title":"Model Definition","text":"<p>BaseInterface is an abstract Django model that provides shared functionality for both agent and SNMP interfaces. It is an abstract model, meaning no database table is created for it directly. Instead, it serves as a parent class for AgentInterface and SNMPInterface models.</p>"},{"location":"baseinterface_model/#fields","title":"Fields","text":"Field Type Description Notes <code>name</code> CharField (max_length=255) Name for the interface in NetBox Required <code>hostid</code> IntegerField Zabbix Host ID Collected from Zabbix, nullable <code>interfaceid</code> IntegerField Zabbix Interface ID Collected from Zabbix, nullable <code>useip</code> IntegerField Whether connection should be made via IP or DNS Choices from UseIPChoices, default=IP <code>main</code> IntegerField Whether the interface is used as default on the host Choices from MainChoices, default=YES"},{"location":"baseinterface_model/#properties","title":"Properties","text":""},{"location":"baseinterface_model/#resolved_dns_name","title":"<code>resolved_dns_name</code>","text":"<p>Return DNS name for this interface based on the plugin IP assignment method.</p> <p>Returns: - <code>str</code> or <code>None</code>: DNS name if available</p>"},{"location":"baseinterface_model/#resolved_ip_address","title":"<code>resolved_ip_address</code>","text":"<p>Return IP address for this interface based on the plugin IP assignment method.</p> <p>Returns: - <code>IPAddress</code> or <code>None</code>: IP address object if available</p>"},{"location":"baseinterface_model/#methods","title":"Methods","text":""},{"location":"baseinterface_model/#clean","title":"<code>clean()</code>","text":"<p>Validate that the assigned IP address matches the interface.</p> <p>Raises: - <code>ValidationError</code>: If IP does not belong to the selected interface</p>"},{"location":"baseinterface_model/#__str__","title":"<code>__str__()</code>","text":"<p>Return a string representation of the interface.</p> <p>Returns: - <code>str</code>: String representation of the interface</p>"},{"location":"baseinterface_model/#usage-examples","title":"Usage Examples","text":""},{"location":"baseinterface_model/#accessing-interface-properties","title":"Accessing Interface Properties","text":"<pre><code>from netbox_zabbix.models import AgentInterface\n\n# Get an agent interface\nagent_interface = AgentInterface.objects.get(name=\"eth0\")\n\n# Access resolved IP address\nip_address = agent_interface.resolved_ip_address\nif ip_address:\n    print(f\"Interface IP: {ip_address}\")\n\n# Access resolved DNS name\ndns_name = agent_interface.resolved_dns_name\nif dns_name:\n    print(f\"Interface DNS: {dns_name}\")\n</code></pre>"},{"location":"baseinterface_model/#checking-interface-configuration","title":"Checking Interface Configuration","text":"<pre><code># Check if interface uses IP or DNS\nif agent_interface.useip == 1:  # Assuming 1 means use IP\n    print(f\"Connecting via IP: {agent_interface.resolved_ip_address}\")\nelse:\n    print(f\"Connecting via DNS: {agent_interface.resolved_dns_name}\")\n\n# Check if interface is main\nif agent_interface.main == 1:  # Assuming 1 means main interface\n    print(\"This is the main interface\")\n</code></pre>"},{"location":"baseinterface_model/#integration-with-other-models","title":"Integration with Other Models","text":"<p>BaseInterface integrates with several other models in the plugin:</p> <ol> <li> <p>HostConfig Model: BaseInterface instances are associated with specific HostConfig objects through a foreign key relationship.</p> </li> <li> <p>AgentInterface Model: Inherits from BaseInterface and adds agent-specific fields.</p> </li> <li> <p>SNMPInterface Model: Inherits from BaseInterface and adds SNMP-specific fields.</p> </li> <li> <p>NetBox Interface Model: Interfaces are linked to NetBox Interface objects for device/VLAN information.</p> </li> <li> <p>NetBox IPAddress Model: IP addresses are linked to NetBox IPAddress objects for IP connectivity.</p> </li> </ol>"},{"location":"baseinterface_model/#description","title":"Description","text":"<p>BaseInterface provides shared functionality for both agent and SNMP interfaces, including connection settings and IP/DNS resolution logic.</p> <p>The model handles: - Interface naming within NetBox - Storage of Zabbix identifiers (hostid, interfaceid) - Connection method configuration (IP vs DNS) - Primary interface designation - IP address and DNS name resolution based on plugin settings - Validation of IP address assignments</p> <p>This abstraction allows both AgentInterface and SNMPInterface to share common functionality while having their own specific fields and behaviors. The abstract nature of this model ensures that only concrete implementations (AgentInterface and SNMPInterface) are stored in the database.</p>"},{"location":"changelog/","title":"Changelog","text":""},{"location":"changelog/#changelog","title":"Changelog","text":""},{"location":"changelog/#200-2025-12-11","title":"2.0.0 (2025-12-11)","text":""},{"location":"contributing/","title":"Contributing","text":""},{"location":"contributing/#contributing","title":"Contributing","text":"<p>Contributions are welcome, and they are greatly appreciated! Every little bit helps, and credit will always be given.</p> <p>We love your input! We want to make contributing to this project as easy and transparent as possible, whether it's:</p> <ul> <li>Reporting a bug</li> <li>Discussing the current state of the code</li> <li>Submitting a fix</li> <li>Proposing new features</li> <li>Becoming a maintainer</li> </ul>"},{"location":"contributing/#general-tips-for-working-on-github","title":"General Tips for Working on GitHub","text":"<ul> <li>Register for a free GitHub account if you haven't already.</li> <li>You can use GitHub Markdown for formatting text and adding images.</li> <li>To help mitigate notification spam, please avoid \"bumping\" issues with no activity. (To vote an issue up or down, use a  or  reaction.)</li> <li>Please avoid pinging members with <code>@</code> unless they've previously expressed interest or involvement with that particular issue.</li> <li>Familiarize yourself with this list of discussion anti-patterns and make every effort to avoid them.</li> </ul>"},{"location":"contributing/#types-of-contributions","title":"Types of Contributions","text":""},{"location":"contributing/#report-bugs","title":"Report Bugs","text":"<p>Report bugs at https://github.com/pergus/netbox-zabbix/issues.</p> <p>If you are reporting a bug, please include:</p> <ul> <li>Your operating system name and version.</li> <li>Any details about your local setup that might be helpful in troubleshooting.</li> <li>Detailed steps to reproduce the bug.</li> </ul>"},{"location":"contributing/#fix-bugs","title":"Fix Bugs","text":"<p>Look through the GitHub issues for bugs. Anything tagged with \"bug\" and \"help wanted\" is open to whoever wants to implement it.</p>"},{"location":"contributing/#implement-features","title":"Implement Features","text":"<p>Look through the GitHub issues for features. Anything tagged with \"enhancement\" and \"help wanted\" is open to whoever wants to implement it.</p>"},{"location":"contributing/#write-documentation","title":"Write Documentation","text":"<p>netbox-zabbix could always use more documentation, whether as part of the official netbox-zabbix docs, in docstrings, or even on the web in blog posts, articles, and such.</p>"},{"location":"contributing/#submit-feedback","title":"Submit Feedback","text":"<p>The best way to send feedback is to file an issue at https://github.com/pergus/netbox-zabbix/issues.</p> <p>If you are proposing a feature:</p> <ul> <li>Explain in detail how it would work.</li> <li>Keep the scope as narrow as possible, to make it easier to implement.</li> <li>Remember that this is a volunteer-driven project, and that contributions   are welcome :)</li> </ul>"},{"location":"contributing/#get-started","title":"Get Started!","text":"<p>Ready to contribute? Here's how to set up <code>netbox-zabbix</code> for local development.</p> <ol> <li>Fork the <code>netbox-zabbix</code> repo on GitHub.</li> <li> <p>Clone your fork locally</p> <pre><code>$ git clone git@github.com:your_name_here/netbox-zabbix.git\n</code></pre> </li> <li> <p>Activate the NetBox virtual environment (see the NetBox documentation under Setting up a Development Environment):</p> <pre><code>$ source ~/.venv/netbox/bin/activate\n</code></pre> </li> <li> <p>Add the plugin to NetBox virtual environment in Develop mode (see Plugins Development):</p> <p>To ease development, it is recommended to go ahead and install the plugin at this point using setuptools' develop mode. This will create symbolic links within your Python environment to the plugin development directory. Call setup.py from the plugin's root directory with the develop argument (instead of install):</p> <pre><code>$ python setup.py develop\n</code></pre> </li> <li> <p>Create a branch for local development:</p> <pre><code>$ git checkout -b name-of-your-bugfix-or-feature\n</code></pre> <p>Now you can make your changes locally.</p> </li> <li> <p>Commit your changes and push your branch to GitHub:</p> <pre><code>$ git add .\n$ git commit -m \"Your detailed description of your changes.\"\n$ git push origin name-of-your-bugfix-or-feature\n</code></pre> </li> <li> <p>Submit a pull request through the GitHub website.</p> </li> </ol>"},{"location":"contributing/#pull-request-guidelines","title":"Pull Request Guidelines","text":"<p>Before you submit a pull request, check that it meets these guidelines:</p> <ol> <li>The pull request should include tests.</li> <li>If the pull request adds functionality, the docs should be updated. Put    your new functionality into a function with a docstring, and add the    feature to the list in README.md.</li> <li>The pull request should work for Python 3.8, 3.9, 3.10 and 3.11. Check    https://github.com/pergus/netbox-zabbix/actions    and make sure that the tests pass for all supported Python versions.</li> </ol>"},{"location":"contributing/#deploying","title":"Deploying","text":"<p>A reminder for the maintainers on how to deploy. Make sure all your changes are committed (including an entry in CHANGELOG.md) and that all tests pass. Then in the github project go to <code>Releases</code> and create a new release with a new tag.  This will automatically upload the release to pypi:</p>"},{"location":"devicemapping_model/","title":"DeviceMapping Model","text":""},{"location":"devicemapping_model/#devicemapping-model","title":"DeviceMapping Model","text":""},{"location":"devicemapping_model/#overview","title":"Overview","text":"<p>The <code>DeviceMapping</code> model defines how NetBox Device objects should be mapped to Zabbix host configurations, including templates, host groups, proxies, and filtering criteria.</p>"},{"location":"devicemapping_model/#model-definition","title":"Model Definition","text":"<p>DeviceMapping inherits from the base <code>Mapping</code> model and provides specific functionality for mapping NetBox Device objects to Zabbix configurations.</p>"},{"location":"devicemapping_model/#fields","title":"Fields","text":"<p>Inherits all fields from the base <code>Mapping</code> model:</p> Field Type Description Notes <code>name</code> CharField (max_length=255) Name of the mapping Human-readable identifier <code>description</code> TextField Optional description May be blank <code>default</code> BooleanField Whether this is the default mapping Only one default mapping allowed <code>host_groups</code> ManyToManyField (HostGroup) Assigned Host Groups Used for matching hosts <code>templates</code> ManyToManyField (Template) Assigned Templates Multiple templates can be selected <code>proxy</code> ForeignKey (Proxy) Assigned Proxy Optional proxy for matching hosts <code>proxy_group</code> ForeignKey (ProxyGroup) Assigned Proxy Group Optional proxy group for matching hosts <code>interface_type</code> IntegerField Limit mapping to specific interface types Default: Any. Options: Any (0), Agent (1), SNMP (2) <code>sites</code> ManyToManyField (Site) Restrict mapping to specific sites Filter by site <code>roles</code> ManyToManyField (DeviceRole) Restrict mapping to specific device roles Filter by role <code>platforms</code> ManyToManyField (Platform) Restrict mapping to specific platforms Filter by platform"},{"location":"devicemapping_model/#methods","title":"Methods","text":""},{"location":"devicemapping_model/#get_matching_filtercls-device-interface_typeinterfacetypechoicesany","title":"<code>get_matching_filter(cls, device, interface_type=InterfaceTypeChoices.Any)</code>","text":"<p>Return the most specific DeviceMapping that matches a device based on its characteristics.</p> <p>Parameters: - <code>device</code> (Device): Device instance to match - <code>interface_type</code> (int): Interface type to filter by (default: Any)</p> <p>Returns: - <code>DeviceMapping</code>: Matching mapping object</p>"},{"location":"devicemapping_model/#get_matching_devicesself","title":"<code>get_matching_devices(self)</code>","text":"<p>Return queryset of Devices that match this mapping, excluding devices already covered by more specific mappings.</p> <p>Returns: - <code>QuerySet</code>: Matching Device instances</p>"},{"location":"devicemapping_model/#get_absolute_urlself","title":"<code>get_absolute_url(self)</code>","text":"<p>Return URL for the device mapping detail page in the NetBox UI.</p> <p>Returns: - <code>str</code>: Absolute URL for the device mapping</p>"},{"location":"devicemapping_model/#usage-examples","title":"Usage Examples","text":""},{"location":"devicemapping_model/#creating-a-basic-device-mapping","title":"Creating a Basic Device Mapping","text":"<pre><code>from netbox_zabbix.models import DeviceMapping, HostGroup, Template\n\n# Create a basic device mapping\ndevice_mapping = DeviceMapping.objects.create(\n    name=\"Linux Servers\",\n    description=\"Mapping for Linux-based servers\",\n    default=False\n)\n\n# Add host groups and templates\nlinux_host_group = HostGroup.objects.get(name=\"Linux Servers\")\ngeneric_template = Template.objects.get(name=\"Template OS Linux by Zabbix agent\")\n\ndevice_mapping.host_groups.add(linux_host_group)\ndevice_mapping.templates.add(generic_template)\n</code></pre>"},{"location":"devicemapping_model/#creating-a-filtered-device-mapping","title":"Creating a Filtered Device Mapping","text":"<pre><code>from dcim.models import Site, DeviceRole, Platform\n\n# Create a mapping for specific sites and roles\nfiltered_mapping = DeviceMapping.objects.create(\n    name=\"Production Web Servers\",\n    description=\"Web servers in production environment\"\n)\n\n# Add filters\nproduction_site = Site.objects.get(name=\"Production DC\")\nweb_role = DeviceRole.objects.get(name=\"Web Server\")\nlinux_platform = Platform.objects.get(name=\"Ubuntu 20.04\")\n\nfiltered_mapping.sites.add(production_site)\nfiltered_mapping.roles.add(web_role)\nfiltered_mapping.platforms.add(linux_platform)\n</code></pre>"},{"location":"devicemapping_model/#creating-a-default-mapping","title":"Creating a Default Mapping","text":"<pre><code># Create a default mapping that applies to all devices not matched by specific mappings\ndefault_device_mapping = DeviceMapping.objects.create(\n    name=\"Default Device Mapping\",\n    description=\"Default mapping for all unmatched devices\",\n    default=True\n)\n</code></pre>"},{"location":"devicemapping_model/#finding-matching-mappings","title":"Finding Matching Mappings","text":"<pre><code>from dcim.models import Device\nfrom netbox_zabbix.models import DeviceMapping\n\n# Find the appropriate mapping for a device\ndevice = Device.objects.get(name=\"web-server-01\")\nmatching_mapping = DeviceMapping.get_matching_filter(device)\n\n# Get all devices that match a specific mapping\ndevices = matching_mapping.get_matching_devices()\n</code></pre>"},{"location":"devicemapping_model/#integration-with-other-models","title":"Integration with Other Models","text":"<p>DeviceMapping integrates with several other models in the plugin:</p> <ol> <li> <p>HostConfig Model: Device mappings determine which Zabbix configuration is applied to Device objects when they are provisioned for monitoring.</p> </li> <li> <p>Template Model: Templates are assigned to devices through device mappings.</p> </li> <li> <p>HostGroup Model: Host groups are assigned to devices through device mappings.</p> </li> <li> <p>Proxy/ProxyGroup Models: Proxies or proxy groups can be specified for devices through device mappings.</p> </li> </ol>"},{"location":"devicemapping_model/#description","title":"Description","text":"<p>DeviceMapping objects allow administrators to define rules for automatically configuring Zabbix monitoring for NetBox devices based on their characteristics. More specific mappings (those with more filter criteria) take precedence over less specific ones.</p> <p>Mappings can filter devices by: - Site - Role - Platform</p> <p>And can assign: - Templates - Host groups - Proxy or proxy group - Interface type restrictions</p> <p>When a device matches multiple mappings, the most specific one (with the most restrictive filters) is applied. A default mapping should always exist to catch devices that don't match any specific mapping.</p>"},{"location":"eventlog_model/","title":"EventLog Model","text":""},{"location":"eventlog_model/#eventlog-model","title":"EventLog Model","text":""},{"location":"eventlog_model/#overview","title":"Overview","text":"<p>The <code>EventLog</code> model stores logs of plugin events for auditing and troubleshooting purposes.</p>"},{"location":"eventlog_model/#model-definition","title":"Model Definition","text":"<p>EventLog is a NetBoxModel that records plugin activities, job executions, signal handling, and exceptions. It provides an audit trail of plugin activities, including job executions, signal handling, and any exceptions that occurred during operations.</p>"},{"location":"eventlog_model/#fields","title":"Fields","text":"Field Type Description Notes <code>name</code> CharField (max_length=256) Event name verbose_name=\"Name\" <code>job</code> ForeignKey (Job) Reference to the associated job on_delete=CASCADE, nullable, related_name='logs' <code>signal_id</code> TextField Signal ID verbose_name=\"Signal ID\", blank, default=\"\" <code>message</code> TextField Event message verbose_name=\"Message\", blank, default=\"\" <code>exception</code> TextField Exception details verbose_name=\"Exception\", blank, default=\"\" <code>data</code> JSONField Event data verbose_name=\"Data\", nullable, blank, default=dict <code>pre_data</code> JSONField Pre-change data verbose_name=\"Pre-Change Data\", nullable, blank, default=dict <code>post_data</code> JSONField Post-change data verbose_name=\"Post-Change Data\", nullable, blank, default=dict <code>created</code> DateTimeField Creation timestamp verbose_name=\"Created\", auto_now_add=True"},{"location":"eventlog_model/#name","title":"<code>name</code>","text":"<p>A human-readable name for the event that helps identify its purpose or type.</p>"},{"location":"eventlog_model/#job","title":"<code>job</code>","text":"<p>Foreign key relationship to the associated Job object. This allows tracking of job execution events and linking logs to specific background operations.</p>"},{"location":"eventlog_model/#signal_id","title":"<code>signal_id</code>","text":"<p>Identifier for Django signal handling events. This field tracks which signal was triggered, enabling visibility into the plugin's internal operations.</p>"},{"location":"eventlog_model/#message","title":"<code>message</code>","text":"<p>Detailed message about the operation or event. This field provides context about what happened during the logged operation.</p>"},{"location":"eventlog_model/#exception","title":"<code>exception</code>","text":"<p>Exception information for error tracking. When an exception occurs, this field captures the exception details for troubleshooting purposes.</p>"},{"location":"eventlog_model/#data","title":"<code>data</code>","text":"<p>Structured event data stored in JSON format. This field can capture complex Python objects and is useful for storing detailed information about the event.</p>"},{"location":"eventlog_model/#pre_data","title":"<code>pre_data</code>","text":"<p>Data snapshot captured before a change occurred. This field is particularly useful for tracking changes to model instances over time and enabling audit trails.</p>"},{"location":"eventlog_model/#post_data","title":"<code>post_data</code>","text":"<p>Data snapshot captured after a change occurred. Together with <code>pre_data</code>, this enables comparison of object states before and after operations.</p>"},{"location":"eventlog_model/#created","title":"<code>created</code>","text":"<p>Timestamp indicating when the event log entry was created. Entries are ordered chronologically with the newest entries first.</p>"},{"location":"eventlog_model/#methods","title":"Methods","text":""},{"location":"eventlog_model/#get_absolute_url","title":"<code>get_absolute_url()</code>","text":"<p>Return URL for the event log detail page in the NetBox UI.</p> <p>Returns: - <code>str</code>: Absolute URL for the event log</p>"},{"location":"eventlog_model/#get_job_status_color","title":"<code>get_job_status_color()</code>","text":"<p>Return a color representing the status of the associated job.</p> <p>Returns: - <code>str</code>: Hex color or name (e.g., 'red')</p>"},{"location":"eventlog_model/#__str__","title":"<code>__str__()</code>","text":"<p>Return a string representation of the event log.</p> <p>Returns: - <code>str</code>: String representation of the event log</p>"},{"location":"eventlog_model/#usage-examples","title":"Usage Examples","text":""},{"location":"eventlog_model/#viewing-event-logs","title":"Viewing Event Logs","text":"<pre><code>from netbox_zabbix.models import EventLog\n\n# Get recent event logs\nrecent_logs = EventLog.objects.all()[:10]\n\n# Get logs for a specific job\njob_logs = EventLog.objects.filter(job=some_job)\n\n# Get error logs\nerror_logs = EventLog.objects.exclude(exception=\"\")\n\n# Get logs with specific signal\nsignal_logs = EventLog.objects.filter(signal_id=\"device_post_save\")\n</code></pre>"},{"location":"eventlog_model/#analyzing-log-data","title":"Analyzing Log Data","text":"<pre><code># Examine log data\nfor log in recent_logs:\n    print(f\"{log.created}: {log.name}\")\n    if log.message:\n        print(f\"  Message: {log.message}\")\n    if log.exception:\n        print(f\"  Exception: {log.exception}\")\n    if log.data:\n        print(f\"  Data: {log.data}\")\n</code></pre>"},{"location":"eventlog_model/#filtering-by-date-range","title":"Filtering by Date Range","text":"<pre><code>from datetime import datetime, timedelta\n\n# Get logs from the last 24 hours\nyesterday = datetime.now() - timedelta(days=1)\nrecent_logs = EventLog.objects.filter(created__gte=yesterday)\n</code></pre>"},{"location":"eventlog_model/#integration-with-other-models","title":"Integration with Other Models","text":"<p>EventLog integrates with several other models in the plugin:</p> <ol> <li> <p>Job Model: EventLog entries are associated with specific Job objects through a foreign key relationship, allowing tracking of job execution events.</p> </li> <li> <p>All Plugin Models: Event logs can capture data snapshots before and after changes to any plugin model, enabling change tracking and audit trails.</p> </li> <li> <p>Django Signal Framework: Event logs track Django signal handling events, providing visibility into the plugin's internal operations.</p> </li> </ol>"},{"location":"eventlog_model/#description","title":"Description","text":"<p>EventLog objects provide an audit trail of plugin activities, including job executions, signal handling, and any exceptions that occurred during operations. This is useful for troubleshooting and monitoring plugin health.</p> <p>The model captures: - Event names and descriptions - Associated job information - Signal identifiers for tracking Django signal handling - Detailed messages about operations - Exception information for error tracking - Data snapshots before and after changes - Timestamps for chronological ordering</p> <p>Event logs are automatically created by the plugin during various operations: - Job execution (success, failure, progress) - Signal handling (pre-save, post-save, etc.) - Configuration changes - Synchronization operations - Error conditions</p> <p>The data fields store structured information about events in JSON format, making it easy to serialize complex Python objects and deserialize them for display or analysis. The pre_data and post_data fields are particularly useful for tracking changes to model instances over time.</p> <p>Logs are ordered chronologically with the newest entries first, making it easy to see recent activity. The get_job_status_color method provides visual indication of job outcomes in the UI.</p>"},{"location":"hostconfig_models/","title":"HostConfig Models","text":""},{"location":"hostconfig_models/#hostconfig-model","title":"HostConfig Model","text":""},{"location":"hostconfig_models/#overview","title":"Overview","text":"<p>The HostConfig model in the NetBox Zabbix plugin represents the Zabbix host configurations that maintain the relationship between NetBox objects (devices or virtual machines) and their Zabbix monitoring configurations.</p>"},{"location":"hostconfig_models/#model-definition","title":"Model Definition","text":"<p>The HostConfig represents a host configuration in Zabbix and maintains the relationship between NetBox objects (devices or virtual machines) and their Zabbix monitoring configurations. It serves as the bridge between NetBox infrastructure objects and their corresponding Zabbix monitoring configurations.</p>"},{"location":"hostconfig_models/#fields","title":"Fields","text":"Field Type Description Notes <code>name</code> CharField (max_length=200) Host configuration name Unique, auto-generated if not provided <code>hostid</code> PositiveIntegerField Zabbix Host ID Unique, assigned by Zabbix <code>status</code> IntegerField Host monitoring status Default: ENABLED. Options: ENABLED (0), DISABLED (1) <code>in_sync</code> BooleanField Sync status with Zabbix True if configuration matches Zabbix <code>last_sync_update</code> DateTimeField Last sync timestamp When sync status was last updated <code>host_groups</code> ManyToManyField (HostGroup) Assigned host groups Host groups in Zabbix <code>templates</code> ManyToManyField (Template) Assigned templates Templates applied to the host <code>monitored_by</code> IntegerField Monitoring source Default: ZabbixServer. Options: ZabbixServer (0), Proxy (1), ProxyGroup (2) <code>proxy</code> ForeignKey (Proxy) Assigned proxy Proxy for monitoring the host <code>proxy_group</code> ForeignKey (ProxyGroup) Assigned proxy group Proxy group for monitoring the host <code>description</code> TextField Host description Optional description <code>content_type</code> ForeignKey (ContentType) Object type Limited to Device or VirtualMachine <code>object_id</code> PositiveIntegerField Object ID ID of the assigned NetBox object <code>assigned_object</code> GenericForeignKey Assigned object Generic foreign key to Device or VirtualMachine"},{"location":"hostconfig_models/#properties","title":"Properties","text":""},{"location":"hostconfig_models/#has_agent_interface","title":"<code>has_agent_interface</code>","text":"<p>Returns <code>True</code> if this host has at least one AgentInterface assigned.</p>"},{"location":"hostconfig_models/#has_snmp_interface","title":"<code>has_snmp_interface</code>","text":"<p>Returns <code>True</code> if this host has at least one SNMPInterface assigned.</p>"},{"location":"hostconfig_models/#zabbix_tags","title":"<code>zabbix_tags</code>","text":"<p>Returns tags for this host configuration suitable for templates, generated based on the assigned NetBox object and tag mappings.</p>"},{"location":"hostconfig_models/#active_maintenances","title":"<code>active_maintenances</code>","text":"<p>Returns all active Maintenance objects that include this HostConfig, either directly or indirectly through sites, host groups, proxy groups, or clusters.</p>"},{"location":"hostconfig_models/#in_maintenance","title":"<code>in_maintenance</code>","text":"<p>Returns <code>True</code> if this host is currently under any maintenance window.</p>"},{"location":"hostconfig_models/#methods","title":"Methods","text":""},{"location":"hostconfig_models/#__str__","title":"<code>__str__()</code>","text":"<p>Returns the host configuration name as a human-readable string representation.</p> <p>Returns: - <code>str</code>: Host configuration name</p>"},{"location":"hostconfig_models/#get_absolute_url","title":"<code>get_absolute_url()</code>","text":"<p>Returns the canonical URL for this host configuration within the NetBox plugin UI.</p> <p>Returns: - <code>str</code>: Absolute URL for the host configuration</p>"},{"location":"hostconfig_models/#get_in_sync_status","title":"<code>get_in_sync_status()</code>","text":"<p>Checks if the host is in sync with Zabbix by comparing the NetBox configuration with the actual Zabbix configuration.</p> <p>Returns: - <code>bool</code>: False if host differs from Zabbix configuration, False otherwise</p>"},{"location":"hostconfig_models/#get_sync_icon","title":"<code>get_sync_icon()</code>","text":"<p>Returns a checkmark or cross to indicate if the Host Config is in Sync with the Zabbix host.</p> <p>Returns: - HTML-formatted string with checkmark or cross</p>"},{"location":"hostconfig_models/#get_sync_diff","title":"<code>get_sync_diff()</code>","text":"<p>Gets differences between NetBox host and Zabbix host configuration as a dictionary describing the differences.</p> <p>Returns: - <code>dict</code>: JSON-like dictionary describing differences</p>"},{"location":"hostconfig_models/#update_sync_status","title":"<code>update_sync_status()</code>","text":"<p>Checks if the host is in sync with Zabbix and updates the database without triggering any signal handlers.</p>"},{"location":"hostconfig_models/#saveargs-kwargs","title":"<code>save(*args, **kwargs)</code>","text":"<p>Saves the HostConfig instance to the database. If no name is provided, automatically generates one using the assigned object's name with a 'z-' prefix.</p> <p>Parameters: - <code>*args</code>: Positional arguments passed to the model save method - <code>**kwargs</code>: Keyword arguments passed to the model save method</p>"},{"location":"hostconfig_models/#deleterequestnone-args-kwargs","title":"<code>delete(request=None, *args, **kwargs)</code>","text":"<p>Custom delete method that checks for active maintenance. If the host is in maintenance, either returns a warning (if request is provided) or raises an exception.</p> <p>Parameters: - <code>request</code>: Optional request object for warning message handling - <code>*args</code>: Positional arguments passed to the model delete method - <code>**kwargs</code>: Keyword arguments passed to the model delete method</p> <p>Returns: - Warning dictionary if host is in maintenance and request is provided - Raises exception if host is in maintenance and no request provided</p>"},{"location":"hostconfig_models/#usage-examples","title":"Usage Examples","text":""},{"location":"hostconfig_models/#creating-a-hostconfig","title":"Creating a HostConfig","text":"<pre><code>from netbox_zabbix.models import HostConfig\nfrom dcim.models import Device\n\n# Create a host configuration for a device\ndevice = Device.objects.get(name=\"web-server-01\")\nhost_config = HostConfig.objects.create(\n    assigned_object=device,\n    status=0,  # ENABLED\n    description=\"Web server host configuration\"\n)\n</code></pre>"},{"location":"hostconfig_models/#working-with-host-groups-and-templates","title":"Working with Host Groups and Templates","text":"<pre><code>from netbox_zabbix.models import HostGroup, Template\n\n# Add host groups and templates to a host config\nlinux_group = HostGroup.objects.get(name=\"Linux Servers\")\nweb_template = Template.objects.get(name=\"Template App HTTP Service\")\n\nhost_config.host_groups.add(linux_group)\nhost_config.templates.add(web_template)\n</code></pre>"},{"location":"hostconfig_models/#creating-agent-interface","title":"Creating Agent Interface","text":"<pre><code>from netbox_zabbix.models import AgentInterface\nfrom dcim.models import Interface\nfrom ipam.models import IPAddress\n\n# Create an agent interface for a host\ndevice_interface = Interface.objects.get(name=\"eth0\", device__name=\"web-server-01\")\nip_address = IPAddress.objects.get(address=\"192.168.1.100/24\")\n\nagent_interface = AgentInterface.objects.create(\n    host_config=host_config,\n    interface=device_interface,\n    ip_address=ip_address,\n    port=10050,\n    useip=1,  # Use IP\n    main=1    # Main interface\n)\n</code></pre>"},{"location":"hostconfig_models/#creating-snmp-interface","title":"Creating SNMP Interface","text":"<pre><code>from netbox_zabbix.models import SNMPInterface\n\n# Create an SNMP interface for a host\nsnmp_interface = SNMPInterface.objects.create(\n    host_config=host_config,\n    interface=device_interface,\n    ip_address=ip_address,\n    port=161,\n    version=3,  # SNMPv3\n    securitylevel=2,  # authPriv\n    authprotocol=1,   # SHA1\n    privprotocol=1,   # AES128\n    useip=1,  # Use IP\n    main=1    # Main interface\n)\n</code></pre>"},{"location":"hostconfig_models/#checking-sync-status","title":"Checking Sync Status","text":"<pre><code># Check if host config is in sync with Zabbix\nis_in_sync = host_config.get_in_sync_status()\nprint(f\"Host config in sync: {is_in_sync}\")\n\n# Get sync differences\ndifferences = host_config.get_sync_diff()\nif differences.get(\"differ\"):\n    print(\"Configuration differences found:\")\n    print(differences)\n</code></pre>"},{"location":"hostconfig_models/#integration-with-other-models","title":"Integration with Other Models","text":"<p>HostConfig integrates with several other models in the plugin:</p> <ol> <li> <p>Device and VirtualMachine Models: HostConfig objects are associated with NetBox Device or VirtualMachine objects through a generic foreign key relationship.</p> </li> <li> <p>HostGroup Model: Host configurations can be assigned to multiple host groups for organizational purposes.</p> </li> <li> <p>Template Model: Host configurations can have multiple templates applied for monitoring configuration.</p> </li> <li> <p>Proxy and ProxyGroup Models: Hosts can be monitored directly by the Zabbix server, via a specific proxy, or via a proxy group.</p> </li> <li> <p>AgentInterface and SNMPInterface Models: Host configurations can have multiple agent and SNMP interfaces for different monitoring methods.</p> </li> <li> <p>Maintenance Model: Host configurations can be included in maintenance windows either directly or indirectly through sites, host groups, proxy groups, or clusters.</p> </li> </ol>"},{"location":"hostconfig_models/#description","title":"Description","text":"<p>The HostConfig model is a core component of the NetBox Zabbix plugin that represents the synchronization state between NetBox infrastructure objects and their Zabbix monitoring configurations. Each HostConfig object corresponds to a host in Zabbix and maintains the configuration details needed for monitoring.</p> <p>Key features of the HostConfig model include:</p> <p>Object Association: - Links to NetBox Device or VirtualMachine objects through generic foreign keys - Automatically generates host names based on the associated object's name</p> <p>Monitoring Configuration: - Tracks the Zabbix host ID for synchronization - Manages host status (enabled/disabled) - Controls synchronization state with Zabbix - Records when the last synchronization check occurred</p> <p>Organization: - Associates with HostGroup objects for logical grouping - Applies Template objects for monitoring configuration - Supports different monitoring sources (direct server, proxy, or proxy group)</p> <p>Interface Support: - Works with both AgentInterface and SNMPInterface objects - Tracks which interface types are configured for the host</p> <p>Maintenance Integration: - Automatically detects when a host is in maintenance - Prevents deletion of hosts that are currently under maintenance</p> <p>Sync Management: - Provides methods to check synchronization status with Zabbix - Offers detailed difference reporting between NetBox and Zabbix configurations - Updates sync status without triggering signal handlers for performance</p> <p>The model is designed to provide a robust foundation for bidirectional synchronization between NetBox and Zabbix, ensuring that infrastructure changes in NetBox are properly reflected in the monitoring system while also tracking the monitoring state of each host.</p>"},{"location":"hostgroup_model/","title":"HostGroup Model","text":""},{"location":"hostgroup_model/#netbox-zabbix-plugin---hostgroup-documentation","title":"NetBox Zabbix Plugin - HostGroup Documentation","text":""},{"location":"hostgroup_model/#overview","title":"Overview","text":"<p>The HostGroup in the NetBox Zabbix plugin represents Zabbix host groups, which are logical containers for organizing and managing hosts in the Zabbix monitoring system. This document explains the HostGroup's structure, fields, properties, methods, and usage.</p>"},{"location":"hostgroup_model/#model-definition","title":"Model Definition","text":"<p>The HostGroup synchronizes with Zabbix host groups and maintains the relationship between NetBox and Zabbix grouping structures. Host groups in Zabbix provide a way to organize hosts logically for easier management, permission control, and applying configurations.</p>"},{"location":"hostgroup_model/#fields","title":"Fields","text":"Field Type Description Notes <code>name</code> CharField (max_length=255) Name of the host group Human-readable identifier <code>groupid</code> CharField (max_length=255) Unique identifier in Zabbix Blank/null allowed, populated during sync <code>last_synced</code> DateTimeField Last synchronization timestamp Blank/null allowed"},{"location":"hostgroup_model/#name","title":"<code>name</code>","text":"<p>The human-readable name of the host group as it appears in both NetBox and Zabbix. This field is required and serves as the primary identifier for the host group.</p>"},{"location":"hostgroup_model/#groupid","title":"<code>groupid</code>","text":"<p>The unique identifier assigned by Zabbix for this host group. This field is populated automatically when the host group is created or synchronized with Zabbix.</p>"},{"location":"hostgroup_model/#last_synced","title":"<code>last_synced</code>","text":"<p>Timestamp indicating when the host group was last synchronized with Zabbix. This helps track the freshness of the data in NetBox compared to Zabbix.</p>"},{"location":"hostgroup_model/#methods","title":"Methods","text":""},{"location":"hostgroup_model/#__str__","title":"<code>__str__()</code>","text":"<p>Returns the host group name as a human-readable string representation.</p> <p>Returns: - <code>str</code>: Host group name</p>"},{"location":"hostgroup_model/#get_absolute_url","title":"<code>get_absolute_url()</code>","text":"<p>Returns the canonical URL for this host group within the NetBox plugin UI.</p> <p>Returns: - <code>str</code>: Absolute URL for the host group</p>"},{"location":"hostgroup_model/#create_new_host_group","title":"<code>create_new_host_group()</code>","text":"<p>Creates a new host group in Zabbix with the current name and updates the <code>groupid</code> field with the Zabbix-assigned identifier.</p>"},{"location":"hostgroup_model/#update_existing_host_group","title":"<code>update_existing_host_group()</code>","text":"<p>Updates an existing host group in Zabbix with the current name. Requires that the <code>groupid</code> field is already populated.</p>"},{"location":"hostgroup_model/#deleteargs-kwargs","title":"<code>delete(*args, **kwargs)</code>","text":"<p>Attempts to delete the host group from Zabbix. If successful, also removes it from NetBox. If Zabbix deletion fails, returns a warning but still removes from NetBox.</p>"},{"location":"hostgroup_model/#usage-examples","title":"Usage Examples","text":""},{"location":"hostgroup_model/#creating-a-hostgroup","title":"Creating a HostGroup","text":"<pre><code>from netbox_zabbix.models import HostGroup\n\n# Create a new host group\nhost_group = HostGroup.objects.create(\n    name=\"Linux Servers\"\n)\n</code></pre>"},{"location":"hostgroup_model/#synchronizing-with-zabbix","title":"Synchronizing with Zabbix","text":"<pre><code># Create the host group in Zabbix\nhost_group.create_new_host_group()\n\n# Verify the groupid was populated\nprint(f\"Zabbix Group ID: {host_group.groupid}\")\n</code></pre>"},{"location":"hostgroup_model/#updating-a-hostgroup","title":"Updating a HostGroup","text":"<pre><code># Update the host group name\nhost_group = HostGroup.objects.get(name=\"Linux Servers\")\nhost_group.name = \"Production Linux Servers\"\nhost_group.update_existing_host_group()\n</code></pre>"},{"location":"hostgroup_model/#working-with-hostgroup-relationships","title":"Working with HostGroup Relationships","text":"<pre><code># Host groups are typically used in HostConfig objects\nfrom netbox_zabbix.models import HostConfig, HostGroup\n\n# Assign host groups to a host configuration\nhost_config = HostConfig.objects.get(name=\"web-server-01\")\nlinux_group = HostGroup.objects.get(name=\"Linux Servers\")\ndatabase_group = HostGroup.objects.get(name=\"Database Servers\")\n\n# Add host groups to the host configuration\nhost_config.host_groups.add(linux_group, database_group)\n</code></pre>"},{"location":"hostgroup_model/#integration-with-other-models","title":"Integration with Other Models","text":"<p>HostGroup integrates with several other models in the plugin:</p> <ol> <li>HostConfig Model: Host configurations can be assigned to multiple host groups for organizational purposes.</li> <li>Mapping Models: DeviceMapping and VMMapping can specify host groups for matching hosts.</li> <li>Maintenance Model: Maintenance windows can target specific host groups.</li> </ol>"},{"location":"hostgroup_model/#description","title":"Description","text":"<p>The HostGroup model provides synchronization capabilities between NetBox and Zabbix host group structures. It maintains the relationship between organizational units in both systems, enabling consistent grouping and management of monitored hosts.</p> <p>Key features include: - Automatic synchronization with Zabbix host groups - Bidirectional management of host group membership - Robust error handling for Zabbix API operations - Integration with HostConfig, Mapping, and Maintenance models - Preservation of Zabbix identifiers for recovery operations</p>"},{"location":"installation/","title":"Installation","text":""},{"location":"installation/#installation","title":"Installation","text":"<ol> <li>Install the plugin into your NetBox environment:</li> </ol> <p>Install the plugin directly from GitHub and ensure the required Zabbix API library is installed:</p> <p><pre><code>pip install git+https://github.com/pergus/netbox-zabbix.git'\npip install pyzabbix==1.3.1\n</code></pre> Note: This must be done inside the same virtual environment where NetBox is installed.</p> <ol> <li>Add the plugin to NetBox configuration (<code>configuration.py</code>):</li> </ol> <p>Open your NetBox configuration file (usually netbox/netbox/configuration.py) and add:</p> <p><pre><code>PLUGINS = [\n    'netbox_zabbix',\n]\n</code></pre> If you already have other plugins listed, simply append 'netbox_zabbix'.</p> <ol> <li>Apply database migrations:</li> </ol> <p>Generate and apply the database migrations for the plugin:</p> <pre><code>manage.py makemigrations netbox_zabbix\nmanage.py migrate netbox_zabbix\n</code></pre> <ol> <li>Run the setup zabbix management command: The setup zabbix management command initializes required defaults, mappings, and cryptographic keys.</li> </ol> <pre><code>manage.py setup_zabbix\n</code></pre> <p>This interactive command walks the user through two required setup phases, followed by a required configuration change in configuration.py.</p> <ol> <li>Copy the PLUGINS_CONFIG to NetBox configuration (<code>configuration.py</code>): Copy the configuration block printed after the setup command and add it to your NetBox configuration.py.</li> </ol> <pre><code>PLUGINS_CONFIG = {\n    'netbox_zabbix': {\n        \"FERNET_KEY_PATH\": \"/opt/netbox/netbox-zabbix/netbox_zabbix/fernet.key\"\n    }\n}\n</code></pre> <p>The FERNET_KEY_PATH must point to the fernet.key file generated by the setup script. Ensure this path is readable only by the NetBox service user.</p> <ol> <li>Restart NetBox: After modifying the configuration or installing plugins, restart all NetBox services:</li> </ol> <pre><code>sudo systemctl restart netbox netbox-rq\n</code></pre>"},{"location":"inventorymapping_model/","title":"InventoryMapping Model","text":""},{"location":"inventorymapping_model/#netbox-zabbix-plugin---inventorymapping-documentation","title":"NetBox Zabbix Plugin - InventoryMapping Documentation","text":""},{"location":"inventorymapping_model/#overview","title":"Overview","text":"<p>The InventoryMapping in the NetBox Zabbix plugin defines how NetBox object fields are mapped to Zabbix inventory items for devices and virtual machines. This document explains the InventoryMapping's structure, fields, properties, methods, and usage.</p>"},{"location":"inventorymapping_model/#model-definition","title":"Model Definition","text":"<p>The InventoryMapping provides a flexible way to configure which NetBox object fields should be exported as inventory items in Zabbix. Separate mappings can be defined for devices and virtual machines, allowing different inventory strategies for each object type.</p>"},{"location":"inventorymapping_model/#fields","title":"Fields","text":"Field Type Description Notes <code>object_type</code> CharField (max_length=20) Type of NetBox object Choices: 'device', 'virtualmachine'. Must be unique. <code>selection</code> JSONField Field paths for Zabbix inventory Structured array defining inventory mappings"},{"location":"inventorymapping_model/#object_type","title":"<code>object_type</code>","text":"<p>Specifies which type of NetBox object this mapping applies to. Valid choices are: - <code>device</code>: Applies to NetBox Device objects - <code>virtualmachine</code>: Applies to NetBox VirtualMachine objects</p> <p>This field must be unique, meaning only one InventoryMapping can exist for each object type.</p>"},{"location":"inventorymapping_model/#selection","title":"<code>selection</code>","text":"<p>A JSON array with a structured format containing arrays with three elements: 1. Display Name: Human-readable name for the inventory field 2. Zabbix Property: The Zabbix inventory property name 3. Field Paths: Array of NetBox field paths (in order of preference)</p> <p>For example: <pre><code>[\"Name\", \"name\", [\"device.name\", \"vm.name\"]]\n</code></pre> This maps either <code>device.name</code> or <code>vm.name</code> to the Zabbix inventory <code>name</code> property, displayed as \"Name\".</p>"},{"location":"inventorymapping_model/#methods","title":"Methods","text":""},{"location":"inventorymapping_model/#__str__","title":"<code>__str__()</code>","text":"<p>Returns a human-readable string representation in the format \"Inventory Mapping {object_type}\".</p> <p>Returns: - <code>str</code>: Human-readable string representation</p>"},{"location":"inventorymapping_model/#get_absolute_url","title":"<code>get_absolute_url()</code>","text":"<p>Returns the canonical URL for this inventory mapping within the NetBox plugin UI.</p> <p>Returns: - <code>str</code>: Absolute URL for the inventory mapping</p>"},{"location":"inventorymapping_model/#usage-examples","title":"Usage Examples","text":""},{"location":"inventorymapping_model/#creating-a-device-inventory-mapping","title":"Creating a Device Inventory Mapping","text":"<pre><code>from netbox_zabbix.models import InventoryMapping\n\n# Create an inventory mapping for devices\ndevice_inventory_mapping = InventoryMapping.objects.create(\n    object_type='device',\n    selection=[\n        [\"Name\", \"name\", [\"name\"]],\n        [\"Platform\", \"os\", [\"platform.name\"]],\n        [\"Location\", \"location\", [\"location.name\", \"site.name\"]],\n        [\"Latitude\", \"location_lat\", [\"location.site.latitude\", \"site.latitude\"]],\n        [\"Longitude\", \"location_lon\", [\"location.site.longitude\", \"site.longitude\"]]\n    ]\n)\n</code></pre>"},{"location":"inventorymapping_model/#creating-a-virtual-machine-inventory-mapping","title":"Creating a Virtual Machine Inventory Mapping","text":"<pre><code># Create an inventory mapping for virtual machines\nvm_inventory_mapping = InventoryMapping.objects.create(\n    object_type='virtualmachine',\n    selection=[\n        [\"Name\", \"name\", [\"name\"]],\n        [\"Platform\", \"os\", [\"platform.name\"]],\n        [\"Location\", \"location\", [\"location.name\", \"site.name\"]],\n        [\"Latitude\", \"location_lat\", [\"location.site.latitude\", \"site.latitude\"]],\n        [\"Longitude\", \"location_lon\", [\"location.site.longitude\", \"site.longitude\"]]\n    ]\n)\n</code></pre>"},{"location":"inventorymapping_model/#understanding-selection-structure","title":"Understanding Selection Structure","text":"<p>The <code>selection</code> field contains arrays with three elements: 1. Display Name: Human-readable name for the inventory field 2. Zabbix Property: The Zabbix inventory property name 3. Field Paths: Array of NetBox field paths (in order of preference)</p> <p>For example: <pre><code>[\"Name\", \"name\", [\"device.name\", \"vm.name\"]]\n</code></pre> This maps either <code>device.name</code> or <code>vm.name</code> to the Zabbix inventory <code>name</code> property, displayed as \"Name\".</p>"},{"location":"inventorymapping_model/#integration-with-other-models","title":"Integration with Other Models","text":"<p>InventoryMapping integrates with the core NetBox models: 1. Device Model: Device inventory mappings determine which device attributes become Zabbix inventory items 2. VirtualMachine Model: Virtual machine inventory mappings determine which VM attributes become Zabbix inventory items 3. HostConfig Model: Inventory mappings are used when creating Zabbix host configurations</p>"},{"location":"inventorymapping_model/#description","title":"Description","text":"<p>The InventoryMapping model provides a sophisticated configuration system for mapping NetBox object attributes to Zabbix inventory items. This enables automatic population of host inventory data in Zabbix based on NetBox object properties.</p> <p>Key features include: - Separate mappings for devices and virtual machines - Structured selection format with display names, Zabbix properties, and field paths - Support for multiple field paths with preference ordering - Integration with the HostConfig model for inventory population during provisioning - Flexible mapping of nested object attributes to inventory fields</p>"},{"location":"job_atomicjobrunner/","title":"AtomicJobRunner","text":""},{"location":"job_atomicjobrunner/#atomicjobrunner-base-class","title":"AtomicJobRunner Base Class","text":""},{"location":"job_atomicjobrunner/#overview","title":"Overview","text":"<p>The <code>AtomicJobRunner</code> is a base class that extends NetBox's JobRunner to provide transactional execution, proper exception propagation, and enhanced event logging capabilities. All jobs in the NetBox Zabbix plugin inherit from this class to ensure consistency and reliability.</p>"},{"location":"job_atomicjobrunner/#class-definition","title":"Class Definition","text":"<pre><code>class AtomicJobRunner(JobRunner)\n</code></pre>"},{"location":"job_atomicjobrunner/#methods","title":"Methods","text":""},{"location":"job_atomicjobrunner/#handlecls-job-args-kwargs","title":"<code>handle(cls, job, *args, **kwargs)</code>","text":"<p>Execute the job inside a transactional block and handle exceptions.</p> <p>Parameters: - <code>job</code> (JobRunner): The job instance being executed. - <code>*args</code>: Positional arguments passed to the job's <code>run</code> method. - <code>**kwargs</code>: Keyword arguments passed to the job's <code>run</code> method.</p> <p>Behavior: - Calls <code>job.start()</code>. - Executes <code>cls(job).run(*args, **kwargs)</code> within a <code>transaction.atomic()</code> block. - Updates <code>job.data</code> and terminates the job with success or failure status. - Logs the event via <code>_log_event()</code>. - Reschedules the job if <code>job.interval</code> is set.</p> <p>Raises: - <code>Exception</code>: Any exception raised by <code>run()</code> is re-raised after updating job status.</p>"},{"location":"job_atomicjobrunner/#run_nowcls-args-kwargs","title":"<code>run_now(cls, *args, **kwargs)</code>","text":"<p>Execute the job immediately in a transactional context.</p> <p>Parameters: - <code>*args</code>: Positional arguments for the job's <code>run</code> method. - <code>**kwargs</code>: Keyword arguments for the job's <code>run</code> method.   - <code>name</code> (str, optional): Name of the job. Defaults to <code>cls.name</code>.   - <code>eventlog</code> (bool, optional): Whether to log events. Defaults to True.</p> <p>Returns: - <code>str</code>: The message from the job's result, or the string representation of the result.</p> <p>Raises: - <code>Exception</code>: Any exception raised by <code>run()</code> is propagated.</p>"},{"location":"job_atomicjobrunner/#_log_eventname-jobnone-resultnone-exceptionnone-datanone-pre_datanone-post_datanone-signal_idnone","title":"<code>_log_event(name, job=None, result=None, exception=None, data=None, pre_data=None, post_data=None, signal_id=None)</code>","text":"<p>Log a structured job event to the EventLog model.</p> <p>Parameters: - <code>name</code> (str): Name of the job. - <code>job</code> (JobRunner, optional): The job instance associated with the event. - <code>result</code> (dict, optional): The result dictionary returned by the job. - <code>exception</code> (str, optional): Exception message if the job failed. - <code>data</code> (any, optional): Job-specific result data. - <code>pre_data</code> (any, optional): Data captured before job execution. - <code>post_data</code> (any, optional): Data captured after job execution. - <code>signal_id</code> (str, optional): Signal ID for correlating events.</p>"},{"location":"job_atomicjobrunner/#usage-examples","title":"Usage Examples","text":""},{"location":"job_atomicjobrunner/#creating-a-custom-job","title":"Creating a Custom Job","text":"<pre><code>from netbox_zabbix.jobs.atomicjobrunner import AtomicJobRunner\n\nclass MyCustomJob(AtomicJobRunner):\n    \"\"\"\n    Example custom job inheriting from AtomicJobRunner.\n    \"\"\"\n\n    @classmethod\n    def run(cls, *args, **kwargs):\n        \"\"\"\n        Implement the job logic.\n        \"\"\"\n        # Job logic here\n        return {\"message\": \"Job completed successfully\", \"data\": {\"processed\": 10}}\n\n    @classmethod\n    def run_job(cls, schedule_at=None, interval=None, immediate=False, name=None):\n        \"\"\"\n        Schedule the job for execution.\n        \"\"\"\n        job_args = {\n            \"name\": name or \"My Custom Job\",\n            \"schedule_at\": schedule_at,\n            \"interval\": interval,\n            \"immediate\": immediate,\n        }\n\n        if interval is None:\n            return cls.enqueue(**job_args)\n        else:\n            return cls.enqueue_once(**job_args)\n</code></pre>"},{"location":"job_atomicjobrunner/#running-a-job-immediately","title":"Running a Job Immediately","text":"<pre><code>from netbox_zabbix.jobs.atomicjobrunner import AtomicJobRunner\n\n# Run any job immediately with transaction safety\nresult = AtomicJobRunner.run_now()\nprint(f\"Job result: {result}\")\n</code></pre>"},{"location":"job_atomicjobrunner/#integration-with-other-components","title":"Integration with Other Components","text":"<ol> <li>NetBox JobRunner: Extends the base NetBox job framework.</li> <li>Django Transactions: Uses <code>django.db.transaction</code> for atomic execution.</li> <li>NetBox Models: Integrates with Job and EventLog models.</li> <li>Plugin Settings: Respects event logging configuration.</li> <li>Logging: Uses plugin logger for error and debug logging.</li> </ol>"},{"location":"job_atomicjobrunner/#description","title":"Description","text":"<p>The AtomicJobRunner class addresses several limitations of NetBox's built-in JobRunner and provides enhanced functionality for reliable job execution in the NetBox Zabbix plugin.</p>"},{"location":"job_atomicjobrunner/#problem-solved","title":"Problem Solved","text":"<p>NetBox's built-in JobRunner.handle() method swallows all exceptions that occur during job execution. While it updates the job's status and logs the error, it does not re-raise the exception. This makes it impossible to identify the job as failed in GUI and impossible for a user to restart the job.</p>"},{"location":"job_atomicjobrunner/#solution-provided","title":"Solution Provided","text":"<p>AtomicJobRunner overrides the <code>handle()</code> method to re-raise any unhandled exceptions after updating the job status and metadata. This allows external callers using <code>.enqueue()</code> or <code>.handle()</code> to detect failures, making it suitable for retry mechanisms, task chaining, and tests.</p>"},{"location":"job_atomicjobrunner/#key-features","title":"Key Features","text":"<p>Transactional Execution: - The job execution (<code>run()</code>) occurs inside a <code>transaction.atomic()</code> block. - If any part of the job fails, the database changes are rolled back. - This guarantees consistency between the job's result and its side effects.</p> <p>Exception Propagation: - Exceptions are properly re-raised after job status updates. - Enables proper error handling in calling code. - Allows job restart functionality in NetBox UI.</p> <p>Enhanced Event Logging: - Stores structured <code>job.data</code> on both success and failure. - Captures pre-execution and post-execution data for debugging. - Maintains support for periodic (interval-based) jobs via <code>job.interval</code>.</p> <p>Data Preservation: - Preserves job context data for troubleshooting. - Stores pre-data and post-data snapshots for audit purposes. - Maintains signal ID correlation for event tracking.</p> <p>Rescheduling Support: - Automatically reschedules jobs with intervals. - Handles job continuation for recurring tasks. - Manages job lifecycle for system jobs.</p>"},{"location":"job_atomicjobrunner/#benefits","title":"Benefits","text":"<ol> <li>Consistency: Database transactions ensure all-or-nothing execution.</li> <li>Reliability: Exception propagation enables proper error handling.</li> <li>Debuggability: Structured data logging aids troubleshooting.</li> <li>Maintainability: Standardized base class reduces code duplication.</li> <li>Audit Trail: Comprehensive event logging supports compliance.</li> <li>Performance: Efficient execution with minimal overhead.</li> </ol> <p>All jobs in the NetBox Zabbix plugin inherit from AtomicJobRunner to ensure consistent behavior, reliable execution, and proper error handling across the entire job system.</p>"},{"location":"job_basezabbixinterfacejob/","title":"BaseZabbixInterfaceJob","text":""},{"location":"job_basezabbixinterfacejob/#basezabbixinterfacejob-class","title":"BaseZabbixInterfaceJob Class","text":""},{"location":"job_basezabbixinterfacejob/#overview","title":"Overview","text":"<p>The <code>BaseZabbixInterfaceJob</code> is an abstract base class that provides shared enqueue logic for Zabbix interface jobs. It serves as the foundation for both <code>CreateZabbixInterface</code> and <code>UpdateZabbixInterface</code> jobs, offering common functionality for managing Zabbix interfaces linked to NetBox HostConfig objects.</p>"},{"location":"job_basezabbixinterfacejob/#class-definition","title":"Class Definition","text":"<pre><code>class BaseZabbixInterfaceJob(AtomicJobRunner)\n</code></pre>"},{"location":"job_basezabbixinterfacejob/#methods","title":"Methods","text":""},{"location":"job_basezabbixinterfacejob/#run_jobcls-host_config-requestnone-schedule_atnone-intervalnone-immediatefalse-namenone-signal_idnone","title":"<code>run_job(cls, host_config, request=None, schedule_at=None, interval=None, immediate=False, name=None, signal_id=None)</code>","text":"<p>Enqueues a Zabbix interface job for the given HostConfig.</p> <p>Parameters: - <code>host_config</code> (HostConfig): Target HostConfig instance. - <code>request</code> (HttpRequest, optional): HTTP request triggering the job. - <code>schedule_at</code> (datetime, optional): Schedule time. - <code>interval</code> (int, optional): Interval for recurring job. - <code>immediate</code> (bool, optional): Run job immediately. - <code>name</code> (str, optional): Job name. - <code>signal_id</code> (str, optional): Signal identifier for event correlation.</p> <p>Returns: - <code>Job</code>: Enqueued job instance.</p> <p>Raises: - <code>Exception</code>: If host_config is not a HostConfig instance.</p>"},{"location":"job_basezabbixinterfacejob/#usage-examples","title":"Usage Examples","text":""},{"location":"job_basezabbixinterfacejob/#using-basezabbixinterfacejob-in-subclasses","title":"Using BaseZabbixInterfaceJob in Subclasses","text":"<pre><code># This is an abstract base class and is not used directly\n# Instead, it provides functionality for subclasses like:\n\nfrom netbox_zabbix.jobs.interface import CreateZabbixInterface\nfrom netbox_zabbix.models import HostConfig\n\n# Get a host configuration\nhost_config = HostConfig.objects.get(name=\"web-server-01\")\n\n# Use subclass that inherits from BaseZabbixInterfaceJob\njob = CreateZabbixInterface.run_job(\n    host_config=host_config,\n    request=request,\n    name=f\"Create interface for {host_config.name}\"\n)\n</code></pre>"},{"location":"job_basezabbixinterfacejob/#integration-with-other-components","title":"Integration with Other Components","text":"<ol> <li>AtomicJobRunner: Inherits transactional execution and error handling capabilities.</li> <li>NetBox Models: Works with HostConfig objects.</li> <li>Zabbix API: Provides foundation for interface management operations.</li> <li>Event Logging: Supports signal ID correlation for event tracking.</li> </ol>"},{"location":"job_basezabbixinterfacejob/#description","title":"Description","text":"<p>The BaseZabbixInterfaceJob class provides a standardized framework for Zabbix interface management jobs. It implements common functionality including:</p> <ol> <li>Parameter Validation: Ensures that the provided host_config is a valid HostConfig instance</li> <li>Job Enqueueing: Provides a consistent interface for scheduling interface jobs</li> <li>Naming Convention: Automatically generates descriptive job names when not provided</li> <li>Request Handling: Properly associates HTTP requests with background jobs</li> <li>Scheduling Support: Handles both immediate execution and scheduled jobs</li> <li>Signal Correlation: Supports signal ID tracking for event correlation</li> </ol> <p>This base class ensures consistency across interface management jobs and reduces code duplication. It handles the boilerplate logic required for job scheduling while allowing subclasses to focus on their specific interface management operations.</p> <p>The class is designed to be extended by concrete job implementations that perform specific interface operations such as creation or updating. It provides a solid foundation that maintains consistency with other jobs in the plugin while offering the flexibility needed for interface-specific operations.</p>"},{"location":"job_createzabbixhost/","title":"CreateZabbixHost Job","text":""},{"location":"job_createzabbixhost/#createzabbixhost-job","title":"CreateZabbixHost Job","text":""},{"location":"job_createzabbixhost/#overview","title":"Overview","text":"<p>The <code>CreateZabbixHost</code> job creates a new Zabbix host from a HostConfig. This job registers NetBox HostConfig objects as hosts in Zabbix, enabling monitoring of NetBox-managed infrastructure.</p>"},{"location":"job_createzabbixhost/#class-definition","title":"Class Definition","text":"<pre><code>class CreateZabbixHost(AtomicJobRunner)\n</code></pre>"},{"location":"job_createzabbixhost/#methods","title":"Methods","text":""},{"location":"job_createzabbixhost/#runcls-args-kwargs","title":"<code>run(cls, *args, **kwargs)</code>","text":"<p>Creates the host in Zabbix and updates HostConfig with host ID.</p> <p>Returns: - <code>dict</code>: Message confirming creation and Zabbix payload.</p> <p>Raises: - <code>ExceptionWithData</code>: If creation fails and payload is available. - <code>Exception</code>: For other failures.</p>"},{"location":"job_createzabbixhost/#run_jobcls-host_config-request-schedule_atnone-intervalnone-immediatefalse-namenone-signal_idnone","title":"<code>run_job(cls, host_config, request, schedule_at=None, interval=None, immediate=False, name=None, signal_id=None)</code>","text":"<p>Enqueues a job to create a Zabbix host.</p> <p>Parameters: - <code>host_config</code> (HostConfig): Host configuration to create. - <code>request</code> (HttpRequest): Triggering request. - <code>schedule_at</code> (datetime, optional): Schedule time. - <code>interval</code> (int, optional): Interval for recurring job. - <code>immediate</code> (bool, optional): Run job immediately. - <code>name</code> (str, optional): Job name. - <code>signal_id</code> (str, optional): Signal identifier for event correlation.</p> <p>Returns: - <code>Job</code>: Enqueued job instance.</p>"},{"location":"job_createzabbixhost/#usage-examples","title":"Usage Examples","text":""},{"location":"job_createzabbixhost/#creating-a-zabbix-host","title":"Creating a Zabbix Host","text":"<pre><code>from netbox_zabbix.jobs.host import CreateZabbixHost\nfrom netbox_zabbix.models import HostConfig\n\n# Get a host configuration to create in Zabbix\nhost_config = HostConfig.objects.get(name=\"web-server-01\")\n\n# Create the host in Zabbix\njob = CreateZabbixHost.run_job(\n    host_config=host_config,\n    request=request,\n    name=f\"Create host {host_config.name} in Zabbix\"\n)\n</code></pre>"},{"location":"job_createzabbixhost/#immediate-host-creation","title":"Immediate Host Creation","text":"<pre><code>from netbox_zabbix.jobs.host import CreateZabbixHost\nfrom netbox_zabbix.models import HostConfig\n\n# Get a host configuration\nhost_config = HostConfig.objects.get(name=\"web-server-01\")\n\n# Create host immediately\nresult = CreateZabbixHost.run_now(\n    host_config_id=host_config.id,\n    user=request.user,\n    request_id=request.id\n)\nprint(f\"Host creation result: {result['message']}\")\n</code></pre>"},{"location":"job_createzabbixhost/#integration-with-other-components","title":"Integration with Other Components","text":"<ol> <li>AtomicJobRunner: Inherits transactional execution and error handling capabilities.</li> <li>Zabbix Hosts: Uses <code>create_zabbix_host</code> to register hosts in Zabbix.</li> <li>NetBox Models: Works with HostConfig objects.</li> <li>NetBox Changelog: Uses <code>log_creation_event</code> to record host creation.</li> <li>NetBox Jobs: Uses <code>associate_instance_with_job</code> to link jobs with instances.</li> <li>Host Configuration: Uses <code>save_host_config</code> to persist host IDs.</li> <li>Event Logging: Logs host creation events to the EventLog model.</li> </ol>"},{"location":"job_createzabbixhost/#description","title":"Description","text":"<p>The CreateZabbixHost job registers NetBox HostConfig objects as monitored hosts in Zabbix. It performs the following operations:</p> <ol> <li>Retrieves the HostConfig object from NetBox</li> <li>Creates a corresponding host in Zabbix with appropriate configuration</li> <li>Updates the HostConfig with the assigned Zabbix host ID</li> <li>Logs the creation event in NetBox's changelog</li> <li>Associates the job with the created host for tracking</li> </ol> <p>This job is typically used when: - New devices or virtual machines are provisioned for monitoring - Existing HostConfig objects need to be registered in Zabbix - Recovering from host creation failures - Manually adding hosts to Zabbix monitoring</p> <p>Key features: - Transaction Safety: Executes within a database transaction to ensure consistency - Error Recovery: Attempts to clean up partially created hosts if failures occur - Payload Preservation: Preserves Zabbix API payloads for debugging - Changelog Integration: Records host creation in NetBox's audit trail - Job Association: Links created hosts with their creation jobs for tracking - Automatic Cleanup: Removes partially created Zabbix hosts on failure</p> <p>The job ensures that all necessary Zabbix host configuration is created, including: - Host name and description - Assigned templates based on mapping configurations - Host groups based on mapping configurations - Interface configurations (agent, SNMP, etc.) - Proxy or proxy group assignments - Custom tags and inventory data</p>"},{"location":"job_createzabbixinterface/","title":"CreateZabbixInterface Job","text":""},{"location":"job_createzabbixinterface/#createzabbixinterface-job","title":"CreateZabbixInterface Job","text":""},{"location":"job_createzabbixinterface/#overview","title":"Overview","text":"<p>The <code>CreateZabbixInterface</code> job creates missing Zabbix interfaces for a HostConfig. This job ensures that Zabbix hosts have the necessary interfaces configured to match their NetBox HostConfig definitions.</p>"},{"location":"job_createzabbixinterface/#class-definition","title":"Class Definition","text":"<pre><code>class CreateZabbixInterface(BaseZabbixInterfaceJob)\n</code></pre>"},{"location":"job_createzabbixinterface/#methods","title":"Methods","text":""},{"location":"job_createzabbixinterface/#runcls-args-kwargs","title":"<code>run(cls, *args, **kwargs)</code>","text":"<p>Creates or updates the Zabbix host/interface and links missing interfaces.</p> <p>Returns: - <code>dict</code>: Result of the interface creation/update.</p> <p>Raises: - <code>Exception</code>: If the HostConfig has no associated Zabbix host.</p>"},{"location":"job_createzabbixinterface/#usage-examples","title":"Usage Examples","text":""},{"location":"job_createzabbixinterface/#creating-missing-interfaces","title":"Creating Missing Interfaces","text":"<pre><code>from netbox_zabbix.jobs.interface import CreateZabbixInterface\nfrom netbox_zabbix.models import HostConfig\n\n# Get a host configuration that needs interface creation\nhost_config = HostConfig.objects.get(name=\"web-server-01\")\n\n# Create missing interfaces\njob = CreateZabbixInterface.run_job(\n    host_config=host_config,\n    request=request,\n    name=f\"Create interfaces for {host_config.name}\"\n)\n</code></pre>"},{"location":"job_createzabbixinterface/#immediate-interface-creation","title":"Immediate Interface Creation","text":"<pre><code>from netbox_zabbix.jobs.interface import CreateZabbixInterface\nfrom netbox_zabbix.models import HostConfig\n\n# Get a host configuration\nhost_config = HostConfig.objects.get(name=\"web-server-01\")\n\n# Create interfaces immediately\nresult = CreateZabbixInterface.run_now(\n    host_config_id=host_config.id,\n    user=request.user,\n    request_id=request.id\n)\nprint(f\"Interface creation result: {result['message']}\")\n</code></pre>"},{"location":"job_createzabbixinterface/#integration-with-other-components","title":"Integration with Other Components","text":"<ol> <li>BaseZabbixInterfaceJob: Inherits common interface job functionality.</li> <li>AtomicJobRunner: Inherits transactional execution and error handling capabilities.</li> <li>Zabbix Hosts: Uses <code>update_zabbix_host</code> to synchronize host configuration.</li> <li>Zabbix Interfaces: Uses <code>link_missing_zabbix_interface</code> to associate interfaces.</li> <li>NetBox Models: Works with HostConfig objects.</li> <li>Event Logging: Logs interface creation events to the EventLog model.</li> </ol>"},{"location":"job_createzabbixinterface/#description","title":"Description","text":"<p>The CreateZabbixInterface job ensures that Zabbix hosts have all the interfaces defined in their corresponding NetBox HostConfig. It performs the following operations:</p> <ol> <li>Verifies that the HostConfig has an associated Zabbix host ID</li> <li>Updates the Zabbix host configuration to match NetBox definitions</li> <li>Links any missing Zabbix interfaces to their NetBox counterparts</li> <li>Ensures interface consistency between NetBox and Zabbix</li> </ol> <p>This job is typically used when: - New interfaces have been added to a HostConfig in NetBox - A HostConfig has been imported from Zabbix but interfaces need to be linked - Manual corrections are needed after interface configuration changes - Recovering from interface synchronization issues</p> <p>The job provides a targeted approach to interface management, allowing administrators to ensure interface consistency without performing full host updates. It's particularly useful in scenarios where only interface configuration has changed while other host settings remain valid.</p> <p>Key features: - Validation: Ensures the HostConfig has a valid Zabbix host ID before proceeding - Linking: Automatically associates Zabbix interfaces with NetBox interface objects - Transaction Safety: Executes within a database transaction to ensure consistency - Error Handling: Provides clear error messages when interface creation fails</p>"},{"location":"job_deletezabbixhost/","title":"DeleteZabbixHost Job","text":""},{"location":"job_deletezabbixhost/#deletezabbixhost-job","title":"DeleteZabbixHost Job","text":""},{"location":"job_deletezabbixhost/#overview","title":"Overview","text":"<p>The <code>DeleteZabbixHost</code> job deletes a Zabbix host, supporting both soft and hard deletion modes. This job removes hosts from Zabbix monitoring and handles the corresponding cleanup in NetBox based on plugin configuration.</p>"},{"location":"job_deletezabbixhost/#class-definition","title":"Class Definition","text":"<pre><code>class DeleteZabbixHost(AtomicJobRunner)\n</code></pre>"},{"location":"job_deletezabbixhost/#methods","title":"Methods","text":""},{"location":"job_deletezabbixhost/#runcls-args-kwargs","title":"<code>run(cls, *args, **kwargs)</code>","text":"<p>Executes the deletion of the Zabbix host.</p> <p>Returns: - <code>dict</code>: Result of deletion.</p> <p>Raises: - <code>Exception</code>: If deletion fails.</p>"},{"location":"job_deletezabbixhost/#run_jobcls-hostid-usernone-schedule_atnone-intervalnone-immediatefalse-namenone-signal_idnone","title":"<code>run_job(cls, hostid, user=None, schedule_at=None, interval=None, immediate=False, name=None, signal_id=None)</code>","text":"<p>Enqueues a job to delete a Zabbix host.</p> <p>Parameters: - <code>hostid</code> (int): Zabbix host ID to delete. - <code>user</code> (User, optional): User initiating the deletion. - <code>schedule_at</code> (datetime, optional): Schedule time. - <code>interval</code> (int, optional): Interval for recurring job. - <code>immediate</code> (bool, optional): Run job immediately. - <code>name</code> (str, optional): Job name. - <code>signal_id</code> (str, optional): Signal identifier for event correlation.</p> <p>Returns: - <code>Job</code>: Enqueued job instance.</p>"},{"location":"job_deletezabbixhost/#usage-examples","title":"Usage Examples","text":""},{"location":"job_deletezabbixhost/#deleting-a-zabbix-host","title":"Deleting a Zabbix Host","text":"<pre><code>from netbox_zabbix.jobs.host import DeleteZabbixHost\n\n# Delete a host from Zabbix\njob = DeleteZabbixHost.run_job(\n    hostid=12345,\n    user=request.user,\n    name=\"Delete host 12345 from Zabbix\"\n)\n</code></pre>"},{"location":"job_deletezabbixhost/#immediate-host-deletion","title":"Immediate Host Deletion","text":"<pre><code>from netbox_zabbix.jobs.host import DeleteZabbixHost\n\n# Delete host immediately\nresult = DeleteZabbixHost.run_now(\n    hostid=12345,\n    user=request.user\n)\nprint(f\"Host deletion result: {result['message']}\")\n</code></pre>"},{"location":"job_deletezabbixhost/#integration-with-other-components","title":"Integration with Other Components","text":"<ol> <li>AtomicJobRunner: Inherits transactional execution and error handling capabilities.</li> <li>Zabbix Hosts: Uses <code>delete_zabbix_host_hard</code> and <code>delete_zabbix_host_soft</code> for deletion.</li> <li>Plugin Settings: Respects <code>get_delete_setting()</code> for deletion mode selection.</li> <li>Event Logging: Logs host deletion events to the EventLog model.</li> </ol>"},{"location":"job_deletezabbixhost/#description","title":"Description","text":"<p>The DeleteZabbixHost job removes Zabbix hosts from monitoring, supporting both hard and soft deletion modes based on plugin configuration. It performs the following operations:</p> <ol> <li>Determines the deletion mode (hard or soft) from plugin settings</li> <li>Deletes the host from Zabbix using the appropriate deletion method</li> <li>Handles cleanup and error reporting</li> </ol> <p>This job supports two deletion modes:</p> <p>Hard Deletion: Completely removes the host from Zabbix, making recovery only possible through Zabbix backup restoration.</p> <p>Soft Deletion: Moves the host to a designated \"graveyard\" host group and appends a suffix to the host name, allowing for easier recovery.</p> <p>This job is typically used when: - Decommissioning devices or virtual machines from monitoring - Cleaning up test or temporary hosts - Removing hosts that are no longer needed - Correcting accidentally created hosts</p> <p>Key features: - Configurable Deletion: Respects plugin settings for deletion behavior - Transaction Safety: Executes within a database transaction - Error Handling: Provides clear error messages on deletion failures - Audit Trail: Logs deletion events for compliance and tracking - Flexible Scheduling: Supports both immediate and scheduled deletions - User Tracking: Preserves user information for audit purposes</p> <p>The deletion mode is controlled by the plugin's delete setting: - <code>hard</code>: Permanently deletes hosts from Zabbix - <code>soft</code>: Moves hosts to graveyard host group with archived suffix</p> <p>The graveyard host group name and archived suffix are configurable in plugin settings, defaulting to \"graveyard\" and \"_archived\" respectively.</p>"},{"location":"job_importhost/","title":"ImportHost Job","text":""},{"location":"job_importhost/#importhost-job","title":"ImportHost Job","text":""},{"location":"job_importhost/#overview","title":"Overview","text":"<p>The <code>ImportHost</code> job imports a single Zabbix host into NetBox, creating or updating a corresponding HostConfig for a Device or VirtualMachine. This job enables administrators to bring existing Zabbix hosts under NetBox management.</p>"},{"location":"job_importhost/#class-definition","title":"Class Definition","text":"<pre><code>class ImportHost(AtomicJobRunner)\n</code></pre>"},{"location":"job_importhost/#methods","title":"Methods","text":""},{"location":"job_importhost/#runcls-args-kwargs","title":"<code>run(cls, *args, **kwargs)</code>","text":"<p>Imports a Zabbix host into NetBox using ImportHostContext.</p> <p>Returns: - <code>dict</code>: Message confirming import and imported Zabbix host data.</p> <p>Raises: - <code>Exception</code>: If instance is invalid or import fails.</p>"},{"location":"job_importhost/#run_jobcls-instance-request-schedule_atnone-intervalnone-immediatefalse-namenone","title":"<code>run_job(cls, instance, request, schedule_at=None, interval=None, immediate=False, name=None)</code>","text":"<p>Schedules an ImportHost job.</p> <p>Parameters: - <code>instance</code> (Device|VirtualMachine): Target instance. - <code>request</code> (HttpRequest): Triggering request. - <code>schedule_at</code> (datetime, optional): Schedule time. - <code>interval</code> (int, optional): Interval for recurring job. - <code>immediate</code> (bool, optional): Run immediately. - <code>name</code> (str, optional): Job name.</p> <p>Returns: - <code>Job</code>: Enqueued job instance.</p>"},{"location":"job_importhost/#usage-examples","title":"Usage Examples","text":""},{"location":"job_importhost/#importing-a-host","title":"Importing a Host","text":"<pre><code>from netbox_zabbix.jobs.imports import ImportHost\nfrom dcim.models import Device\n\n# Get a device to import\ndevice = Device.objects.get(name=\"existing-zabbix-host\")\n\n# Import the host from Zabbix\njob = ImportHost.run_job(\n    instance=device,\n    request=request,\n    name=f\"Import {device.name} from Zabbix\"\n)\n</code></pre>"},{"location":"job_importhost/#running-import-immediately","title":"Running Import Immediately","text":"<pre><code>from netbox_zabbix.jobs.imports import ImportHost\nfrom dcim.models import Device\n\n# Get a device to import\ndevice = Device.objects.get(name=\"existing-zabbix-host\")\n\n# Run import immediately\nresult = ImportHost.run_now(instance=device)\nprint(f\"Imported host: {result['message']}\")\n</code></pre>"},{"location":"job_importhost/#integration-with-other-components","title":"Integration with Other Components","text":"<ol> <li>AtomicJobRunner: Inherits transactional execution and error handling capabilities.</li> <li>Zabbix API: Uses <code>get_host</code> to retrieve Zabbix host information.</li> <li>Import Functions: Uses <code>import_zabbix_host</code> and <code>ImportHostContext</code> for import logic.</li> <li>NetBox Models: Works with Device, VirtualMachine, and HostConfig objects.</li> <li>Event Logging: Logs import events to the EventLog model.</li> </ol>"},{"location":"job_importhost/#description","title":"Description","text":"<p>The ImportHost job facilitates the migration of existing Zabbix hosts into NetBox management. It performs the following operations:</p> <ol> <li>Retrieves the target NetBox instance (Device or VirtualMachine)</li> <li>Fetches the corresponding host from Zabbix</li> <li>Creates or updates a HostConfig object in NetBox</li> <li>Associates Zabbix interfaces with NetBox interfaces</li> <li>Establishes the link between NetBox objects and Zabbix hosts</li> </ol> <p>This job is particularly useful when: - Bringing existing Zabbix-monitored infrastructure under NetBox management - Recovering from configuration issues by re-importing Zabbix data - Synchronizing NetBox with changes made directly in Zabbix - Onboarding new devices that were manually added to Zabbix</p> <p>The job ensures that all relevant Zabbix host configuration is captured in NetBox, including interfaces, templates, host groups, and monitoring settings.</p>"},{"location":"job_importzabbixsettings/","title":"ImportZabbixSettings Job","text":""},{"location":"job_importzabbixsettings/#importzabbixsettings-job","title":"ImportZabbixSettings Job","text":""},{"location":"job_importzabbixsettings/#overview","title":"Overview","text":"<p>The <code>ImportZabbixSettings</code> job synchronizes global Zabbix entities such as templates, proxies, proxy groups, and host groups into NetBox models. This job ensures that NetBox maintains an up-to-date copy of Zabbix configuration objects.</p>"},{"location":"job_importzabbixsettings/#class-definition","title":"Class Definition","text":"<pre><code>class ImportZabbixSettings(AtomicJobRunner)\n</code></pre>"},{"location":"job_importzabbixsettings/#methods","title":"Methods","text":""},{"location":"job_importzabbixsettings/#runcls-args-kwargs","title":"<code>run(cls, *args, **kwargs)</code>","text":"<p>Executes the import of Zabbix settings.</p> <p>Returns: - <code>dict</code>: Imported configuration summary.</p> <p>Raises: - <code>Exception</code>: If import fails.</p>"},{"location":"job_importzabbixsettings/#run_jobcls-usernone-schedule_atnone-intervalnone-immediatefalse-namenone","title":"<code>run_job(cls, user=None, schedule_at=None, interval=None, immediate=False, name=None)</code>","text":"<p>Schedules or enqueues the ImportZabbixSettings job.</p> <p>Parameters: - <code>user</code> (User, optional): User triggering the job. - <code>schedule_at</code> (datetime, optional): Schedule time. - <code>interval</code> (int, optional): Interval in minutes for recurring job. - <code>immediate</code> (bool, optional): Run job immediately. - <code>name</code> (str, optional): Job name.</p> <p>Returns: - <code>Job</code>: The enqueued job instance.</p>"},{"location":"job_importzabbixsettings/#usage-examples","title":"Usage Examples","text":""},{"location":"job_importzabbixsettings/#running-import-immediately","title":"Running Import Immediately","text":"<pre><code>from netbox_zabbix.jobs.imports import ImportZabbixSettings\n\n# Run import immediately\nresult = ImportZabbixSettings.run_now()\nprint(f\"Imported {result['templates']} templates, {result['proxies']} proxies\")\n</code></pre>"},{"location":"job_importzabbixsettings/#scheduling-recurring-import","title":"Scheduling Recurring Import","text":"<pre><code>from netbox_zabbix.jobs.imports import ImportZabbixSettings\n\n# Schedule recurring import every hour\njob = ImportZabbixSettings.run_job(\n    user=request.user,\n    interval=60,  # Every 60 minutes\n    name=\"Hourly Zabbix Settings Import\"\n)\n</code></pre>"},{"location":"job_importzabbixsettings/#integration-with-other-components","title":"Integration with Other Components","text":"<ol> <li>AtomicJobRunner: Inherits transactional execution and error handling capabilities.</li> <li>Zabbix API: Communicates with Zabbix to retrieve configuration objects.</li> <li>Import Functions: Uses <code>import_zabbix_settings</code> for the actual import logic.</li> <li>NetBox Models: Updates Template, Proxy, ProxyGroup, and HostGroup models.</li> <li>Event Logging: Logs import events to the EventLog model.</li> </ol>"},{"location":"job_importzabbixsettings/#description","title":"Description","text":"<p>The ImportZabbixSettings job is crucial for maintaining synchronization between Zabbix and NetBox configuration objects. It performs the following operations:</p> <ol> <li>Retrieves templates, proxies, proxy groups, and host groups from Zabbix</li> <li>Updates corresponding NetBox models with the latest information</li> <li>Creates new objects for previously unknown Zabbix entities</li> <li>Updates existing objects with changed information</li> <li>Reports import statistics and any errors encountered</li> </ol> <p>This job is typically run on a recurring schedule to ensure that NetBox stays current with Zabbix configuration changes. It enables features like mapping configurations that reference Zabbix objects by ensuring those objects exist in NetBox.</p>"},{"location":"job_provisionagent/","title":"ProvisionAgent Job","text":""},{"location":"job_provisionagent/#provisionagent-job","title":"ProvisionAgent Job","text":""},{"location":"job_provisionagent/#overview","title":"Overview","text":"<p>The <code>ProvisionAgent</code> job provisions a Zabbix host using an Agent interface. This job creates a Host Configuration using the Agent interface model and registers it in Zabbix, enabling Zabbix agent-based monitoring for NetBox devices and virtual machines.</p>"},{"location":"job_provisionagent/#class-definition","title":"Class Definition","text":"<pre><code>class ProvisionAgent(AtomicJobRunner)\n</code></pre>"},{"location":"job_provisionagent/#methods","title":"Methods","text":""},{"location":"job_provisionagent/#runcls-args-kwargs","title":"<code>run(cls, *args, **kwargs)</code>","text":"<p>Provisions an Agent interface in Zabbix for the given instance.</p> <p>Returns: - <code>dict</code>: Result of provisioning.</p> <p>Raises: - <code>Exception</code>: If instance is invalid or provisioning fails.</p>"},{"location":"job_provisionagent/#run_jobcls-instance-request-schedule_atnone-intervalnone-immediatefalse-namenone","title":"<code>run_job(cls, instance, request, schedule_at=None, interval=None, immediate=False, name=None)</code>","text":"<p>Enqueues a ProvisionAgent job.</p> <p>Returns: - <code>Job</code>: Enqueued job instance.</p>"},{"location":"job_provisionagent/#run_nowcls-instancenone-args-kwargs","title":"<code>run_now(cls, instance=None, *args, **kwargs)</code>","text":"<p>Immediately provisions an Agent interface.</p> <p>Parameters: - <code>instance</code> (Device|VirtualMachine, optional): Target instance.</p>"},{"location":"job_provisionagent/#usage-examples","title":"Usage Examples","text":""},{"location":"job_provisionagent/#provisioning-an-agent-interface","title":"Provisioning an Agent Interface","text":"<pre><code>from netbox_zabbix.jobs.provision import ProvisionAgent\nfrom dcim.models import Device\n\n# Get a device to provision\ndevice = Device.objects.get(name=\"web-server-01\")\n\n# Provision agent interface\njob = ProvisionAgent.run_job(\n    instance=device,\n    request=request,\n    name=f\"Provision Agent for {device.name}\"\n)\n</code></pre>"},{"location":"job_provisionagent/#immediate-provisioning","title":"Immediate Provisioning","text":"<pre><code>from netbox_zabbix.jobs.provision import ProvisionAgent\nfrom dcim.models import Device\n\n# Get a device to provision\ndevice = Device.objects.get(name=\"web-server-01\")\n\n# Provision immediately\nresult = ProvisionAgent.run_now(instance=device)\nprint(f\"Provisioning result: {result['message']}\")\n</code></pre>"},{"location":"job_provisionagent/#integration-with-other-components","title":"Integration with Other Components","text":"<ol> <li>AtomicJobRunner: Inherits transactional execution and error handling capabilities.</li> <li>Provisioning Functions: Uses <code>provision_zabbix_host</code> and <code>ProvisionContext</code> for provisioning logic.</li> <li>NetBox Models: Works with Device, VirtualMachine, HostConfig, and AgentInterface objects.</li> <li>Plugin Settings: Uses global settings for default agent configuration.</li> <li>Event Logging: Logs provisioning events to the EventLog model.</li> </ol>"},{"location":"job_provisionagent/#description","title":"Description","text":"<p>The ProvisionAgent job enables Zabbix agent-based monitoring for NetBox infrastructure. It performs the following operations:</p> <ol> <li>Retrieves the target NetBox instance (Device or VirtualMachine)</li> <li>Creates a HostConfig object in NetBox</li> <li>Creates an AgentInterface object with appropriate configuration</li> <li>Registers the new host in Zabbix with agent interface</li> <li>Applies templates and host groups based on mapping configurations</li> </ol> <p>This job is typically used when: - Onboarding new devices that will be monitored via Zabbix agent - Converting existing devices to agent-based monitoring - Setting up monitoring for virtual machines with agent support - Implementing standardized agent monitoring configurations</p> <p>The job leverages mapping configurations to automatically apply appropriate templates, host groups, proxies, and other settings based on device characteristics. It ensures that all necessary Zabbix configuration is created consistently and in accordance with organizational policies.</p>"},{"location":"job_provisionsnmp/","title":"ProvisionSNMP Job","text":""},{"location":"job_provisionsnmp/#provisionsnmp-job","title":"ProvisionSNMP Job","text":""},{"location":"job_provisionsnmp/#overview","title":"Overview","text":"<p>The <code>ProvisionSNMP</code> job provisions a Zabbix host using an SNMP interface. This job creates a Host configuration using the SNMP interface model and registers it in Zabbix, enabling SNMP-based monitoring for NetBox devices and virtual machines.</p>"},{"location":"job_provisionsnmp/#class-definition","title":"Class Definition","text":"<pre><code>class ProvisionSNMP(AtomicJobRunner)\n</code></pre>"},{"location":"job_provisionsnmp/#methods","title":"Methods","text":""},{"location":"job_provisionsnmp/#runcls-args-kwargs","title":"<code>run(cls, *args, **kwargs)</code>","text":"<p>Provisions an SNMP interface in Zabbix for the given instance.</p> <p>Returns: - <code>dict</code>: Result of provisioning.</p> <p>Raises: - <code>Exception</code>: If instance is invalid or provisioning fails.</p>"},{"location":"job_provisionsnmp/#run_jobcls-instance-request-schedule_atnone-intervalnone-immediatefalse-namenone","title":"<code>run_job(cls, instance, request, schedule_at=None, interval=None, immediate=False, name=None)</code>","text":"<p>Enqueues a ProvisionSNMP job.</p> <p>Returns: - <code>Job</code>: Enqueued job instance.</p>"},{"location":"job_provisionsnmp/#run_nowcls-instancenone-args-kwargs","title":"<code>run_now(cls, instance=None, *args, **kwargs)</code>","text":"<p>Immediately provisions an SNMP interface.</p> <p>Parameters: - <code>instance</code> (Device|VirtualMachine, optional): Target instance.</p>"},{"location":"job_provisionsnmp/#usage-examples","title":"Usage Examples","text":""},{"location":"job_provisionsnmp/#provisioning-an-snmp-interface","title":"Provisioning an SNMP Interface","text":"<pre><code>from netbox_zabbix.jobs.provision import ProvisionSNMP\nfrom dcim.models import Device\n\n# Get a device to provision\ndevice = Device.objects.get(name=\"network-switch-01\")\n\n# Provision SNMP interface\njob = ProvisionSNMP.run_job(\n    instance=device,\n    request=request,\n    name=f\"Provision SNMP for {device.name}\"\n)\n</code></pre>"},{"location":"job_provisionsnmp/#immediate-provisioning-with-custom-settings","title":"Immediate Provisioning with Custom Settings","text":"<pre><code>from netbox_zabbix.jobs.provision import ProvisionSNMP\nfrom dcim.models import Device\n\n# Get a device to provision\ndevice = Device.objects.get(name=\"network-switch-01\")\n\n# Provision immediately with custom SNMP settings\nresult = ProvisionSNMP.run_now(instance=device)\nprint(f\"Provisioning result: {result['message']}\")\n</code></pre>"},{"location":"job_provisionsnmp/#integration-with-other-components","title":"Integration with Other Components","text":"<ol> <li>AtomicJobRunner: Inherits transactional execution and error handling capabilities.</li> <li>Provisioning Functions: Uses <code>provision_zabbix_host</code> and <code>ProvisionContext</code> for provisioning logic.</li> <li>NetBox Models: Works with Device, VirtualMachine, HostConfig, and SNMPInterface objects.</li> <li>Plugin Settings: Uses global settings for default SNMP configuration.</li> <li>Event Logging: Logs provisioning events to the EventLog model.</li> </ol>"},{"location":"job_provisionsnmp/#description","title":"Description","text":"<p>The ProvisionSNMP job enables SNMP-based monitoring for NetBox infrastructure. It performs the following operations:</p> <ol> <li>Retrieves the target NetBox instance (Device or VirtualMachine)</li> <li>Creates a HostConfig object in NetBox</li> <li>Creates an SNMPInterface object with appropriate configuration</li> <li>Registers the new host in Zabbix with SNMP interface</li> <li>Applies templates and host groups based on mapping configurations</li> </ol> <p>This job is typically used when: - Onboarding network devices that will be monitored via SNMP - Converting existing devices to SNMP-based monitoring - Setting up monitoring for infrastructure without agent support - Implementing standardized SNMP monitoring configurations</p> <p>The job leverages mapping configurations to automatically apply appropriate templates, host groups, proxies, and other settings based on device characteristics. It uses global plugin settings to configure default SNMP parameters such as security names, authentication protocols, and privacy settings.</p> <p>Key SNMP configuration parameters supported: - SNMP version (v1, v2c, v3) - Security levels (noAuthNoPriv, authNoPriv, authPriv) - Authentication protocols (MD5, SHA1, SHA224, SHA256, SHA384, SHA512) - Privacy protocols (DES, AES128, AES192, AES256) - Context names for SNMPv3 - Bulk operation settings for improved performance</p>"},{"location":"job_synchostsnow/","title":"SyncHostsNow Job","text":""},{"location":"job_synchostsnow/#synchostsnow-job","title":"SyncHostsNow Job","text":""},{"location":"job_synchostsnow/#overview","title":"Overview","text":"<p>The <code>SyncHostsNow</code> job synchronizes all NetBox HostConfig objects with their corresponding hosts in Zabbix immediately. This job provides on-demand synchronization of the entire host configuration database.</p>"},{"location":"job_synchostsnow/#class-definition","title":"Class Definition","text":"<pre><code>class SyncHostsNow(AtomicJobRunner)\n</code></pre>"},{"location":"job_synchostsnow/#methods","title":"Methods","text":""},{"location":"job_synchostsnow/#runcls-args-kwargs","title":"<code>run(cls, *args, **kwargs)</code>","text":"<p>Execute the host synchronization.</p> <p>Parameters: - <code>user</code> (User, optional): The triggering user. - <code>request_id</code> (str, optional): Request identifier for logging.</p> <p>Returns: - <code>dict</code>: Summary of host sync results.</p>"},{"location":"job_synchostsnow/#run_job_nowcls-request","title":"<code>run_job_now(cls, request)</code>","text":"<p>Immediately execute the job in the current process.</p> <p>Parameters: - <code>request</code> (HttpRequest): The triggering request.</p> <p>Returns: - <code>dict</code>: Job execution summary.</p>"},{"location":"job_synchostsnow/#usage-examples","title":"Usage Examples","text":""},{"location":"job_synchostsnow/#running-full-synchronization","title":"Running Full Synchronization","text":"<pre><code>from netbox_zabbix.jobs.synchosts import SyncHostsNow\n\n# Run full synchronization immediately\nresult = SyncHostsNow.run_job_now(request)\nprint(f\"Sync result: {result['message']}\")\nprint(f\"Updated: {result['updated']}/{result['total']} hosts\")\n</code></pre>"},{"location":"job_synchostsnow/#using-run_now-method","title":"Using run_now Method","text":"<pre><code>from netbox_zabbix.jobs.synchosts import SyncHostsNow\n\n# Run full synchronization using run_now\nresult = SyncHostsNow.run_now(\n    user=request.user,\n    request_id=request.id\n)\nprint(f\"Sync completed: {result}\")\n</code></pre>"},{"location":"job_synchostsnow/#integration-with-other-components","title":"Integration with Other Components","text":"<ol> <li>AtomicJobRunner: Inherits transactional execution and error handling capabilities.</li> <li>Zabbix Hosts: Uses <code>update_zabbix_host</code> to synchronize each host.</li> <li>NetBox Models: Works with HostConfig objects.</li> <li>Plugin Settings: Respects event logging configuration.</li> <li>Event Logging: Logs synchronization events to the EventLog model.</li> </ol>"},{"location":"job_synchostsnow/#description","title":"Description","text":"<p>The SyncHostsNow job provides comprehensive synchronization of all NetBox HostConfig objects with their corresponding Zabbix hosts. Unlike recurring system jobs, this job runs on-demand and processes all hosts immediately.</p> <p>The job performs the following operations: 1. Iterates through all HostConfig objects in NetBox 2. Updates each host in Zabbix to match current NetBox configuration 3. Updates sync status for each host 4. Tracks success and failure statistics 5. Provides detailed execution summary</p> <p>This job is typically used when: - Performing initial synchronization after plugin installation - Recovering from widespread configuration drift - Validating that all hosts are properly configured - Running comprehensive maintenance operations - Troubleshooting synchronization issues across multiple hosts</p> <p>Key features: - Comprehensive Coverage: Processes all HostConfig objects - Individual Error Handling: Continues processing despite individual host failures - Detailed Reporting: Provides statistics on total, updated, and failed hosts - Transaction Safety: Executes within a database transaction - Progress Tracking: Logs progress for large host populations - Error Logging: Records individual host failure details</p> <p>The job ensures that all Zabbix host configurations remain synchronized with NetBox, including: - Host names and descriptions - Template assignments - Host group memberships - Interface configurations - Proxy or proxy group assignments - Host status (enabled/disabled) - Custom tags and inventory data</p> <p>Unlike scheduled system jobs that process subsets of hosts, SyncHostsNow provides a complete synchronization pass, making it ideal for maintenance windows or post-migration validation.</p>"},{"location":"job_systemjobhostconfigsyncrefresh/","title":"SystemJobHostConfigSyncRefresh","text":""},{"location":"job_systemjobhostconfigsyncrefresh/#systemjobhostconfigsyncrefresh-job","title":"SystemJobHostConfigSyncRefresh Job","text":""},{"location":"job_systemjobhostconfigsyncrefresh/#overview","title":"Overview","text":"<p>The <code>SystemJobHostConfigSyncRefresh</code> job periodically refreshes HostConfig sync status on a recurring interval. This system job ensures that the synchronization status between NetBox and Zabbix remains current for all monitored hosts.</p>"},{"location":"job_systemjobhostconfigsyncrefresh/#class-definition","title":"Class Definition","text":"<pre><code>class SystemJobHostConfigSyncRefresh(AtomicJobRunner)\n</code></pre>"},{"location":"job_systemjobhostconfigsyncrefresh/#methods","title":"Methods","text":""},{"location":"job_systemjobhostconfigsyncrefresh/#runcls-args-kwargs","title":"<code>run(cls, *args, **kwargs)</code>","text":"<p>Update HostConfig objects that haven't been checked recently.</p> <p>Parameters: - <code>cutoff</code> (int, optional): Custom cutoff time in minutes.</p> <p>Returns: - <code>dict</code>: Summary of updated hosts.</p> <p>Raises: - <code>Exception</code>: If any unexpected error occurs.</p>"},{"location":"job_systemjobhostconfigsyncrefresh/#schedulecls-intervalnone","title":"<code>schedule(cls, interval=None)</code>","text":"<p>Schedule this system job at a recurring interval.</p> <p>Parameters: - <code>interval</code> (int): Interval in minutes.</p> <p>Returns: - <code>Job</code>: Scheduled job instance.</p>"},{"location":"job_systemjobhostconfigsyncrefresh/#usage-examples","title":"Usage Examples","text":""},{"location":"job_systemjobhostconfigsyncrefresh/#scheduling-the-system-job","title":"Scheduling the System Job","text":"<pre><code>from netbox_zabbix.jobs.system import SystemJobHostConfigSyncRefresh\n\n# Schedule the job to run every 2 hours\njob = SystemJobHostConfigSyncRefresh.schedule(interval=120)\nprint(f\"Scheduled job: {job.name}\")\n</code></pre>"},{"location":"job_systemjobhostconfigsyncrefresh/#manual-execution","title":"Manual Execution","text":"<pre><code>from netbox_zabbix.jobs.system import SystemJobHostConfigSyncRefresh\n\n# Run the job immediately\nresult = SystemJobHostConfigSyncRefresh.run_now()\nprint(f\"Sync refresh result: Updated {result['updated']}/{result['total']} hosts\")\n</code></pre>"},{"location":"job_systemjobhostconfigsyncrefresh/#integration-with-other-components","title":"Integration with Other Components","text":"<ol> <li>AtomicJobRunner: Inherits transactional execution and error handling capabilities.</li> <li>System Job Registry: Registered with <code>settings.get_host_config_sync_interval</code> function.</li> <li>NetBox Models: Works with HostConfig objects.</li> <li>Plugin Settings: Uses <code>settings.get_host_config_sync_interval()</code> and <code>settings.get_cutoff_host_config_sync()</code> for scheduling.</li> <li>Sync Functions: Uses <code>HostConfig.update_sync_status()</code> to check synchronization.</li> <li>Event Logging: Logs sync refresh events to the EventLog model.</li> </ol>"},{"location":"job_systemjobhostconfigsyncrefresh/#description","title":"Description","text":"<p>The SystemJobHostConfigSyncRefresh job is a recurring system task that automatically updates the synchronization status of HostConfig objects. It ensures that the <code>in_sync</code> flag and <code>last_sync_update</code> timestamp remain current for all monitored hosts.</p> <p>The job performs the following operations: 1. Identifies HostConfig objects that haven't been checked recently (based on cutoff time) 2. Updates the sync status for each identified host 3. Records the update time for future reference 4. Tracks success and failure statistics 5. Provides detailed execution summary</p> <p>This system job is automatically scheduled based on the plugin's configuration and runs at regular intervals to maintain accurate sync status information. It's essential for: - Providing accurate sync status in the NetBox UI - Enabling proper filtering of out-of-sync hosts - Supporting automated remediation workflows - Maintaining audit trails of configuration consistency</p> <p>Key features: - Targeted Processing: Only checks hosts that haven't been recently updated - Automatic Scheduling: Self-manages scheduling based on plugin settings - Singleton Enforcement: Ensures only one instance runs at a time - Interval Management: Automatically reschedules with updated intervals - Flexible Cutoff: Uses configurable cutoff time to determine which hosts to check - Individual Error Handling: Continues processing despite individual host failures - Detailed Reporting: Provides statistics on total, updated, and failed hosts</p> <p>The job interval is controlled by the <code>host_config_sync_interval</code> setting in plugin configuration, while the cutoff time is controlled by <code>cutoff_host_config_sync</code>. Common configurations include: - Every hour with 60-minute cutoff - Every 2 hours with 120-minute cutoff - Every 4 hours with 180-minute cutoff - Daily with 1440-minute cutoff</p> <p>The cutoff mechanism ensures efficient operation by only checking hosts that haven't been recently verified, preventing unnecessary Zabbix API calls while maintaining reasonable sync status accuracy.</p>"},{"location":"job_systemjobimportzabbixsettings/","title":"SystemJobImportZabbixSettings","text":""},{"location":"job_systemjobimportzabbixsettings/#systemjobimportzabbixsettings-job","title":"SystemJobImportZabbixSettings Job","text":""},{"location":"job_systemjobimportzabbixsettings/#overview","title":"Overview","text":"<p>The <code>SystemJobImportZabbixSettings</code> job periodically imports Zabbix settings into NetBox on a configurable recurring interval. This system job ensures that NetBox maintains an up-to-date copy of global Zabbix configuration objects.</p>"},{"location":"job_systemjobimportzabbixsettings/#class-definition","title":"Class Definition","text":"<pre><code>class SystemJobImportZabbixSettings(AtomicJobRunner)\n</code></pre>"},{"location":"job_systemjobimportzabbixsettings/#methods","title":"Methods","text":""},{"location":"job_systemjobimportzabbixsettings/#runcls-args-kwargs","title":"<code>run(cls, *args, **kwargs)</code>","text":"<p>Imports Zabbix settings.</p> <p>Returns: - <code>dict</code>: Import summary.</p> <p>Raises: - <code>Exception</code>: If import fails.</p>"},{"location":"job_systemjobimportzabbixsettings/#schedulecls-intervalnone","title":"<code>schedule(cls, interval=None)</code>","text":"<p>Schedules the system job at a recurring interval.</p> <p>Parameters: - <code>interval</code> (int): Interval in minutes.</p> <p>Returns: - <code>Job</code>: Scheduled job instance.</p>"},{"location":"job_systemjobimportzabbixsettings/#usage-examples","title":"Usage Examples","text":""},{"location":"job_systemjobimportzabbixsettings/#scheduling-the-system-job","title":"Scheduling the System Job","text":"<pre><code>from netbox_zabbix.jobs.system import SystemJobImportZabbixSettings\n\n# Schedule the job to run every hour\njob = SystemJobImportZabbixSettings.schedule(interval=60)\nprint(f\"Scheduled job: {job.name}\")\n</code></pre>"},{"location":"job_systemjobimportzabbixsettings/#manual-execution","title":"Manual Execution","text":"<pre><code>from netbox_zabbix.jobs.system import SystemJobImportZabbixSettings\n\n# Run the job immediately\nresult = SystemJobImportZabbixSettings.run_now()\nprint(f\"Import result: {result['message']}\")\n</code></pre>"},{"location":"job_systemjobimportzabbixsettings/#integration-with-other-components","title":"Integration with Other Components","text":"<ol> <li>AtomicJobRunner: Inherits transactional execution and error handling capabilities.</li> <li>System Job Registry: Registered with <code>get_zabbix_import_interval</code> function.</li> <li>Zabbix API: Communicates with Zabbix to retrieve configuration objects.</li> <li>Import Functions: Uses <code>import_zabbix_settings</code> for the actual import logic.</li> <li>NetBox Models: Updates Template, Proxy, ProxyGroup, and HostGroup models.</li> <li>Plugin Settings: Uses <code>settings.get_zabbix_import_interval()</code> for scheduling.</li> <li>Event Logging: Logs import events to the EventLog model.</li> </ol>"},{"location":"job_systemjobimportzabbixsettings/#description","title":"Description","text":"<p>The SystemJobImportZabbixSettings job is a recurring system task that automatically synchronizes global Zabbix configuration objects with NetBox. It ensures that NetBox stays current with Zabbix templates, proxies, proxy groups, and host groups without manual intervention.</p> <p>The job performs the following operations: 1. Retrieves templates, proxies, proxy groups, and host groups from Zabbix 2. Updates corresponding NetBox models with the latest information 3. Creates new objects for previously unknown Zabbix entities 4. Updates existing objects with changed information 5. Reports import statistics and any errors encountered</p> <p>This system job is automatically scheduled based on the plugin's configuration and runs at regular intervals to maintain synchronization. It's essential for: - Keeping mapping configurations valid (they reference Zabbix objects) - Ensuring accurate template and proxy selections in UI - Maintaining up-to-date host group information - Supporting proper proxy group functionality</p> <p>Key features: - Automatic Scheduling: Self-manages scheduling based on plugin settings - Singleton Enforcement: Ensures only one instance runs at a time - Interval Management: Automatically reschedules with updated intervals - Conflict Resolution: Handles job replacement when intervals change - Error Resilience: Continues operation despite individual object failures - Detailed Reporting: Provides import statistics and error information</p> <p>The job interval is controlled by the <code>zabbix_import_interval</code> setting in plugin configuration, which can be configured through the NetBox UI. Common intervals include: - Hourly (60 minutes) - Every 2 hours (120 minutes) - Daily (1440 minutes) - Weekly (10080 minutes)</p> <p>This job enables features like template-based mapping, proxy assignments, and host group organization by ensuring that all referenced Zabbix objects exist and are current in NetBox.</p>"},{"location":"job_systemjobmaintenancecleanup/","title":"SystemJobMaintenanceCleanup","text":""},{"location":"job_systemjobmaintenancecleanup/#systemjobmaintenancecleanup-job","title":"SystemJobMaintenanceCleanup Job","text":""},{"location":"job_systemjobmaintenancecleanup/#overview","title":"Overview","text":"<p>The <code>SystemJobMaintenanceCleanup</code> job periodically cleans up expired Zabbix Maintenance windows from both NetBox and Zabbix. This system job ensures that completed maintenance schedules are properly removed from the system.</p>"},{"location":"job_systemjobmaintenancecleanup/#class-definition","title":"Class Definition","text":"<pre><code>class SystemJobMaintenanceCleanup(AtomicJobRunner)\n</code></pre>"},{"location":"job_systemjobmaintenancecleanup/#methods","title":"Methods","text":""},{"location":"job_systemjobmaintenancecleanup/#runcls-args-kwargs","title":"<code>run(cls, *args, **kwargs)</code>","text":"<p>Delete all expired maintenances whose end_time &lt;= now.</p> <p>Returns: - <code>dict</code>: Summary of cleanup operations.</p>"},{"location":"job_systemjobmaintenancecleanup/#schedulecls-intervalnone","title":"<code>schedule(cls, interval=None)</code>","text":"<p>Schedule this system job at a recurring interval.</p> <p>Parameters: - <code>interval</code> (int): Interval in minutes.</p> <p>Returns: - <code>Job</code>: Scheduled job instance.</p>"},{"location":"job_systemjobmaintenancecleanup/#usage-examples","title":"Usage Examples","text":""},{"location":"job_systemjobmaintenancecleanup/#scheduling-the-system-job","title":"Scheduling the System Job","text":"<pre><code>from netbox_zabbix.jobs.system import SystemJobMaintenanceCleanup\n\n# Schedule the job to run daily\njob = SystemJobMaintenanceCleanup.schedule(interval=1440)\nprint(f\"Scheduled job: {job.name}\")\n</code></pre>"},{"location":"job_systemjobmaintenancecleanup/#manual-execution","title":"Manual Execution","text":"<pre><code>from netbox_zabbix.jobs.system import SystemJobMaintenanceCleanup\n\n# Run the job immediately\nresult = SystemJobMaintenanceCleanup.run_now()\nprint(f\"Cleanup result: Deleted {result['deleted']}/{result['checked']} maintenances\")\n</code></pre>"},{"location":"job_systemjobmaintenancecleanup/#integration-with-other-components","title":"Integration with Other Components","text":"<ol> <li>AtomicJobRunner: Inherits transactional execution and error handling capabilities.</li> <li>System Job Registry: Registered with <code>settings.get_maintenance_cleanup_interval</code> function.</li> <li>NetBox Models: Works with Maintenance objects.</li> <li>Plugin Settings: Uses <code>settings.get_maintenance_cleanup_interval()</code> for scheduling.</li> <li>Zabbix API: Communicates with Zabbix to clean up maintenance windows.</li> <li>Event Logging: Logs cleanup events to the EventLog model.</li> </ol>"},{"location":"job_systemjobmaintenancecleanup/#description","title":"Description","text":"<p>The SystemJobMaintenanceCleanup job is a recurring system task that automatically removes expired maintenance windows from both NetBox and Zabbix. It prevents the accumulation of obsolete maintenance schedules and keeps the maintenance database clean.</p> <p>The job performs the following operations: 1. Identifies Maintenance objects with end_time in the past and status \"pending\" or \"active\" 2. Deletes each expired maintenance from NetBox 3. Removes corresponding maintenance windows from Zabbix 4. Logs successful deletions and any failures 5. Provides detailed execution summary</p> <p>This system job is automatically scheduled based on the plugin's configuration and runs at regular intervals to maintain a clean maintenance database. It's essential for: - Preventing database bloat from expired maintenances - Maintaining accurate maintenance listings in UI - Freeing up resources in both NetBox and Zabbix - Ensuring compliance with data retention policies</p> <p>Key features: - Automatic Cleanup: Self-manages expired maintenance removal - Dual System Cleanup: Removes maintenances from both NetBox and Zabbix - Automatic Scheduling: Self-manages scheduling based on plugin settings - Singleton Enforcement: Ensures only one instance runs at a time - Interval Management: Automatically reschedules with updated intervals - Individual Error Handling: Continues processing despite individual deletion failures - Detailed Reporting: Provides statistics on total checked and deleted maintenances - Logging: Records cleanup operations for audit purposes</p> <p>The job interval is controlled by the <code>maintenance_cleanup_interval</code> setting in plugin configuration. Common intervals include: - Daily (1440 minutes) - Weekly (10080 minutes) - Bi-weekly (20160 minutes) - Monthly (43200 minutes)</p> <p>The cleanup process respects the maintenance deletion settings configured in the plugin: - For hard deletion: Maintenance windows are permanently removed - For soft deletion: Behavior depends on specific implementation</p> <p>This job helps maintain system performance by preventing the accumulation of obsolete maintenance records while ensuring that historical maintenance data can still be accessed through NetBox's changelog and event log features.</p>"},{"location":"job_updatezabbixhost/","title":"UpdateZabbixHost Job","text":""},{"location":"job_updatezabbixhost/#updatezabbixhost-job","title":"UpdateZabbixHost Job","text":""},{"location":"job_updatezabbixhost/#overview","title":"Overview","text":"<p>The <code>UpdateZabbixHost</code> job updates an existing Zabbix host using HostConfig. This job synchronizes changes made to NetBox HostConfig objects with their corresponding Zabbix hosts, ensuring that monitoring configurations remain consistent.</p>"},{"location":"job_updatezabbixhost/#class-definition","title":"Class Definition","text":"<pre><code>class UpdateZabbixHost(AtomicJobRunner)\n</code></pre>"},{"location":"job_updatezabbixhost/#methods","title":"Methods","text":""},{"location":"job_updatezabbixhost/#runcls-args-kwargs","title":"<code>run(cls, *args, **kwargs)</code>","text":"<p>Updates the host in Zabbix with the current HostConfig.</p> <p>Returns: - <code>dict</code>: Updated host information.</p> <p>Raises: - <code>Exception</code>: If update fails.</p>"},{"location":"job_updatezabbixhost/#run_jobcls-host_config-request-usernone-schedule_atnone-intervalnone-immediatefalse-namenone-signal_idnone","title":"<code>run_job(cls, host_config, request, user=None, schedule_at=None, interval=None, immediate=False, name=None, signal_id=None)</code>","text":"<p>Enqueues an UpdateZabbixHost job.</p> <p>Parameters: - <code>host_config</code> (HostConfig): Host to update. - <code>request</code> (HttpRequest): Triggering request. - <code>user</code> (User, optional): User initiating the update. - <code>schedule_at</code> (datetime, optional): Schedule time. - <code>interval</code> (int, optional): Interval for recurring job. - <code>immediate</code> (bool, optional): Run immediately. - <code>name</code> (str, optional): Job name. - <code>signal_id</code> (str, optional): Signal identifier for event correlation.</p> <p>Returns: - <code>Job</code>: Enqueued job instance.</p>"},{"location":"job_updatezabbixhost/#run_job_nowcls-host_config-request-namenone","title":"<code>run_job_now(cls, host_config, request, name=None)</code>","text":"<p>Immediately updates a Zabbix host.</p> <p>Parameters: - <code>host_config</code> (HostConfig): Host to update. - <code>request</code> (HttpRequest): Triggering request. - <code>name</code> (str, optional): Job name.</p> <p>Returns: - <code>dict</code>: Result of immediate update.</p>"},{"location":"job_updatezabbixhost/#usage-examples","title":"Usage Examples","text":""},{"location":"job_updatezabbixhost/#updating-a-zabbix-host","title":"Updating a Zabbix Host","text":"<pre><code>from netbox_zabbix.jobs.host import UpdateZabbixHost\nfrom netbox_zabbix.models import HostConfig\n\n# Get a host configuration to update in Zabbix\nhost_config = HostConfig.objects.get(name=\"web-server-01\")\n\n# Update the host in Zabbix\njob = UpdateZabbixHost.run_job(\n    host_config=host_config,\n    request=request,\n    name=f\"Update host {host_config.name} in Zabbix\"\n)\n</code></pre>"},{"location":"job_updatezabbixhost/#immediate-host-update","title":"Immediate Host Update","text":"<pre><code>from netbox_zabbix.jobs.host import UpdateZabbixHost\nfrom netbox_zabbix.models import HostConfig\n\n# Get a host configuration\nhost_config = HostConfig.objects.get(name=\"web-server-01\")\n\n# Update host immediately\nresult = UpdateZabbixHost.run_job_now(\n    host_config=host_config,\n    request=request\n)\nprint(f\"Host update result: {result['message']}\")\n</code></pre>"},{"location":"job_updatezabbixhost/#integration-with-other-components","title":"Integration with Other Components","text":"<ol> <li>AtomicJobRunner: Inherits transactional execution and error handling capabilities.</li> <li>Zabbix Hosts: Uses <code>update_zabbix_host</code> to synchronize host configuration.</li> <li>NetBox Models: Works with HostConfig objects.</li> <li>Event Logging: Logs host update events to the EventLog model.</li> </ol>"},{"location":"job_updatezabbixhost/#description","title":"Description","text":"<p>The UpdateZabbixHost job synchronizes NetBox HostConfig objects with their corresponding Zabbix hosts. It performs the following operations:</p> <ol> <li>Retrieves the HostConfig object from NetBox</li> <li>Updates the corresponding host in Zabbix with current configuration</li> <li>Synchronizes templates, host groups, interfaces, and other settings</li> <li>Ensures Zabbix host configuration matches NetBox definitions</li> </ol> <p>This job is typically used when: - HostConfig objects have been modified in NetBox - Template or host group assignments have changed - Interface configurations have been updated - Proxy or proxy group assignments have changed - Host status (enabled/disabled) has been modified - Recovering from configuration drift between NetBox and Zabbix</p> <p>Key features: - Transaction Safety: Executes within a database transaction to ensure consistency - Comprehensive Sync: Updates all host configuration aspects - Flexible Scheduling: Supports both immediate and scheduled updates - User Tracking: Preserves user information for audit purposes - Signal Correlation: Supports signal ID tracking for event correlation - Error Handling: Provides clear error messages on update failures</p> <p>The job ensures that all Zabbix host configuration remains synchronized with NetBox, including: - Host name and description - Template assignments based on current mapping configurations - Host group memberships - Interface configurations (adding, removing, or updating interfaces) - Proxy or proxy group assignments - Host status (enabled/disabled) - Custom tags and inventory data - Maintenance window associations</p>"},{"location":"job_updatezabbixinterface/","title":"UpdateZabbixInterface Job","text":""},{"location":"job_updatezabbixinterface/#updatezabbixinterface-job","title":"UpdateZabbixInterface Job","text":""},{"location":"job_updatezabbixinterface/#overview","title":"Overview","text":"<p>The <code>UpdateZabbixInterface</code> job updates existing Zabbix interfaces for a HostConfig. This job synchronizes interface configurations between NetBox and Zabbix, ensuring that changes made in NetBox are reflected in the corresponding Zabbix interfaces.</p>"},{"location":"job_updatezabbixinterface/#class-definition","title":"Class Definition","text":"<pre><code>class UpdateZabbixInterface(BaseZabbixInterfaceJob)\n</code></pre>"},{"location":"job_updatezabbixinterface/#methods","title":"Methods","text":""},{"location":"job_updatezabbixinterface/#runcls-args-kwargs","title":"<code>run(cls, *args, **kwargs)</code>","text":"<p>Updates the Zabbix host/interface and links missing interfaces.</p> <p>Returns: - <code>dict</code>: Result of the interface update.</p> <p>Raises: - <code>Exception</code>: If the HostConfig has no associated Zabbix host.</p>"},{"location":"job_updatezabbixinterface/#usage-examples","title":"Usage Examples","text":""},{"location":"job_updatezabbixinterface/#updating-interfaces","title":"Updating Interfaces","text":"<pre><code>from netbox_zabbix.jobs.interface import UpdateZabbixInterface\nfrom netbox_zabbix.models import HostConfig\n\n# Get a host configuration that needs interface updates\nhost_config = HostConfig.objects.get(name=\"web-server-01\")\n\n# Update interfaces\njob = UpdateZabbixInterface.run_job(\n    host_config=host_config,\n    request=request,\n    name=f\"Update interfaces for {host_config.name}\"\n)\n</code></pre>"},{"location":"job_updatezabbixinterface/#immediate-interface-update","title":"Immediate Interface Update","text":"<pre><code>from netbox_zabbix.jobs.interface import UpdateZabbixInterface\nfrom netbox_zabbix.models import HostConfig\n\n# Get a host configuration\nhost_config = HostConfig.objects.get(name=\"web-server-01\")\n\n# Update interfaces immediately\nresult = UpdateZabbixInterface.run_now(\n    host_config_id=host_config.id,\n    user=request.user,\n    request_id=request.id\n)\nprint(f\"Interface update result: {result['message']}\")\n</code></pre>"},{"location":"job_updatezabbixinterface/#integration-with-other-components","title":"Integration with Other Components","text":"<ol> <li>BaseZabbixInterfaceJob: Inherits common interface job functionality.</li> <li>AtomicJobRunner: Inherits transactional execution and error handling capabilities.</li> <li>Zabbix Hosts: Uses <code>update_zabbix_host</code> to synchronize host configuration.</li> <li>Zabbix Interfaces: Uses <code>link_missing_zabbix_interface</code> to associate interfaces.</li> <li>NetBox Models: Works with HostConfig objects.</li> <li>Event Logging: Logs interface update events to the EventLog model.</li> </ol>"},{"location":"job_updatezabbixinterface/#description","title":"Description","text":"<p>The UpdateZabbixInterface job ensures that Zabbix interface configurations match their corresponding NetBox HostConfig definitions. It performs the following operations:</p> <ol> <li>Verifies that the HostConfig has an associated Zabbix host ID</li> <li>Links any missing Zabbix interfaces to their NetBox counterparts</li> <li>Updates the Zabbix host configuration to match NetBox definitions</li> <li>Ensures interface consistency between NetBox and Zabbix</li> </ol> <p>This job is typically used when: - Interface configurations have been modified in NetBox - Network settings such as IP addresses or ports have changed - SNMP or agent parameters need to be updated - Interface types or settings have been modified - Recovering from interface synchronization issues</p> <p>The job provides a targeted approach to interface management, allowing administrators to ensure interface consistency without performing full host updates. It's particularly useful in scenarios where only interface configuration has changed while other host settings remain valid.</p> <p>Key features: - Validation: Ensures the HostConfig has a valid Zabbix host ID before proceeding - Linking: Automatically associates Zabbix interfaces with NetBox interface objects - Synchronization: Updates Zabbix interface parameters to match NetBox definitions - Transaction Safety: Executes within a database transaction to ensure consistency - Error Handling: Provides clear error messages when interface updates fail</p> <p>The job complements the CreateZabbixInterface job by focusing on updating existing interfaces rather than creating new ones, providing a complete interface management solution.</p>"},{"location":"job_validatehost/","title":"ValidateHost Job","text":""},{"location":"job_validatehost/#validatehost-job","title":"ValidateHost Job","text":""},{"location":"job_validatehost/#overview","title":"Overview","text":"<p>The <code>ValidateHost</code> job validates a Zabbix host configuration against a NetBox device or virtual machine. This job ensures that host configurations in Zabbix match the expected state in NetBox, helping to detect configuration drift or inconsistencies.</p>"},{"location":"job_validatehost/#class-definition","title":"Class Definition","text":"<pre><code>class ValidateHost(AtomicJobRunner)\n</code></pre>"},{"location":"job_validatehost/#methods","title":"Methods","text":""},{"location":"job_validatehost/#runcls-args-kwargs","title":"<code>run(cls, *args, **kwargs)</code>","text":"<p>Validates the Zabbix host configuration for a given instance.</p> <p>Returns: - <code>bool</code>: True if validation passes.</p> <p>Raises: - <code>Exception</code>: If the host cannot be validated or instance is invalid.</p>"},{"location":"job_validatehost/#run_jobcls-instance-request-schedule_atnone-intervalnone-immediatefalse-namenone","title":"<code>run_job(cls, instance, request, schedule_at=None, interval=None, immediate=False, name=None)</code>","text":"<p>Enqueues a host validation job.</p> <p>Parameters: - <code>instance</code> (Device|VirtualMachine): Target instance. - <code>request</code> (HttpRequest): HTTP request triggering the job. - <code>schedule_at</code> (datetime, optional): Schedule time. - <code>interval</code> (int, optional): Interval for recurring job. - <code>immediate</code> (bool, optional): Run job immediately. - <code>name</code> (str, optional): Job name.</p> <p>Returns: - <code>Job</code>: Enqueued job instance.</p>"},{"location":"job_validatehost/#run_nowcls-instancenone-args-kwargs","title":"<code>run_now(cls, instance=None, *args, **kwargs)</code>","text":"<p>Executes the validation immediately.</p> <p>Parameters: - <code>instance</code> (Device|VirtualMachine, optional): Target instance.</p> <p>Returns: - <code>dict</code>: Validation result.</p>"},{"location":"job_validatehost/#usage-examples","title":"Usage Examples","text":""},{"location":"job_validatehost/#running-validation-immediately","title":"Running Validation Immediately","text":"<pre><code>from netbox_zabbix.jobs.validate import ValidateHost\nfrom dcim.models import Device\n\n# Get a device to validate\ndevice = Device.objects.get(name=\"web-server-01\")\n\n# Run validation immediately\nresult = ValidateHost.run_now(instance=device)\nprint(result)\n</code></pre>"},{"location":"job_validatehost/#scheduling-validation-job","title":"Scheduling Validation Job","text":"<pre><code>from netbox_zabbix.jobs.validate import ValidateHost\nfrom dcim.models import Device\n\n# Get a device to validate\ndevice = Device.objects.get(name=\"web-server-01\")\n\n# Schedule validation job\njob = ValidateHost.run_job(\n    instance=device,\n    request=request,\n    name=f\"Validate host {device.name}\"\n)\n</code></pre>"},{"location":"job_validatehost/#integration-with-other-components","title":"Integration with Other Components","text":"<ol> <li>AtomicJobRunner: Inherits transactional execution and error handling capabilities.</li> <li>Zabbix API: Uses <code>get_host</code> to retrieve Zabbix host information.</li> <li>Zabbix Validation: Uses <code>validate_zabbix_host</code> to compare configurations.</li> <li>NetBox Models: Works with Device and VirtualMachine objects.</li> <li>Event Logging: Logs validation events to the EventLog model.</li> </ol>"},{"location":"job_validatehost/#description","title":"Description","text":"<p>The ValidateHost job is essential for maintaining synchronization between NetBox and Zabbix configurations. It performs the following operations:</p> <ol> <li>Retrieves the target NetBox instance (Device or VirtualMachine)</li> <li>Fetches the corresponding host from Zabbix</li> <li>Compares the Zabbix host configuration with the expected NetBox configuration</li> <li>Reports validation results or raises exceptions on failures</li> </ol> <p>This job helps administrators identify configuration drift and ensures that monitoring configurations remain consistent with infrastructure definitions. It can be run on-demand for specific hosts or scheduled for regular validation of critical infrastructure components.</p>"},{"location":"jobs_overview/","title":"Jobs Overview","text":""},{"location":"jobs_overview/#netbox-zabbix-plugin---jobs-overview","title":"NetBox Zabbix Plugin - Jobs Overview","text":""},{"location":"jobs_overview/#overview","title":"Overview","text":"<p>The NetBox Zabbix plugin uses a comprehensive job system to handle asynchronous operations between NetBox and Zabbix. These jobs are implemented using NetBox's RQ-based job framework and provide transactional execution, error handling, and event logging capabilities.</p> <p>Jobs in the plugin are categorized into several types: - Validation Jobs: Validate synchronization status between NetBox and Zabbix - Import Jobs: Import data from Zabbix into NetBox - Provisioning Jobs: Create new host configurations in Zabbix - Interface Jobs: Manage Zabbix interfaces for existing hosts - Host Management Jobs: Create, update, and delete Zabbix hosts - System Jobs: Recurring background tasks for maintenance and synchronization</p> <p>All jobs inherit from the <code>AtomicJobRunner</code> base class, which ensures transactional execution and proper error propagation.</p>"},{"location":"jobs_overview/#job-categories","title":"Job Categories","text":""},{"location":"jobs_overview/#validation-jobs","title":"Validation Jobs","text":"<p>Jobs that validate the synchronization status between NetBox and Zabbix.</p>"},{"location":"jobs_overview/#validatehost","title":"ValidateHost","text":"<p>Validates a Zabbix host configuration for a given NetBox Device or VirtualMachine, raising exceptions on validation failures or misconfigured instances.</p>"},{"location":"jobs_overview/#import-jobs","title":"Import Jobs","text":"<p>Jobs that import data from Zabbix into NetBox.</p>"},{"location":"jobs_overview/#importzabbixsettings","title":"ImportZabbixSettings","text":"<p>Synchronizes global Zabbix entities such as templates, proxies, proxy groups, and host groups into NetBox models.</p>"},{"location":"jobs_overview/#importhost","title":"ImportHost","text":"<p>Imports a single Zabbix host into NetBox, creating or updating a corresponding HostConfig for a Device or VirtualMachine.</p>"},{"location":"jobs_overview/#provisioning-jobs","title":"Provisioning Jobs","text":"<p>Jobs that create new host configurations in Zabbix.</p>"},{"location":"jobs_overview/#provisionagent","title":"ProvisionAgent","text":"<p>Provisions a Zabbix host using an Agent interface. This job creates a Host Configuration using the Agent interface model and registers it in Zabbix.</p>"},{"location":"jobs_overview/#provisionsnmp","title":"ProvisionSNMP","text":"<p>Provisions a Zabbix host using an SNMP interface. This job creates a Host configuration using the SNMP interface model and registers it in Zabbix.</p>"},{"location":"jobs_overview/#interface-jobs","title":"Interface Jobs","text":"<p>Jobs that manage Zabbix interfaces for existing hosts.</p>"},{"location":"jobs_overview/#basezabbixinterfacejob","title":"BaseZabbixInterfaceJob","text":"<p>Abstract base class providing shared enqueue logic for interface jobs.</p>"},{"location":"jobs_overview/#createzabbixinterface","title":"CreateZabbixInterface","text":"<p>Creates missing interfaces in Zabbix for a HostConfig.</p>"},{"location":"jobs_overview/#updatezabbixinterface","title":"UpdateZabbixInterface","text":"<p>Synchronizes existing interfaces in Zabbix for a HostConfig.</p>"},{"location":"jobs_overview/#host-management-jobs","title":"Host Management Jobs","text":"<p>Jobs that create, update, and delete Zabbix hosts.</p>"},{"location":"jobs_overview/#createzabbixhost","title":"CreateZabbixHost","text":"<p>Creates a new Zabbix host from a HostConfig.</p>"},{"location":"jobs_overview/#updatezabbixhost","title":"UpdateZabbixHost","text":"<p>Updates an existing Zabbix host using HostConfig.</p>"},{"location":"jobs_overview/#deletezabbixhost","title":"DeleteZabbixHost","text":"<p>Deletes a Zabbix host, supporting both soft and hard deletion.</p>"},{"location":"jobs_overview/#system-jobs","title":"System Jobs","text":"<p>Recurring background tasks for maintenance and synchronization.</p>"},{"location":"jobs_overview/#synchostsnow","title":"SyncHostsNow","text":"<p>Synchronizes all NetBox HostConfig objects with their corresponding hosts in Zabbix immediately.</p>"},{"location":"jobs_overview/#systemjobimportzabbixsettings","title":"SystemJobImportZabbixSettings","text":"<p>Periodically imports Zabbix settings into NetBox on a configurable recurring interval.</p>"},{"location":"jobs_overview/#systemjobhostconfigsyncrefresh","title":"SystemJobHostConfigSyncRefresh","text":"<p>Refreshes HostConfig sync status on a recurring interval.</p>"},{"location":"jobs_overview/#systemjobmaintenancecleanup","title":"SystemJobMaintenanceCleanup","text":"<p>Cleans up expired Zabbix Maintenance windows from both NetBox and Zabbix.</p>"},{"location":"jobs_overview/#base-classes","title":"Base Classes","text":""},{"location":"jobs_overview/#atomicjobrunner","title":"AtomicJobRunner","text":"<p>JobRunner that ensures transactional execution and propagates exceptions. This class provides enhanced error handling, transactional integrity, and event logging capabilities for all plugin jobs.</p>"},{"location":"maintenance_model/","title":"Maintenance Model","text":""},{"location":"maintenance_model/#netbox-zabbix-plugin---maintenance-model-documentation","title":"NetBox Zabbix Plugin - Maintenance Model Documentation","text":""},{"location":"maintenance_model/#overview","title":"Overview","text":"<p>The Maintenance model in the NetBox Zabbix plugin represents scheduled maintenance windows for Zabbix hosts. This document explains the Maintenance model's structure, fields, properties, methods, and usage.</p>"},{"location":"maintenance_model/#model-definition","title":"Model Definition","text":"<p>The Maintenance model (<code>netbox_zabbix.models.Maintenance</code>) defines time periods during which one or more hosts are put into maintenance mode in Zabbix. Maintenance windows can target hosts derived from Sites, HostGroups, ProxyGroups, Clusters, or specific HostConfig objects.</p>"},{"location":"maintenance_model/#fields","title":"Fields","text":"Field Type Description Notes <code>name</code> CharField (max_length=200) Maintenance window name Human-readable identifier <code>start_time</code> DateTimeField Maintenance start time Default: timezone.now() <code>end_time</code> DateTimeField Maintenance end time Required <code>disable_data_collection</code> BooleanField Disable data collection Default: False <code>host_configs</code> ManyToManyField (HostConfig) Direct host targets Specific host configurations <code>sites</code> ManyToManyField (Site) Site targets Sites whose hosts are included <code>host_groups</code> ManyToManyField (HostGroup) Host group targets Host groups whose hosts are included <code>proxies</code> ManyToManyField (Proxy) Proxy targets Proxies whose hosts are included <code>proxy_groups</code> ManyToManyField (ProxyGroup) Proxy group targets Proxy groups whose hosts are included <code>clusters</code> ManyToManyField (Cluster) Cluster targets Clusters whose hosts are included <code>zabbix_id</code> CharField (max_length=50) Zabbix maintenance ID Assigned by Zabbix when synced <code>status</code> CharField Maintenance status Default: 'pending'. Options: 'pending', 'active', 'expired', 'failed' <code>description</code> TextField Maintenance description Optional detailed description"},{"location":"maintenance_model/#name","title":"<code>name</code>","text":"<p>A human-readable name for the maintenance window that helps identify its purpose.</p>"},{"location":"maintenance_model/#start_time-and-end_time","title":"<code>start_time</code> and <code>end_time</code>","text":"<p>Define the time period during which the maintenance window is active. These times are used both in NetBox and when creating the maintenance window in Zabbix.</p>"},{"location":"maintenance_model/#disable_data_collection","title":"<code>disable_data_collection</code>","text":"<p>When set to <code>True</code>, Zabbix will not collect data from hosts during the maintenance window. When <code>False</code>, monitoring continues but problems are suppressed.</p>"},{"location":"maintenance_model/#target-fields","title":"Target Fields","text":"<p>Multiple targeting options allow flexible maintenance window creation: - <code>host_configs</code>: Direct assignment of specific host configurations - <code>sites</code>: All hosts associated with specified sites - <code>host_groups</code>: All hosts belonging to specified host groups - <code>proxies</code>: All hosts monitored by specified proxies - <code>proxy_groups</code>: All hosts monitored by specified proxy groups - <code>clusters</code>: All virtual machines in specified clusters</p>"},{"location":"maintenance_model/#status","title":"<code>status</code>","text":"<p>Tracks the current state of the maintenance window: - <code>pending</code>: Maintenance is scheduled but not yet active - <code>active</code>: Maintenance is currently in progress - <code>expired</code>: Maintenance period has passed - <code>failed</code>: An error occurred during maintenance operations</p>"},{"location":"maintenance_model/#properties","title":"Properties","text":""},{"location":"maintenance_model/#is_active","title":"<code>is_active</code>","text":"<p>Returns <code>True</code> if the maintenance window is currently active (current time is between start_time and end_time).</p>"},{"location":"maintenance_model/#disable_data_collection_value","title":"<code>disable_data_collection_value</code>","text":"<p>Returns a formatted HTML string with a green checkmark if data collection is disabled during maintenance, or a red X if it's enabled.</p>"},{"location":"maintenance_model/#methods","title":"Methods","text":""},{"location":"maintenance_model/#__str__","title":"<code>__str__()</code>","text":"<p>Returns a human-readable string representation of the maintenance window in the format: <code>{name} ({local_start_time})</code>.</p> <p>Returns: - <code>str</code>: Human-readable string representation</p>"},{"location":"maintenance_model/#get_absolute_url","title":"<code>get_absolute_url()</code>","text":"<p>Returns the canonical URL for this maintenance window within the NetBox plugin UI.</p> <p>Returns: - <code>str</code>: Absolute URL for the maintenance window</p>"},{"location":"maintenance_model/#get_matching_host_configs","title":"<code>get_matching_host_configs()</code>","text":"<p>Returns a queryset of HostConfig objects that match this maintenance window based on the configured targets (sites, host groups, proxies, proxy groups, clusters, or direct host assignments).</p> <p>Returns: - <code>QuerySet</code>: Matching HostConfig objects</p>"},{"location":"maintenance_model/#_build_params","title":"<code>_build_params()</code>","text":"<p>Constructs the parameters dictionary for Zabbix API create/update maintenance calls. This method resolves all target hosts and builds the appropriate Zabbix API parameters.</p> <p>Returns: - <code>dict</code>: Parameters dictionary for Zabbix API calls</p>"},{"location":"maintenance_model/#create_maintenance_window","title":"<code>create_maintenance_window()</code>","text":"<p>Creates a new maintenance window in Zabbix with the current configuration and updates the <code>zabbix_id</code> and <code>status</code> fields.</p>"},{"location":"maintenance_model/#update_maintenance_window","title":"<code>update_maintenance_window()</code>","text":"<p>Updates an existing maintenance window in Zabbix. Requires that the <code>zabbix_id</code> field is already populated.</p>"},{"location":"maintenance_model/#deleteargs-kwargs","title":"<code>delete(*args, **kwargs)</code>","text":"<p>Attempts to delete the maintenance window from Zabbix. If successful, also removes it from NetBox. If Zabbix deletion fails, returns a warning but still removes from NetBox.</p>"},{"location":"maintenance_model/#usage-examples","title":"Usage Examples","text":""},{"location":"maintenance_model/#creating-a-maintenance-window","title":"Creating a Maintenance Window","text":"<pre><code>from netbox_zabbix.models import Maintenance\nfrom django.utils import timezone\nfrom datetime import timedelta\n\n# Create a maintenance window\nmaintenance = Maintenance.objects.create(\n    name=\"Database Server Maintenance\",\n    start_time=timezone.now(),\n    end_time=timezone.now() + timedelta(hours=2),\n    disable_data_collection=True,\n    description=\"Scheduled maintenance for database servers\"\n)\n</code></pre>"},{"location":"maintenance_model/#targeting-specific-hosts","title":"Targeting Specific Hosts","text":"<pre><code>from netbox_zabbix.models import HostConfig, HostGroup\n\n# Add specific host configs to maintenance\nhost1 = HostConfig.objects.get(name=\"db-server-01\")\nhost2 = HostConfig.objects.get(name=\"db-server-02\")\nmaintenance.host_configs.add(host1, host2)\n\n# Add host groups to maintenance\nprod_db_group = HostGroup.objects.get(name=\"Production Database Servers\")\nmaintenance.host_groups.add(prod_db_group)\n</code></pre>"},{"location":"maintenance_model/#targeting-by-site-or-cluster","title":"Targeting by Site or Cluster","text":"<pre><code>from dcim.models import Site\nfrom virtualization.models import Cluster\n\n# Target all hosts in specific sites\ndatacenter_site = Site.objects.get(name=\"Datacenter A\")\nmaintenance.sites.add(datacenter_site)\n\n# Target all VMs in specific clusters\ndatabase_cluster = Cluster.objects.get(name=\"Database Cluster\")\nmaintenance.clusters.add(database_cluster)\n</code></pre>"},{"location":"maintenance_model/#synchronizing-with-zabbix","title":"Synchronizing with Zabbix","text":"<pre><code># Create the maintenance window in Zabbix\ntry:\n    maintenance.create_maintenance_window()\n    print(f\"Maintenance created in Zabbix with ID: {maintenance.zabbix_id}\")\nexcept Exception as e:\n    print(f\"Failed to create maintenance in Zabbix: {e}\")\n\n# Update an existing maintenance window\nmaintenance.description = \"Extended maintenance due to complications\"\nmaintenance.end_time = maintenance.end_time + timedelta(hours=1)\nmaintenance.update_maintenance_window()\n</code></pre>"},{"location":"maintenance_model/#checking-maintenance-status","title":"Checking Maintenance Status","text":"<pre><code># Check if maintenance is currently active\nif maintenance.is_active:\n    print(\"Maintenance is currently active\")\n\n# Check data collection status\nif maintenance.disable_data_collection:\n    print(\"Data collection is disabled during this maintenance\")\n</code></pre>"},{"location":"maintenance_model/#integration-with-other-models","title":"Integration with Other Models","text":"<p>Maintenance integrates with several other models in the plugin:</p> <ol> <li>HostConfig Model: Maintenance windows can directly target specific HostConfig objects.</li> <li>Site Model: Maintenance windows can target all hosts associated with specific sites.</li> <li>HostGroup Model: Maintenance windows can target all hosts belonging to specific host groups.</li> <li>Proxy Model: Maintenance windows can target all hosts monitored by specific proxies.</li> <li>ProxyGroup Model: Maintenance windows can target all hosts monitored by specific proxy groups.</li> <li>Cluster Model: Maintenance windows can target all virtual machines in specific clusters.</li> </ol>"},{"location":"maintenance_model/#description","title":"Description","text":"<p>The Maintenance model provides comprehensive scheduling capabilities for planned downtime and maintenance activities in Zabbix monitoring. It offers flexible targeting options and integrates seamlessly with NetBox infrastructure objects.</p> <p>Key features include: - Flexible time-based scheduling with start and end times - Configurable data collection suppression during maintenance - Multiple targeting mechanisms for precise host selection - Automatic synchronization with Zabbix maintenance windows - Status tracking for maintenance window lifecycle management - Integration with core NetBox models for comprehensive targeting - Robust error handling for Zabbix API operations</p>"},{"location":"mapping_models/","title":"Mapping Models","text":""},{"location":"mapping_models/#mapping-models","title":"Mapping Models","text":""},{"location":"mapping_models/#overview","title":"Overview","text":"<p>The Mapping models in the NetBox Zabbix plugin define how NetBox objects (devices and virtual machines) are mapped to Zabbix monitoring configurations. This document explains the Mapping, DeviceMapping, and VMMapping models' structure, fields, properties, methods, and usage.</p>"},{"location":"mapping_models/#model-definition","title":"Model Definition","text":"<p>The Mapping models provide a flexible system for defining how NetBox objects should be configured in Zabbix. The base <code>Mapping</code> model defines common configuration elements, while <code>DeviceMapping</code> and <code>VMMapping</code> inherit from it to provide object-specific functionality.</p> <p>Mappings allow administrators to automatically configure Zabbix monitoring for NetBox devices and virtual machines based on their characteristics. More specific mappings (those with more filter criteria) take precedence over less specific ones.</p>"},{"location":"mapping_models/#fields","title":"Fields","text":"Field Type Description Notes <code>name</code> CharField (max_length=255) Name of the mapping Human-readable identifier <code>description</code> TextField Description of the mapping Optional <code>default</code> BooleanField Default mapping flag Only one default mapping per type allowed <code>host_groups</code> ManyToManyField (HostGroup) Assigned host groups Used for matching hosts <code>templates</code> ManyToManyField (Template) Assigned templates Multiple templates can be selected <code>proxy</code> ForeignKey (Proxy) Assigned proxy Optional proxy for matching hosts <code>proxy_group</code> ForeignKey (ProxyGroup) Assigned proxy group Optional proxy group for matching hosts <code>interface_type</code> IntegerField Interface type limitation Default: Any. Options: Any (0), Agent (1), SNMP (2) <code>sites</code> ManyToManyField (Site) Site filters Restrict to specific sites <code>roles</code> ManyToManyField (DeviceRole) Role filters Restrict to specific roles <code>platforms</code> ManyToManyField (Platform) Platform filters Restrict to specific platforms"},{"location":"mapping_models/#name","title":"<code>name</code>","text":"<p>Human-readable identifier for the mapping. Should be descriptive and unique within the mapping type.</p>"},{"location":"mapping_models/#description","title":"<code>description</code>","text":"<p>Optional text field providing additional context about the mapping's purpose or configuration.</p>"},{"location":"mapping_models/#default","title":"<code>default</code>","text":"<p>Boolean flag indicating whether this is the default mapping. Only one mapping of each type (DeviceMapping, VMMapping) can be marked as default. The default mapping is used when no other mappings match a device or VM.</p>"},{"location":"mapping_models/#host_groups","title":"<code>host_groups</code>","text":"<p>Many-to-many relationship to HostGroup objects. When a device or VM matches this mapping, it will be assigned to these host groups in Zabbix.</p>"},{"location":"mapping_models/#templates","title":"<code>templates</code>","text":"<p>Many-to-many relationship to Template objects. When a device or VM matches this mapping, these templates will be applied in Zabbix.</p>"},{"location":"mapping_models/#proxy","title":"<code>proxy</code>","text":"<p>Foreign key to a Proxy object. When a device or VM matches this mapping, it will be monitored by this proxy.</p>"},{"location":"mapping_models/#proxy_group","title":"<code>proxy_group</code>","text":"<p>Foreign key to a ProxyGroup object. When a device or VM matches this mapping, it will be monitored by this proxy group.</p>"},{"location":"mapping_models/#interface_type","title":"<code>interface_type</code>","text":"<p>Integer field limiting the mapping to specific interface types: - <code>Any</code> (0): Matches devices/VMs with any interface type - <code>Agent</code> (1): Matches devices/VMs with Zabbix agent interfaces - <code>SNMP</code> (2): Matches devices/VMs with SNMP interfaces</p>"},{"location":"mapping_models/#filter-fields-sites-roles-platforms","title":"Filter Fields (<code>sites</code>, <code>roles</code>, <code>platforms</code>)","text":"<p>Many-to-many relationships that restrict which devices or VMs this mapping applies to: - <code>sites</code>: Restricts to devices/VMs at specific sites - <code>roles</code>: Restricts to devices/VMs with specific roles - <code>platforms</code>: Restricts to devices/VMs running specific platforms</p> <p>If any filter field is left empty, that filter is ignored (matches all values for that field).</p>"},{"location":"mapping_models/#properties","title":"Properties","text":"<p>The base Mapping model does not define any computed properties. However, the DeviceMapping and VMMapping subclasses inherit and extend the functionality.</p>"},{"location":"mapping_models/#methods","title":"Methods","text":""},{"location":"mapping_models/#deleteargs-kwargs","title":"<code>delete(*args, **kwargs)</code>","text":"<p>Delete this mapping instance from the database.</p> <p>Raises: - <code>ValidationError</code>: If the mapping is marked as default, it cannot be deleted.</p> <p>Parameters: - <code>*args</code>: Positional arguments passed to the model delete method - <code>**kwargs</code>: Keyword arguments passed to the model delete method</p>"},{"location":"mapping_models/#__str__","title":"<code>__str__()</code>","text":"<p>Return a human-readable string representation of the object.</p> <p>Returns: - <code>str</code>: Human-readable name of the object</p>"},{"location":"mapping_models/#get_absolute_url","title":"<code>get_absolute_url()</code>","text":"<p>Return the canonical URL for this object within the plugin UI.</p> <p>Returns: - <code>str</code>: Absolute URL as a string. Can be None if not applicable.</p>"},{"location":"mapping_models/#devicemapping","title":"DeviceMapping","text":"<p>The DeviceMapping inherits from the base Mapping model and provides device-specific functionality for matching NetBox Device objects to Zabbix configurations.</p>"},{"location":"mapping_models/#methods_1","title":"Methods","text":""},{"location":"mapping_models/#get_matching_filtercls-device-interface_typeinterfacetypechoicesany","title":"<code>get_matching_filter(cls, device, interface_type=InterfaceTypeChoices.Any)</code>","text":"<p>Class method that returns the most specific DeviceMapping that matches a given device based on site, role, and platform filters.</p> <p>Parameters: - <code>device</code> (Device): Device instance to match - <code>interface_type</code> (int): Interface type to filter by (default: Any)</p> <p>Returns: - <code>DeviceMapping</code>: Matching mapping object</p>"},{"location":"mapping_models/#get_matching_devicesself","title":"<code>get_matching_devices(self)</code>","text":"<p>Returns a queryset of Device objects that match this mapping, excluding devices already covered by more specific mappings.</p> <p>Returns: - <code>QuerySet</code>: Matching Device instances</p>"},{"location":"mapping_models/#get_absolute_urlself","title":"<code>get_absolute_url(self)</code>","text":"<p>Returns the canonical URL for this device mapping within the NetBox plugin UI.</p> <p>Returns: - <code>str</code>: Absolute URL for the device mapping</p>"},{"location":"mapping_models/#vmmapping","title":"VMMapping","text":"<p>The VMMapping inherits from the base Mapping model and provides virtual machine-specific functionality for matching NetBox VirtualMachine objects to Zabbix configurations.</p>"},{"location":"mapping_models/#methods_2","title":"Methods","text":""},{"location":"mapping_models/#get_matching_filtercls-virtual_machine-interface_typeinterfacetypechoicesany","title":"<code>get_matching_filter(cls, virtual_machine, interface_type=InterfaceTypeChoices.Any)</code>","text":"<p>Class method that returns the most specific VMMapping that matches a given virtual machine based on site, role, and platform filters.</p> <p>Parameters: - <code>virtual_machine</code> (VirtualMachine): VM instance to match - <code>interface_type</code> (int): Interface type to filter by (default: Any)</p> <p>Returns: - <code>VMMapping</code>: Matching mapping object</p>"},{"location":"mapping_models/#get_matching_virtual_machinesself","title":"<code>get_matching_virtual_machines(self)</code>","text":"<p>Returns a queryset of VirtualMachine objects that match this mapping, excluding VMs already covered by more specific mappings.</p> <p>Returns: - <code>QuerySet</code>: Matching VirtualMachine instances</p>"},{"location":"mapping_models/#get_absolute_urlself_1","title":"<code>get_absolute_url(self)</code>","text":"<p>Returns the canonical URL for this VM mapping within the NetBox plugin UI.</p> <p>Returns: - <code>str</code>: Absolute URL for the VM mapping</p>"},{"location":"mapping_models/#usage-examples","title":"Usage Examples","text":""},{"location":"mapping_models/#creating-a-basic-device-mapping","title":"Creating a Basic Device Mapping","text":"<pre><code>from netbox_zabbix.models import DeviceMapping, HostGroup, Template\n\n# Create a basic device mapping\ndevice_mapping = DeviceMapping.objects.create(\n    name=\"Linux Servers\",\n    description=\"Mapping for Linux-based servers\",\n    default=False\n)\n\n# Add host groups and templates\nlinux_host_group = HostGroup.objects.get(name=\"Linux Servers\")\ngeneric_template = Template.objects.get(name=\"Template OS Linux by Zabbix agent\")\n\ndevice_mapping.host_groups.add(linux_host_group)\ndevice_mapping.templates.add(generic_template)\n</code></pre>"},{"location":"mapping_models/#creating-a-filtered-device-mapping","title":"Creating a Filtered Device Mapping","text":"<pre><code>from dcim.models import Site, DeviceRole, Platform\n\n# Create a mapping for specific sites and roles\nfiltered_mapping = DeviceMapping.objects.create(\n    name=\"Production Web Servers\",\n    description=\"Web servers in production environment\"\n)\n\n# Add filters\nproduction_site = Site.objects.get(name=\"Production DC\")\nweb_role = DeviceRole.objects.get(name=\"Web Server\")\nlinux_platform = Platform.objects.get(name=\"Ubuntu 20.04\")\n\nfiltered_mapping.sites.add(production_site)\nfiltered_mapping.roles.add(web_role)\nfiltered_mapping.platforms.add(linux_platform)\n</code></pre>"},{"location":"mapping_models/#creating-a-default-mapping","title":"Creating a Default Mapping","text":"<pre><code># Create a default mapping that applies to all devices/VMs not matched by specific mappings\ndefault_device_mapping = DeviceMapping.objects.create(\n    name=\"Default Device Mapping\",\n    description=\"Default mapping for all unmatched devices\",\n    default=True\n)\n\ndefault_vm_mapping = VMMapping.objects.create(\n    name=\"Default VM Mapping\",\n    description=\"Default mapping for all unmatched VMs\",\n    default=True\n)\n</code></pre>"},{"location":"mapping_models/#finding-matching-mappings","title":"Finding Matching Mappings","text":"<pre><code>from dcim.models import Device\nfrom netbox_zabbix.models import DeviceMapping\n\n# Find the appropriate mapping for a device\ndevice = Device.objects.get(name=\"web-server-01\")\nmatching_mapping = DeviceMapping.get_matching_filter(device)\n\n# Get all devices that match a specific mapping\ndevices = matching_mapping.get_matching_devices()\n</code></pre>"},{"location":"mapping_models/#integration-with-other-models","title":"Integration with Other Models","text":"<p>Mapping models integrate with several other models in the plugin:</p> <ol> <li> <p>HostConfig Model: Mappings determine which Zabbix configuration is applied to Device and VirtualMachine objects when they are provisioned for monitoring.</p> </li> <li> <p>HostGroup Model: Mappings can assign HostGroup objects to devices/VMs for organizational purposes.</p> </li> <li> <p>Template Model: Mappings can assign Template objects to devices/VMs for monitoring configuration.</p> </li> <li> <p>Proxy and ProxyGroup Models: Mappings can specify which Proxy or ProxyGroup should monitor matching devices/VMs.</p> </li> <li> <p>Device and VirtualMachine Models: Mappings filter and match against these core NetBox models based on their characteristics.</p> </li> <li> <p>Site, DeviceRole, and Platform Models: Mappings use these models as filter criteria to determine which devices/VMs they apply to.</p> </li> </ol>"},{"location":"mapping_models/#description_1","title":"Description","text":"<p>The Mapping models provide a powerful and flexible system for automatically configuring Zabbix monitoring based on NetBox object characteristics. This allows administrators to define rules that automatically apply appropriate monitoring configurations to devices and virtual machines without manual intervention.</p> <p>Key features of the Mapping system include:</p> <p>Flexible Filtering: - Filter devices/VMs by site, role, and platform - Support for multiple filter criteria combinations - Empty filters match all values for that field - More specific mappings take precedence over less specific ones</p> <p>Configuration Assignment: - Assign multiple host groups to matching objects - Apply multiple templates for comprehensive monitoring - Specify monitoring via proxy or proxy group - Limit mappings to specific interface types (Agent, SNMP, or Any)</p> <p>Hierarchical Organization: - Base Mapping model provides common functionality - DeviceMapping for device-specific features - VMMapping for virtual machine-specific features - Default mappings serve as fallback for unmatched objects</p> <p>Smart Matching Logic: - Automatic selection of most specific matching mapping - Exclusion of objects covered by more specific mappings - Support for interface type restrictions - Efficient queryset-based matching</p> <p>The system is designed to scale from simple blanket mappings to complex, highly specific configurations. Default mappings ensure that all objects receive some monitoring configuration, while specific mappings allow for granular control over monitoring setups for different types of infrastructure components.</p>"},{"location":"programmer_guide/","title":"Core Concepts","text":""},{"location":"programmer_guide/#netbox-zabbix-plugin-programmers-guide","title":"NetBox Zabbix Plugin Programmer's Guide","text":""},{"location":"programmer_guide/#overview","title":"Overview","text":"<p>This guide is designed for Developers and Programmers who need to understand the internal workings of the NetBox Zabbix plugin, extend its functionality, or integrate it with other systems. It covers the code structure, models, jobs, APIs, and extension points.</p>"},{"location":"programmer_guide/#system-architecture-overview","title":"System Architecture Overview","text":"<p>The plugin follows a modular architecture with clear separation of concerns that promotes maintainability and extensibility. This design enables developers to understand, modify, and extend specific components without requiring deep knowledge of the entire system.</p>"},{"location":"programmer_guide/#core-components","title":"Core Components","text":"<p>The plugin's codebase is organized into several key directories, each serving a specific purpose:</p> <pre><code>netbox_zabbix/\n\u251c\u2500\u2500 models.py          # Data models and database schema\n\u251c\u2500\u2500 views.py           # User interface views and handlers\n\u251c\u2500\u2500 forms.py           # Form definitions and validation\n\u251c\u2500\u2500 urls.py            # URL routing configuration\n\u251c\u2500\u2500 jobs/              # Background job implementations\n\u251c\u2500\u2500 zabbix/            # Zabbix API integration and utilities\n\u251c\u2500\u2500 mapping/           # NetBox to Zabbix mapping logic\n\u251c\u2500\u2500 provisioning/      # Host creation and management workflows\n\u251c\u2500\u2500 signals/           # Django signal handlers\n\u251c\u2500\u2500 api/               # REST API endpoints\n\u2514\u2500\u2500 management/        # Django management commands\n</code></pre> <p>Models Layer: Django models in <code>models.py</code> represent Zabbix objects and configurations, providing the data structure foundation for the entire plugin.</p> <p>Jobs System: Background task processing is implemented using NetBox's job framework through files in the <code>jobs/</code> directory, handling asynchronous operations efficiently.</p> <p>Zabbix API Integration: Zabbix API interactions are wrapped in classes located in the <code>zabbix/</code> directory, abstracting complex API calls into manageable functions.</p> <p>NetBox Integration: Views, forms, and UI components connect with NetBox through <code>views.py</code> and <code>forms.py</code>, ensuring seamless user experience.</p> <p>Mapping Engine: Logic for translating NetBox objects to Zabbix configurations resides in the <code>mapping/</code> directory, automating the conversion process.</p> <p>Provisioning System: The orchestration of Zabbix host creation and updating is managed through files in the <code>provisioning/</code> directory, handling end-to-end provisioning workflows.</p>"},{"location":"programmer_guide/#data-models","title":"Data Models","text":""},{"location":"programmer_guide/#settings-model","title":"Settings Model","text":"<p>The Settings Model manages global plugin configuration and Zabbix connection parameters within <code>models.py</code>. This central configuration point controls fundamental plugin behavior and integration characteristics.</p> <p>Key fields include <code>name</code> which provides a configuration identifier, <code>api_endpoint</code> specifying the Zabbix API endpoint URL, <code>web_address</code> defining the Zabbix web interface URL, <code>_encrypted_token</code> storing the encrypted Zabbix API token securely, <code>ip_assignment_method</code> determining how IP addresses are assigned to interfaces, and various configuration flags and intervals that control plugin behavior.</p> <p>Essential methods include <code>get_client()</code> which returns an authenticated Zabbix API client through helper functions, and automatic token encryption/decryption capabilities that protect sensitive credentials while maintaining usability.</p>"},{"location":"programmer_guide/#hostconfig-model","title":"HostConfig Model","text":"<p>The HostConfig Model represents a Zabbix host configuration linked to a NetBox object in <code>models.py</code>. This model forms the core connection between infrastructure asset management and monitoring configuration.</p> <p>Critical fields encompass <code>content_type</code> linking to Device or VirtualMachine models, <code>object_id</code> storing the ID of the linked NetBox object, <code>hostid</code> containing the Zabbix host identifier, <code>status</code> tracking monitoring status as enabled or disabled, <code>in_sync</code> indicating synchronization status with Zabbix, <code>last_sync_update</code> recording when sync status was last refreshed, and relationships to templates, host groups, proxy, and proxy_group for comprehensive configuration management.</p> <p>Important properties include <code>has_agent_interface</code> returning true when an AgentInterface exists, <code>has_snmp_interface</code> returning true when an SNMPInterface exists, <code>assigned_object</code> providing access to the linked Device or VirtualMachine, and <code>in_maintenance</code> indicating when the host is under active maintenance.</p> <p>The HostConfig model can be associated with AgentInterface or SNMPInterface models that define how Zabbix communicates with the monitored host. AgentInterface represents Zabbix agent communication parameters, while SNMPInterface contains SNMP-specific configuration details.</p>"},{"location":"programmer_guide/#mapping-models","title":"Mapping Models","text":"<p>Base <code>Mapping</code> class with <code>DeviceMapping</code> and <code>VMMapping</code> subclasses in <code>models.py</code> provides flexible configuration translation between NetBox objects and Zabbix monitoring setups.</p> <p>Essential fields include <code>name</code> and <code>description</code> for identification purposes, <code>default</code> flag indicating default mapping status, relationships to templates, host groups, proxy, and proxy_group for configuration inheritance, and filtering criteria covering sites, roles, platforms, cluster_types, cluster_groups, manufacturers, and device_types for precise targeting.</p> <p>Core methods encompass <code>matches_object(obj)</code> which determines if a mapping applies to a specific NetBox object, and <code>get_configuration(obj)</code> which returns the appropriate Zabbix configuration for an object based on mapping rules.</p>"},{"location":"programmer_guide/#proxy-and-host-group-models","title":"Proxy and Host Group Models","text":"<p>Proxy and Host Group Models represent Zabbix objects imported from the Zabbix server in <code>models.py</code>, maintaining synchronized representations of remote monitoring infrastructure.</p> <p>Fundamental fields include <code>name</code> storing the object name in Zabbix, <code>zabbix_id</code> containing the identifier in Zabbix, and additional Zabbix-specific attributes that preserve remote object characteristics locally.</p> <p>Primary methods consist of <code>sync_from_zabbix()</code> which updates local data from Zabbix information through import functions, and <code>to_zabbix_format()</code> which formats data appropriately for Zabbix API calls, ensuring seamless bidirectional synchronization.</p>"},{"location":"programmer_guide/#job-system","title":"Job System","text":"<p>The plugin leverages NetBox's background job system based on Redis Queue (RQ) for asynchronous operations, preventing user interface blocking while processing time-consuming tasks.</p>"},{"location":"programmer_guide/#job-types","title":"Job Types","text":"<p>Four distinct job categories handle different operational requirements. System Jobs perform recurring maintenance tasks in <code>jobs/system.py</code>, including <code>SystemJobImportZabbixSettings</code> for importing Zabbix objects, <code>SystemJobHostConfigSyncRefresh</code> for updating synchronization status, and <code>SystemJobMaintenanceCleanup</code> for removing expired maintenance windows. Host Management Jobs execute individual host operations in <code>jobs/host.py</code>, featuring <code>CreateZabbixHost</code> for Zabbix host creation, <code>UpdateZabbixHost</code> for Zabbix host updates, and <code>DeleteZabbixHost</code> for Zabbix host removal. Provisioning Jobs orchestrate host creation workflows in <code>jobs/provision.py</code>, comprising <code>ProvisionAgent</code> for hosts with Agent interfaces and <code>ProvisionSNMP</code> for hosts with SNMP interfaces. Sync Jobs handle bulk operations in <code>jobs/synchosts.py</code>, primarily <code>SyncHosts</code> for synchronizing multiple hosts simultaneously.</p>"},{"location":"programmer_guide/#job-implementation","title":"Job Implementation","text":"<p>Jobs inherit from <code>AtomicJobRunner</code> which extends NetBox's <code>JobRunner</code> to provide transaction support and consistent error handling. This inheritance ensures that jobs execute within database transactions, automatically logging events when enabled, and properly handling exceptions with appropriate rollback mechanisms.</p>"},{"location":"programmer_guide/#job-scheduling","title":"Job Scheduling","text":"<p>System job scheduling occurs through multiple mechanisms including Django management commands for manual execution, NetBox's recurring job system for automated scheduling, and manual triggering through user interface actions or API calls for on-demand execution.</p>"},{"location":"programmer_guide/#apis-and-interfaces","title":"APIs and Interfaces","text":""},{"location":"programmer_guide/#rest-api-endpoints","title":"REST API Endpoints","text":"<p>The plugin exposes comprehensive REST API endpoints through Django REST Framework in the <code>api/</code> directory, enabling programmatic access to all plugin functionality.</p> <p>Public endpoints include:</p> <ul> <li><code>/api/plugins/netbox-zabbix/setting/</code> - Settings management</li> <li><code>/api/plugins/netbox-zabbix/templates/</code> - Template management</li> <li><code>/api/plugins/netbox-zabbix/proxy/</code> - Proxy management</li> <li><code>/api/plugins/netbox-zabbix/proxy-group/</code> - Proxy group management</li> <li><code>/api/plugins/netbox-zabbix/host-group/</code> - Host group management</li> <li><code>/api/plugins/netbox-zabbix/tag-mapping/</code> - Tag mapping management</li> <li><code>/api/plugins/netbox-zabbix/inventory-mapping/</code> - Inventory mapping management</li> <li><code>/api/plugins/netbox-zabbix/device-mapping/</code> - Device mapping management</li> <li><code>/api/plugins/netbox-zabbix/vm-mapping/</code> - VM mapping management</li> <li><code>/api/plugins/netbox-zabbix/host-config/</code> - Host configuration management</li> <li><code>/api/plugins/netbox-zabbix/agent-interface/</code> - Agent interface management</li> <li><code>/api/plugins/netbox-zabbix/snmp-interface/</code> - SNMP interface management</li> <li><code>/api/plugins/netbox-zabbix/event-log/</code> - Event log management</li> <li><code>/api/plugins/netbox-zabbix/maintenance/</code> - Maintenance management</li> </ul> <p>Internal endpoints (for UI use):</p> <ul> <li><code>/api/plugins/netbox-zabbix/host-mapping/</code> - Host mapping management</li> <li><code>/api/plugins/netbox-zabbix/unassigned-hosts/</code> - Unassigned hosts for selection</li> <li><code>/api/plugins/netbox-zabbix/unassigned-agent-interfaces/</code> - Unassigned agent interfaces</li> <li><code>/api/plugins/netbox-zabbix/unassigned-snmp-interfaces/</code> - Unassigned SNMP interfaces</li> <li><code>/api/plugins/netbox-zabbix/unassigned-host-interfaces/</code> - Unassigned host interfaces</li> <li><code>/api/plugins/netbox-zabbix/unassigned-host-ipaddresses/</code> - Unassigned host IP addresses</li> </ul>"},{"location":"programmer_guide/#zabbix-api-wrapper","title":"Zabbix API Wrapper","text":"<p>The plugin provides comprehensive wrappers around the Zabbix API in the <code>zabbix/</code> directory, abstracting complex API interactions into simple function calls.</p> <p>Low-level API client access enables direct Zabbix API interaction through the <code>ZabbixAPI</code> class, while higher-level convenience functions in modules like <code>zabbix.hosts</code> provide simplified operations for common tasks such as <code>create_zabbix_host</code> and <code>update_zabbix_host</code>.</p>"},{"location":"programmer_guide/#internal-apis","title":"Internal APIs","text":"<p>Plugin-specific APIs offer convenient access to common operations including <code>netbox_zabbix.provisioning.handler.provision_zabbix_host()</code> for full provisioning orchestration, <code>netbox_zabbix.mapping.engine.apply_mapping()</code> for applying mapping logic to objects, and <code>netbox_zabbix.importing.import_zabbix_settings()</code> for importing Zabbix objects, reducing development complexity for extension projects.</p>"},{"location":"programmer_guide/#signals","title":"Signals","text":"<p>The plugin employs Django signals to automatically synchronize changes in NetBox with Zabbix through implementations in <code>signals/signals.py</code>, ensuring real-time consistency between systems.</p>"},{"location":"programmer_guide/#signal-handlers","title":"Signal Handlers","text":"<p>The plugin implements five primary signal handler categories that maintain synchronization integrity between NetBox and Zabbix systems:</p> Signal Category Model Signal Type Action Purpose HostConfig HostConfig post_save Trigger update job Updates Zabbix when HostConfig changes HostConfig HostConfig pre_delete Record deletion Prepares cleanup before HostConfig removal HostConfig HostConfig post_delete Clean up Zabbix Removes Zabbix host based on delete settings Interface AgentInterface/SNMPInterface post_save Update Zabbix Updates interface configuration in Zabbix Interface AgentInterface/SNMPInterface post_delete Remove from Zabbix Deletes interface from Zabbix IP Address IPAddress post_save Update interface IPs Updates interface IP addresses in Zabbix IP Address IPAddress pre_delete Handle IP removal Prepares for IP address removal Device/VM Device/VirtualMachine pre_save Detect changes Identifies name/IP changes requiring Zabbix updates <p>Each signal category serves a specific purpose in maintaining synchronization between NetBox and Zabbix. HostConfig signals ensure that changes to host configurations trigger appropriate Zabbix updates or cleanup operations. Interface signals manage the lifecycle of agent and SNMP interfaces, ensuring that Zabbix interface configurations remain consistent with NetBox interface data. IP Address signals handle IP address changes that might affect monitoring connectivity. Device and VirtualMachine signals detect infrastructure changes that require corresponding updates in the monitoring system.</p>"},{"location":"programmer_guide/#signal-suppression","title":"Signal Suppression","text":"<p>Signal suppression capabilities provide flexibility for bulk operations and testing scenarios. Global disable functionality operates through the environment variable <code>DISABLE_NETBOX_ZABBIX_SIGNALS=\"1\"</code>, while per-instance suppression works by setting <code>_skip_signal = True</code> on specific model instances.</p>"},{"location":"programmer_guide/#custom-signal-handling","title":"Custom Signal Handling","text":"<p>Developers can extend signal handling by connecting custom functions to existing signals in their application's <code>apps.py</code> ready() method, enabling additional business logic integration without modifying core plugin code.</p>"},{"location":"programmer_guide/#management-commands","title":"Management Commands","text":"<p>Custom management commands in the <code>management/commands/</code> directory provide administrative extensions that can be executed through standard Django management command interfaces.</p> <p>For user operations, see the User Guide. For administrative configuration, see the Admin Guide.</p>"},{"location":"proxy_model/","title":"Proxy Model","text":""},{"location":"proxy_model/#netbox-zabbix-plugin---proxy-documentation","title":"NetBox Zabbix Plugin - Proxy Documentation","text":""},{"location":"proxy_model/#overview","title":"Overview","text":"<p>The Proxy in the NetBox Zabbix plugin represents Zabbix proxies, which are intermediary components that can collect monitoring data from agents and send it to the Zabbix server. This document explains the Proxy's structure, fields, properties, methods, and usage.</p>"},{"location":"proxy_model/#model-definition","title":"Model Definition","text":"<p>The Proxy synchronizes with Zabbix proxies and maintains comprehensive configuration parameters including networking, encryption, and timeout settings. Proxies can operate in active or passive modes and can be organized into proxy groups for high availability.</p>"},{"location":"proxy_model/#fields","title":"Fields","text":"Field Type Description Default/Notes <code>name</code> CharField (max_length=255) Name of the proxy Human-readable identifier <code>proxyid</code> CharField (max_length=255) Unique identifier in Zabbix Blank/null allowed <code>proxy_groupid</code> CharField (max_length=255) Proxy group identifier Blank/null allowed <code>proxy_group</code> ForeignKey (ProxyGroup) Associated proxy group Null/blank allowed, related_name='proxies' <code>last_synced</code> DateTimeField Last synchronization timestamp Blank/null allowed <code>description</code> TextField Description of the proxy Blank/null allowed <code>operating_mode</code> PositiveSmallIntegerField Proxy operating mode Default: ACTIVE (0). Options: ACTIVE (0), PASSIVE (1) <code>local_address</code> GenericIPAddressField Address for active agents Default: \"\", blank/null allowed <code>local_port</code> PositiveIntegerField Proxy port for active mode Default: 10051, blank/null allowed <code>allowed_addresses</code> CharField Allowed addresses for active proxy Blank/null allowed <code>address</code> GenericIPAddressField Interface address Default: \"127.0.0.1\", blank/null allowed <code>port</code> PositiveIntegerField Port for passive mode Default: 10051, blank/null allowed <code>tls_connect</code> PositiveSmallIntegerField TLS mode for outgoing connections Default: NoEncryption (1). Options: NoEncryption (1), PSK (2), Certificate (4) <code>tls_accept</code> PositiveSmallIntegerField TLS mode for incoming connections Default: NoEncryption (1). Options: NoEncryption (1), PSK (2), Certificate (4) <code>tls_issuer</code> CharField (max_length=255) Certificate issuer DN Blank/null allowed <code>tls_subject</code> CharField (max_length=255) Certificate subject DN Blank/null allowed <code>tls_psk_identity</code> CharField (max_length=255) PSK identity Blank/null allowed <code>tls_psk</code> CharField (max_length=255) Pre-shared key Blank/null allowed <code>custom_timeouts</code> BooleanField Enable custom timeout settings Default: False <code>timeout_zabbix_agent</code> CharField (max_length=255) Zabbix agent check timeout Default: \"4s\", blank/null allowed <code>timeout_simple_check</code> CharField (max_length=255) Simple check timeout Default: \"4s\", blank/null allowed <code>timeout_snmp_agent</code> CharField (max_length=255) SNMP agent check timeout Default: \"4s\", blank/null allowed <code>timeout_external_check</code> CharField (max_length=255) External check timeout Default: \"4s\", blank/null allowed <code>timeout_db_monitor</code> CharField (max_length=255) Database monitor timeout Default: \"4s\", blank/null allowed <code>timeout_http_agent</code> CharField (max_length=255) HTTP agent check timeout Default: \"4s\", blank/null allowed <code>timeout_ssh_agent</code> CharField (max_length=255) SSH agent check timeout Default: \"4s\", blank/null allowed <code>timeout_telnet_agent</code> CharField (max_length=255) Telnet agent check timeout Default: \"4s\", blank/null allowed <code>timeout_script</code> CharField (max_length=255) Custom script timeout Default: \"4s\", blank/null allowed <code>timeout_browser</code> CharField (max_length=255) Browser-based check timeout Default: \"60s\", blank/null allowed"},{"location":"proxy_model/#name","title":"<code>name</code>","text":"<p>The human-readable name of the proxy as it appears in both NetBox and Zabbix. This field serves as the primary identifier for the proxy.</p>"},{"location":"proxy_model/#proxyid","title":"<code>proxyid</code>","text":"<p>The unique identifier assigned by Zabbix for this proxy. This field is populated automatically when the proxy is created or synchronized with Zabbix.</p>"},{"location":"proxy_model/#proxy_groupid","title":"<code>proxy_groupid</code>","text":"<p>Identifier for the proxy group that this proxy belongs to in Zabbix. This field is populated automatically when the proxy is synchronized with Zabbix.</p>"},{"location":"proxy_model/#proxy_group","title":"<code>proxy_group</code>","text":"<p>Foreign key relationship to the ProxyGroup object that this proxy belongs to. This allows for high availability configurations through proxy groups.</p>"},{"location":"proxy_model/#last_synced","title":"<code>last_synced</code>","text":"<p>Timestamp indicating when the proxy was last synchronized with Zabbix. This helps track the freshness of the data in NetBox compared to Zabbix.</p>"},{"location":"proxy_model/#description","title":"<code>description</code>","text":"<p>An optional textual description of the proxy's purpose or configuration.</p>"},{"location":"proxy_model/#operating_mode","title":"<code>operating_mode</code>","text":"<p>Determines how the proxy operates: - <code>ACTIVE</code> (0): The proxy actively connects to agents to collect data - <code>PASSIVE</code> (1): The proxy waits for the Zabbix server to connect and request data</p>"},{"location":"proxy_model/#network-configuration-fields","title":"Network Configuration Fields","text":""},{"location":"proxy_model/#active-mode-fields","title":"Active Mode Fields","text":"<ul> <li><code>local_address</code>: IP address or DNS name where agents connect to the proxy in active mode</li> <li><code>local_port</code>: Port number where agents connect to the proxy in active mode</li> <li><code>allowed_addresses</code>: Comma-delimited list of IP addresses or DNS names allowed to connect to the active proxy</li> </ul>"},{"location":"proxy_model/#passive-mode-fields","title":"Passive Mode Fields","text":"<ul> <li><code>address</code>: IP address or DNS name where the Zabbix server connects to the proxy in passive mode</li> <li><code>port</code>: Port number where the Zabbix server connects to the proxy in passive mode</li> </ul>"},{"location":"proxy_model/#encryption-fields","title":"Encryption Fields","text":"<ul> <li><code>tls_connect</code>: TLS mode for outgoing connections to agents and Zabbix server</li> <li><code>tls_accept</code>: TLS mode for incoming connections from agents and Zabbix server</li> <li><code>tls_issuer</code>: Certificate issuer distinguished name for certificate-based TLS</li> <li><code>tls_subject</code>: Certificate subject distinguished name for certificate-based TLS</li> <li><code>tls_psk_identity</code>: Pre-shared key identity for PSK-based TLS</li> <li><code>tls_psk</code>: Pre-shared key string for PSK-based TLS</li> </ul>"},{"location":"proxy_model/#timeout-fields","title":"Timeout Fields","text":"<ul> <li><code>custom_timeouts</code>: Flag to enable custom timeout settings</li> <li><code>timeout_zabbix_agent</code>: Timeout for Zabbix agent checks (1-600 seconds)</li> <li><code>timeout_simple_check</code>: Timeout for simple checks (1-600 seconds)</li> <li><code>timeout_snmp_agent</code>: Timeout for SNMP agent checks (1-600 seconds)</li> <li><code>timeout_external_check</code>: Timeout for external checks (1-600 seconds)</li> <li><code>timeout_db_monitor</code>: Timeout for database monitoring checks (1-600 seconds)</li> <li><code>timeout_http_agent</code>: Timeout for HTTP agent checks (1-600 seconds)</li> <li><code>timeout_ssh_agent</code>: Timeout for SSH agent checks (1-600 seconds)</li> <li><code>timeout_telnet_agent</code>: Timeout for Telnet agent checks (1-600 seconds)</li> <li><code>timeout_script</code>: Timeout for custom scripts (1-600 seconds)</li> <li><code>timeout_browser</code>: Timeout for browser-based checks (1-600 seconds)</li> </ul>"},{"location":"proxy_model/#methods","title":"Methods","text":""},{"location":"proxy_model/#__str__","title":"<code>__str__()</code>","text":"<p>Returns the proxy name as a human-readable string representation.</p> <p>Returns: - <code>str</code>: Proxy name</p>"},{"location":"proxy_model/#get_absolute_url","title":"<code>get_absolute_url()</code>","text":"<p>Returns the canonical URL for this proxy within the NetBox plugin UI.</p> <p>Returns: - <code>str</code>: Absolute URL for the proxy</p>"},{"location":"proxy_model/#_build_params","title":"<code>_build_params()</code>","text":"<p>Constructs the parameters dictionary for Zabbix API create/update proxy calls. This method handles the conditional inclusion of parameters based on operating mode, encryption settings, and timeout configurations.</p> <p>Returns: - <code>dict</code>: Parameters dictionary for Zabbix API calls</p>"},{"location":"proxy_model/#create_new_proxy","title":"<code>create_new_proxy()</code>","text":"<p>Creates a new proxy in Zabbix with the current configuration parameters.</p>"},{"location":"proxy_model/#update_existing_proxy","title":"<code>update_existing_proxy()</code>","text":"<p>Updates an existing proxy in Zabbix with the current configuration parameters.</p>"},{"location":"proxy_model/#deleteargs-kwargs","title":"<code>delete(*args, **kwargs)</code>","text":"<p>Attempts to delete the proxy from Zabbix. If successful, also removes it from NetBox. If Zabbix deletion fails, returns a warning but still removes from NetBox.</p>"},{"location":"proxy_model/#saveargs-kwargs","title":"<code>save(*args, **kwargs)</code>","text":"<p>Overrides the default save method to synchronize the <code>proxy_groupid</code> with the associated <code>proxy_group</code> foreign key relationship.</p>"},{"location":"proxy_model/#usage-examples","title":"Usage Examples","text":""},{"location":"proxy_model/#creating-an-active-proxy","title":"Creating an Active Proxy","text":"<pre><code>from netbox_zabbix.models import Proxy, ProxyModeChoices\n\n# Create an active proxy\nactive_proxy = Proxy.objects.create(\n    name=\"Active Proxy 1\",\n    operating_mode=ProxyModeChoices.ACTIVE,\n    local_address=\"192.168.1.100\",\n    local_port=10051,\n    allowed_addresses=\"192.168.1.0/24\"\n)\n</code></pre>"},{"location":"proxy_model/#creating-a-passive-proxy","title":"Creating a Passive Proxy","text":"<pre><code>from netbox_zabbix.models import Proxy, ProxyModeChoices\n\n# Create a passive proxy\npassive_proxy = Proxy.objects.create(\n    name=\"Passive Proxy 1\",\n    operating_mode=ProxyModeChoices.PASSIVE,\n    address=\"192.168.1.101\",\n    port=10051\n)\n</code></pre>"},{"location":"proxy_model/#configuring-encryption","title":"Configuring Encryption","text":"<pre><code>from netbox_zabbix.models import Proxy, TLSConnectChoices, TLSAcceptChoices\n\n# Configure PSK encryption\nproxy = Proxy.objects.get(name=\"My Proxy\")\nproxy.tls_connect = TLSConnectChoices.PSK\nproxy.tls_accept = TLSAcceptChoices.PSK\nproxy.tls_psk_identity = \"my_proxy_identity\"\nproxy.tls_psk = \"a1b2c3d4e5f67890\"  # Should be at least 32 hex digits\nproxy.save()\n</code></pre>"},{"location":"proxy_model/#setting-custom-timeouts","title":"Setting Custom Timeouts","text":"<pre><code># Enable custom timeouts and configure specific values\nproxy = Proxy.objects.get(name=\"My Proxy\")\nproxy.custom_timeouts = True\nproxy.timeout_zabbix_agent = \"10s\"\nproxy.timeout_http_agent = \"30s\"\nproxy.timeout_browser = \"120s\"\nproxy.save()\n</code></pre>"},{"location":"proxy_model/#assigning-to-a-proxy-group","title":"Assigning to a Proxy Group","text":"<pre><code>from netbox_zabbix.models import Proxy, ProxyGroup\n\n# Assign proxy to a proxy group\nproxy_group = ProxyGroup.objects.get(name=\"Web Servers Proxy Group\")\nproxy = Proxy.objects.get(name=\"My Proxy\")\nproxy.proxy_group = proxy_group\nproxy.save()\n</code></pre>"},{"location":"proxy_model/#integration-with-other-models","title":"Integration with Other Models","text":"<p>Proxy integrates with several other models in the plugin:</p> <ol> <li>ProxyGroup Model: Proxies can be assigned to proxy groups for high availability.</li> <li>HostConfig Model: Host configurations can be assigned to specific proxies for monitoring.</li> <li>Mapping Models: DeviceMapping and VMMapping can specify proxies for matching hosts.</li> </ol>"},{"location":"proxy_model/#description_1","title":"Description","text":"<p>The Proxy model provides comprehensive configuration and synchronization capabilities for Zabbix proxies. It supports both active and passive proxy modes, extensive encryption options, and detailed timeout configurations.</p> <p>Key features include: - Support for both active and passive proxy operating modes - Comprehensive TLS encryption configuration options - Detailed timeout settings for various check types - Integration with ProxyGroup for high availability configurations - Automatic synchronization with Zabbix proxy configurations - Robust error handling for Zabbix API operations - Flexible network configuration for different deployment scenarios</p>"},{"location":"proxygroup_model/","title":"ProxyGroup Model","text":""},{"location":"proxygroup_model/#netbox-zabbix-plugin---proxygroup-documentation","title":"NetBox Zabbix Plugin - ProxyGroup Documentation","text":""},{"location":"proxygroup_model/#overview","title":"Overview","text":"<p>The ProxyGroup in the NetBox Zabbix plugin represents Zabbix proxy groups, which are collections of proxies that can provide high availability and load distribution for monitoring. This document explains the ProxyGroup's structure, fields, properties, methods, and usage.</p>"},{"location":"proxygroup_model/#model-definition","title":"Model Definition","text":"<p>The ProxyGroup synchronizes with Zabbix proxy groups and maintains configuration parameters that define how proxy groups operate in the Zabbix monitoring system. Proxy groups allow for failover and load balancing among multiple proxies.</p>"},{"location":"proxygroup_model/#fields","title":"Fields","text":"Field Type Description Default/Notes <code>name</code> CharField (max_length=255) Name of the proxy group Human-readable identifier <code>proxy_groupid</code> CharField (max_length=255) Unique identifier in Zabbix Blank/null allowed <code>failover_delay</code> CharField (max_length=255) Failover period Default: \"1m\" <code>min_online</code> PositiveSmallIntegerField Minimum online proxies Default: 1 <code>description</code> TextField Description of the proxy group Blank/null allowed <code>last_synced</code> DateTimeField Last synchronization timestamp Blank/null allowed"},{"location":"proxygroup_model/#name","title":"<code>name</code>","text":"<p>The human-readable name of the proxy group as it appears in both NetBox and Zabbix.</p>"},{"location":"proxygroup_model/#proxy_groupid","title":"<code>proxy_groupid</code>","text":"<p>The unique identifier assigned by Zabbix for this proxy group. This field is populated automatically during synchronization.</p>"},{"location":"proxygroup_model/#failover_delay","title":"<code>failover_delay</code>","text":"<p>The period during which a proxy in the proxy group must communicate with the Zabbix server to be considered online. Format follows Zabbix time unit specifications (e.g., \"1m\", \"30s\", \"2h\").</p>"},{"location":"proxygroup_model/#min_online","title":"<code>min_online</code>","text":"<p>The minimum number of proxies that must be online for the proxy group to be considered operational.</p>"},{"location":"proxygroup_model/#description","title":"<code>description</code>","text":"<p>An optional textual description of the proxy group's purpose or configuration.</p>"},{"location":"proxygroup_model/#last_synced","title":"<code>last_synced</code>","text":"<p>Timestamp indicating when the proxy group was last synchronized with Zabbix.</p>"},{"location":"proxygroup_model/#methods","title":"Methods","text":""},{"location":"proxygroup_model/#__str__","title":"<code>__str__()</code>","text":"<p>Returns the proxy group name as a human-readable string representation.</p> <p>Returns: - <code>str</code>: Proxy group name</p>"},{"location":"proxygroup_model/#get_absolute_url","title":"<code>get_absolute_url()</code>","text":"<p>Returns the canonical URL for this proxy group within the NetBox plugin UI.</p> <p>Returns: - <code>str</code>: Absolute URL for the proxy group</p>"},{"location":"proxygroup_model/#create_new_proxy_group","title":"<code>create_new_proxy_group()</code>","text":"<p>Creates a new proxy group in Zabbix with the current configuration parameters.</p>"},{"location":"proxygroup_model/#update_existing_proxy_group","title":"<code>update_existing_proxy_group()</code>","text":"<p>Updates an existing proxy group in Zabbix with the current configuration parameters.</p>"},{"location":"proxygroup_model/#deleteargs-kwargs","title":"<code>delete(*args, **kwargs)</code>","text":"<p>Attempts to delete the proxy group from Zabbix. If successful, also removes it from NetBox. If Zabbix deletion fails, returns a warning but still removes from NetBox.</p>"},{"location":"proxygroup_model/#usage-examples","title":"Usage Examples","text":""},{"location":"proxygroup_model/#creating-a-proxygroup","title":"Creating a ProxyGroup","text":"<pre><code>from netbox_zabbix.models import ProxyGroup\n\n# Create a new proxy group\nproxy_group = ProxyGroup.objects.create(\n    name=\"Web Servers Proxy Group\",\n    failover_delay=\"30s\",\n    min_online=2,\n    description=\"Proxy group for monitoring web servers\"\n)\n</code></pre>"},{"location":"proxygroup_model/#configuring-failover-settings","title":"Configuring Failover Settings","text":"<pre><code># Configure a proxy group with strict failover requirements\nhigh_availability_group = ProxyGroup.objects.create(\n    name=\"Critical Infrastructure\",\n    failover_delay=\"1m\",\n    min_online=3,\n    description=\"High availability proxy group for critical systems\"\n)\n</code></pre>"},{"location":"proxygroup_model/#synchronizing-with-zabbix","title":"Synchronizing with Zabbix","text":"<pre><code># Create the proxy group in Zabbix\nproxy_group.create_new_proxy_group()\n\n# Update an existing proxy group in Zabbix\nproxy_group.failover_delay = \"45s\"\nproxy_group.update_existing_proxy_group()\n</code></pre>"},{"location":"proxygroup_model/#integration-with-other-models","title":"Integration with Other Models","text":"<p>ProxyGroup integrates with several other models in the plugin:</p> <ol> <li>Proxy Model: Proxies can be assigned to proxy groups through the <code>proxy_group</code> foreign key relationship.</li> <li>HostConfig Model: Host configurations can be assigned to proxy groups for monitoring.</li> <li>Mapping Models: DeviceMapping and VMMapping can specify proxy groups for matching hosts.</li> </ol>"},{"location":"proxygroup_model/#description_1","title":"Description","text":"<p>The ProxyGroup model provides high availability and load distribution capabilities for Zabbix monitoring by managing groups of proxies. It enables failover mechanisms and ensures continuous monitoring even when individual proxies become unavailable.</p> <p>Key features include: - Automatic synchronization with Zabbix proxy groups - Configurable failover delay settings - Minimum online proxy requirements - Integration with Proxy, HostConfig, and Mapping models - Robust error handling for Zabbix API operations</p>"},{"location":"script_provisioning/","title":"Scripting","text":""},{"location":"script_provisioning/#scripting-guide-for-netbox-zabbix-plugin","title":"Scripting Guide for NetBox Zabbix Plugin","text":""},{"location":"script_provisioning/#overview","title":"Overview","text":"<p>This guide explains how to provision Zabbix agents and SNMP hosts programmatically from NetBox scripts using the NetBox Zabbix plugin. This approach is valuable for automating large-scale deployments or integrating with external provisioning systems that require programmatic control over monitoring setup.</p> <p>The plugin's script provisioning capabilities enable developers and automation engineers to programmatically create, configure, and manage Zabbix monitoring for NetBox infrastructure assets. This functionality bridges the gap between infrastructure-as-code practices and monitoring-as-code approaches, allowing organizations to maintain consistent, reproducible monitoring configurations that align with their infrastructure provisioning workflows.</p>"},{"location":"script_provisioning/#prerequisites","title":"Prerequisites","text":"<p>Before implementing provisioning scripts, several foundational elements must be properly configured to ensure successful execution. The NetBox Zabbix plugin must be correctly installed and operational within the NetBox environment, with all necessary dependencies satisfied and database migrations completed. Plugin connectivity to the Zabbix server requires validation through the Settings interface, confirming that API endpoints are accessible and authentication credentials are valid.</p> <p>Script execution necessitates appropriate permissions for both NetBox data access and Zabbix host creation operations. Users running provisioning scripts must possess sufficient privileges to read target NetBox objects and create corresponding Zabbix configurations. The existence of appropriate DeviceMapping and VMMapping configurations is essential for automatic configuration assignment during provisioning. These mappings determine which templates, host groups, and proxies are applied to newly created hosts, ensuring consistent monitoring policies across infrastructure components.</p> <p>API access requirements include proper authentication tokens and network connectivity between the NetBox server and Zabbix API endpoints. Scripts must be able to reach the Zabbix server over the network, with any required firewall rules or security groups configured to permit API communication.</p>"},{"location":"script_provisioning/#basic-script-structure","title":"Basic Script Structure","text":"<p>NetBox provisioning scripts inherit from the <code>Script</code> base class, following standard NetBox scripting conventions while incorporating plugin-specific functionality. This inheritance provides access to built-in logging capabilities, parameter handling, and execution control mechanisms that integrate seamlessly with the NetBox scripting framework.</p> <p>The fundamental script structure includes metadata definition through the Meta class, which specifies the script name, description, and default commit behavior. The run method serves as the primary execution entry point, receiving data parameters and commit flags that control script behavior. This method orchestrates the provisioning workflow, iterating through target objects and applying appropriate configuration based on organizational requirements.</p> <p>Error handling within scripts should leverage the built-in logging mechanisms to provide informative feedback about provisioning operations. Successful operations, skipped objects, and failed attempts should all be appropriately logged to facilitate troubleshooting and audit tracking. The commit flag enables dry-run functionality, allowing administrators to preview provisioning operations before executing actual changes.</p>"},{"location":"script_provisioning/#provisioning-agents","title":"Provisioning Agents","text":""},{"location":"script_provisioning/#simple-agent-provisioning","title":"Simple Agent Provisioning","text":"<p>Agent provisioning scripts begin by identifying target devices that require Zabbix agent monitoring, typically filtering by platform, role, or other relevant characteristics. The provisioning process involves creating HostConfig objects that establish the connection between NetBox infrastructure assets and Zabbix monitoring configurations.</p> <p>Before creating new host configurations, scripts should verify that existing configurations do not already exist for target objects to prevent duplication. This validation step ensures idempotent behavior, allowing scripts to be safely re-run without creating unwanted duplicates. When committing changes, scripts create HostConfig objects with appropriate associations to NetBox devices or virtual machines, then trigger provisioning jobs that handle the actual Zabbix host creation process.</p> <p>The ProvisionAgent job class orchestrates the end-to-end agent provisioning workflow, automatically applying appropriate templates, host groups, and proxy assignments based on configured mappings. This automation eliminates manual configuration steps while ensuring consistent application of organizational monitoring policies.</p>"},{"location":"script_provisioning/#example-provisioning-a-single-agent-host","title":"Example: Provisioning a Single Agent Host","text":"<pre><code>from django.utils.text import slugify\nfrom dcim.models import Device\nfrom netbox_zabbix.jobs.provision import ProvisionAgent\nfrom extras.scripts import Script, ObjectVar\n\nclass ProvisionSingleAgentHost(Script):\n    class Meta:\n        name = \"Provision Single Agent Host\"\n        description = \"Provision a single device with Zabbix agent monitoring\"\n        commit_default = True\n\n    device = ObjectVar(\n        description=\"Device to provision with Zabbix agent\",\n        queryset=Device.objects.all()\n    )\n\n    def run(self, data, commit):\n        device = data['device']\n\n        # Check if already provisioned\n        from netbox_zabbix.models import HostConfig\n        from django.contrib.contenttypes.models import ContentType\n\n        existing_config = HostConfig.objects.filter(\n            content_type=ContentType.objects.get_for_model(device),\n            object_id=device.id\n        ).first()\n\n        if existing_config:\n            self.log_info(f\"Device {device.name} is already provisioned with HostConfig {existing_config.name}\")\n            return\n\n        # Provision the agent\n        if commit:\n            job = ProvisionAgent.run_job(\n                instance=device,\n                request=self.request\n            )\n            self.log_success(f\"Started provisioning job for {device.name} (Job ID: {job.id})\")\n        else:\n            self.log_info(f\"Would provision agent for {device.name} (dry run)\")\n</code></pre>"},{"location":"script_provisioning/#example-bulk-agent-provisioning","title":"Example: Bulk Agent Provisioning","text":"<pre><code>from django.utils.text import slugify\nfrom dcim.models import Device\nfrom netbox_zabbix.jobs.provision import ProvisionAgent\nfrom extras.scripts import Script, MultiObjectVar\n\nclass BulkProvisionAgentHosts(Script):\n    class Meta:\n        name = \"Bulk Provision Agent Hosts\"\n        description = \"Provision multiple devices with Zabbix agent monitoring\"\n        commit_default = True\n\n    devices = MultiObjectVar(\n        description=\"Devices to provision with Zabbix agents\",\n        queryset=Device.objects.all()\n    )\n\n    def run(self, data, commit):\n        devices = data['devices']\n        provisioned_count = 0\n        skipped_count = 0\n\n        for device in devices:\n            # Check if already provisioned\n            from netbox_zabbix.models import HostConfig\n            from django.contrib.contenttypes.models import ContentType\n\n            existing_config = HostConfig.objects.filter(\n                content_type=ContentType.objects.get_for_model(device),\n                object_id=device.id\n            ).first()\n\n            if existing_config:\n                self.log_info(f\"Skipping {device.name} - already provisioned\")\n                skipped_count += 1\n                continue\n\n            # Provision the agent\n            if commit:\n                try:\n                    job = ProvisionAgent.run_job(\n                        instance=device,\n                        request=self.request\n                    )\n                    self.log_success(f\"Started provisioning job for {device.name} (Job ID: {job.id})\")\n                    provisioned_count += 1\n                except Exception as e:\n                    self.log_failure(f\"Failed to provision {device.name}: {e}\")\n            else:\n                self.log_info(f\"Would provision agent for {device.name} (dry run)\")\n                provisioned_count += 1\n\n        self.log_info(f\"Bulk provisioning complete: {provisioned_count} provisioned, {skipped_count} skipped\")\n</code></pre>"},{"location":"script_provisioning/#advanced-agent-configuration","title":"Advanced Agent Configuration","text":"<p>Advanced agent provisioning extends basic functionality by allowing explicit configuration of templates, host groups, and other monitoring parameters before triggering provisioning jobs. This approach provides fine-grained control over monitoring configurations for specific use cases that require deviations from standard mapping rules.</p> <p>Scripts implementing advanced provisioning typically retrieve specific Zabbix objects such as templates and host groups by name or other identifiers, then associate these objects with newly created HostConfig instances. This explicit assignment overrides automatic mapping behavior, enabling specialized monitoring configurations for particular infrastructure components or environments.</p> <p>Error handling in advanced provisioning scripts should account for missing Zabbix objects, ensuring that required templates and host groups exist before attempting provisioning operations. Comprehensive logging captures both successful operations and failures, providing administrators with detailed information about provisioning outcomes and facilitating troubleshooting when issues arise.</p>"},{"location":"script_provisioning/#provisioning-snmp-hosts","title":"Provisioning SNMP Hosts","text":""},{"location":"script_provisioning/#basic-snmp-provisioning","title":"Basic SNMP Provisioning","text":"<p>SNMP provisioning follows similar patterns to agent provisioning but targets network infrastructure components that are typically monitored through SNMP protocols rather than Zabbix agents. These devices include network switches, routers, firewalls, and other infrastructure elements that support SNMP-based monitoring.</p> <p>The provisioning workflow begins with identification of SNMP-capable devices through appropriate filtering criteria, such as device role, manufacturer, or platform characteristics. Scripts validate that target objects possess the necessary attributes for SNMP monitoring, including primary IP addresses and appropriate interface configurations.</p> <p>HostConfig creation for SNMP devices follows the same patterns as agent provisioning, with the key difference being the use of ProvisionSNMP job classes instead of ProvisionAgent classes. This distinction ensures that appropriate interface types and configuration parameters are applied during the provisioning process, creating SNMP-specific monitoring configurations in Zabbix.</p>"},{"location":"script_provisioning/#example-provisioning-a-single-snmp-host","title":"Example: Provisioning a Single SNMP Host","text":"<pre><code>from django.utils.text import slugify\nfrom dcim.models import Device\nfrom netbox_zabbix.jobs.provision import ProvisionSNMP\nfrom extras.scripts import Script, ObjectVar\n\nclass ProvisionSingleSNMPHost(Script):\n    class Meta:\n        name = \"Provision Single SNMP Host\"\n        description = \"Provision a single device with SNMP monitoring\"\n        commit_default = True\n\n    device = ObjectVar(\n        description=\"Network device to provision with SNMP monitoring\",\n        queryset=Device.objects.all()\n    )\n\n    def run(self, data, commit):\n        device = data['device']\n\n        # Check if already provisioned\n        from netbox_zabbix.models import HostConfig\n        from django.contrib.contenttypes.models import ContentType\n\n        existing_config = HostConfig.objects.filter(\n            content_type=ContentType.objects.get_for_model(device),\n            object_id=device.id\n        ).first()\n\n        if existing_config:\n            self.log_info(f\"Device {device.name} is already provisioned with HostConfig {existing_config.name}\")\n            return\n\n        # Provision with SNMP\n        if commit:\n            job = ProvisionSNMP.run_job(\n                instance=device,\n                request=self.request\n            )\n            self.log_success(f\"Started SNMP provisioning job for {device.name} (Job ID: {job.id})\")\n        else:\n            self.log_info(f\"Would provision SNMP for {device.name} (dry run)\")\n</code></pre>"},{"location":"script_provisioning/#example-bulk-snmp-provisioning-with-custom-parameters","title":"Example: Bulk SNMP Provisioning with Custom Parameters","text":"<pre><code>from django.utils.text import slugify\nfrom dcim.models import Device\nfrom netbox_zabbix.jobs.provision import ProvisionSNMP\nfrom extras.scripts import Script, MultiObjectVar\n\nclass BulkProvisionSNMPHosts(Script):\n    class Meta:\n        name = \"Bulk Provision SNMP Hosts\"\n        description = \"Provision multiple network devices with SNMP monitoring\"\n        commit_default = True\n\n    devices = MultiObjectVar(\n        description=\"Network devices to provision with SNMP monitoring\",\n        queryset=Device.objects.all()\n    )\n\n    def run(self, data, commit):\n        devices = data['devices']\n        provisioned_count = 0\n        skipped_count = 0\n\n        for device in devices:\n            # Check if already provisioned\n            from netbox_zabbix.models import HostConfig\n            from django.contrib.contenttypes.models import ContentType\n\n            existing_config = HostConfig.objects.filter(\n                content_type=ContentType.objects.get_for_model(device),\n                object_id=device.id\n            ).first()\n\n            if existing_config:\n                self.log_info(f\"Skipping {device.name} - already provisioned\")\n                skipped_count += 1\n                continue\n\n            # Provision with SNMP\n            if commit:\n                try:\n                    job = ProvisionSNMP.run_job(\n                        instance=device,\n                        request=self.request\n                    )\n                    self.log_success(f\"Started SNMP provisioning job for {device.name} (Job ID: {job.id})\")\n                    provisioned_count += 1\n                except Exception as e:\n                    self.log_failure(f\"Failed to provision SNMP for {device.name}: {e}\")\n            else:\n                self.log_info(f\"Would provision SNMP for {device.name} (dry run)\")\n                provisioned_count += 1\n\n        self.log_info(f\"Bulk SNMP provisioning complete: {provisioned_count} provisioned, {skipped_count} skipped\")\n</code></pre>"},{"location":"script_provisioning/#bulk-operations","title":"Bulk Operations","text":""},{"location":"script_provisioning/#bulk-provisioning-script","title":"Bulk Provisioning Script","text":"<p>Bulk provisioning scripts enable simultaneous provisioning of multiple devices and virtual machines, streamlining large-scale monitoring deployments. These scripts implement efficient iteration patterns that process hundreds or thousands of objects while maintaining performance and reliability.</p> <p>The bulk provisioning approach includes safeguards such as processing limits and error handling mechanisms that prevent cascading failures when individual provisioning operations encounter issues. Statistics tracking provides visibility into provisioning outcomes, enabling administrators to understand the scope and success rate of bulk operations.</p> <p>Resource management considerations include memory usage, database connection handling, and API rate limiting that may impact large-scale provisioning operations. Scripts should implement appropriate batching and throttling mechanisms to ensure reliable execution even when provisioning thousands of objects.</p>"},{"location":"script_provisioning/#error-handling","title":"Error Handling","text":""},{"location":"script_provisioning/#robust-error-handling","title":"Robust Error Handling","text":"<p>Production-ready provisioning scripts implement comprehensive error handling that accounts for various failure scenarios including network connectivity issues, authentication failures, missing dependencies, and Zabbix API errors. This robust error handling ensures that script failures are graceful and informative, providing administrators with actionable information for troubleshooting.</p> <p>Logging mechanisms capture detailed information about provisioning operations, including timestamps, object identifiers, and error details that facilitate debugging and audit tracking. Scripts should differentiate between recoverable errors that might be resolved through retries and fatal errors that require manual intervention.</p> <p>Cleanup procedures handle partially completed operations, ensuring that failed provisioning attempts do not leave orphaned objects or inconsistent configurations. This cleanup functionality maintains system integrity even when provisioning operations encounter unexpected issues.</p>"},{"location":"script_provisioning/#monitoring-provisioning-jobs","title":"Monitoring Provisioning Jobs","text":"<p>Job monitoring capabilities enable administrators to track the status and outcomes of provisioning operations, providing visibility into background processing that occurs after script execution completes. This monitoring includes checking job completion status, examining error details for failed operations, and correlating job outcomes with script execution logs.</p> <p>Real-time job monitoring allows administrators to observe provisioning progress as operations execute, while historical job tracking provides audit trails for compliance and troubleshooting purposes. Integration with NetBox's built-in job management system ensures consistent monitoring experiences across all plugin operations.</p> <p>For general usage information, see the User Guide. For administrative configuration, see the Admin Guide.</p>"},{"location":"settings_model/","title":"Settings Model","text":""},{"location":"settings_model/#setting-model","title":"Setting Model","text":""},{"location":"settings_model/#overview","title":"Overview","text":"<p>The <code>Setting</code> model provides a centralized configuration system for managing the integration between NetBox and Zabbix monitoring systems. This comprehensive configuration framework controls how the plugin interacts with Zabbix servers, manages host configurations, and handles synchronization processes while maintaining security and operational flexibility.</p>"},{"location":"settings_model/#model-definition","title":"Model Definition","text":"<p>The Setting model stores global configuration parameters that govern plugin behavior across all operations. This centralized approach ensures consistent configuration management while providing the flexibility needed for diverse operational environments. The model implements robust validation mechanisms to prevent misconfiguration and maintains encrypted storage for sensitive credentials such as API tokens.</p> <p>Configuration parameters are organized into logical groups that correspond to different aspects of plugin functionality, making it easier for administrators to understand and manage complex integration requirements. The model supports both required and optional configuration elements, allowing organizations to implement monitoring solutions that match their specific operational needs.</p>"},{"location":"settings_model/#fields","title":"Fields","text":"Field Type Description Notes <code>name</code> CharField (max_length=255) Name of the setting Human-readable identifier <code>ip_assignment_method</code> CharField (max_length=16) Method used to assign IPs to host interfaces Choices: 'manual', 'primary'. Default: 'primary' <code>event_log_enabled</code> BooleanField Enable event logging Default: False <code>auto_validate_importables</code> BooleanField Automatically validate importable hosts Default: False <code>auto_validate_quick_add</code> BooleanField Automatically validate quick-add hosts Default: False <code>max_deletions</code> IntegerField Limits deletions of stale entries on Zabbix imports Default: 3 <code>max_success_notifications</code> IntegerField Max number of success messages shown per job Default: 3 <code>zabbix_import_interval</code> PositiveIntegerField Interval in minutes between each Zabbix import Choices from SystemJobIntervalChoices <code>host_config_sync_interval</code> PositiveIntegerField Interval in minutes between each Host Config Sync check Choices from SystemJobIntervalChoices <code>cutoff_host_config_sync</code> PositiveIntegerField Minutes to look back when determining which HostConfigs need syncing Default: 60 <code>maintenance_cleanup_interval</code> PositiveIntegerField Interval in minutes between maintenance cleanup Choices from SystemJobIntervalChoices <code>version</code> CharField (max_length=255) Zabbix server version Nullable <code>api_endpoint</code> CharField (max_length=255) URL to the Zabbix API endpoint Required <code>web_address</code> CharField (max_length=255) URL to the Zabbix web interface Required <code>_encrypted_token</code> TextField Encrypted API token Stored in encrypted format <code>connection</code> BooleanField Connection status to Zabbix Default: False <code>last_checked_at</code> DateTimeField When connection was last verified Nullable <code>delete_setting</code> CharField (max_length=10) Delete settings mode Choices: 'soft', 'hard'. Default: 'soft' <code>graveyard</code> CharField (max_length=255) Host Group for soft deletes Default: \"graveyard\" <code>graveyard_suffix</code> CharField (max_length=255) Suffix for deleted hosts Default: \"_archived\" <code>exclude_custom_field_name</code> CharField (max_length=255) Custom field name for exclusion Default: \"Exclude from Zabbix\" <code>exclude_custom_field_enabled</code> BooleanField Enable custom field exclusion Default: False <code>useip</code> IntegerField Connect via IP or DNS Choices from UseIPChoices. Default: IP <code>inventory_mode</code> IntegerField Mode for populating inventory Choices from InventoryModeChoices. Default: MANUAL <code>monitored_by</code> IntegerField Method used to monitor hosts Choices from MonitoredByChoices. Default: ZabbixServer <code>tls_connect</code> IntegerField TLS mode for outgoing connections Choices from TLSConnectChoices. Default: PSK <code>tls_accept</code> IntegerField TLS mode accepted for incoming connections Choices from TLSAcceptChoices. Default: PSK <code>tls_psk_identity</code> CharField (max_length=255) PSK identity Nullable <code>tls_psk</code> CharField (max_length=255) Pre-shared key Nullable <code>agent_port</code> IntegerField Agent default port Default: 10050 <code>snmp_port</code> IntegerField SNMP default port Default: 161 <code>snmp_bulk</code> IntegerField Whether to use bulk SNMP requests Choices from SNMPBulkChoices. Default: YES <code>snmp_max_repetitions</code> IntegerField Max repetition value for native SNMP bulk requests Default: 10 <code>snmp_contextname</code> CharField (max_length=255) SNMP context name Nullable <code>snmp_securityname</code> CharField (max_length=255) SNMP security name Default: \"{$SNMPV3_USER}\" <code>snmp_securitylevel</code> IntegerField SNMP security level Choices from SNMPSecurityLevelChoices. Default: authPriv <code>snmp_authprotocol</code> IntegerField SNMP authentication protocol Choices from SNMPAuthProtocolChoices. Default: SHA1 <code>snmp_authpassphrase</code> CharField (max_length=255) SNMP authentication passphrase Default: \"{$SNMPV3_AUTHPASS}\" <code>snmp_privprotocol</code> IntegerField SNMP privacy protocol Choices from SNMPPrivProtocolChoices. Default: AES128 <code>snmp_privpassphrase</code> CharField (max_length=255) SNMP privacy passphrase Default: \"{$SNMPV3_PRIVPASS}\" <code>default_tag</code> CharField (max_length=255) Tag applied to all hosts Nullable <code>tag_prefix</code> CharField (max_length=255) Prefix added to all tags Nullable <code>tag_name_formatting</code> CharField (max_length=10) Tag name formatting Choices: 'keep', 'upper', 'lower'. Default: 'keep'"},{"location":"settings_model/#properties","title":"Properties","text":""},{"location":"settings_model/#token","title":"<code>token</code>","text":"<p>Property for getting and setting the encrypted API token.</p> <p>Getter Returns: - <code>str</code> or <code>None</code>: Decrypted token or None if decryption fails</p> <p>Setter: - Encrypts and stores the provided token value</p>"},{"location":"settings_model/#methods","title":"Methods","text":""},{"location":"settings_model/#__str__","title":"<code>__str__()</code>","text":"<p>Return a human-readable string representation of the object.</p> <p>Returns: - <code>str</code>: Human-readable name of the object</p>"},{"location":"settings_model/#get_absolute_url","title":"<code>get_absolute_url()</code>","text":"<p>Return the canonical URL for this object within the plugin UI.</p> <p>Returns: - <code>str</code>: Absolute URL for the setting</p>"},{"location":"settings_model/#get_system_jobs_scheduled","title":"<code>get_system_jobs_scheduled()</code>","text":"<p>Return the system job scheduled status.</p> <p>Returns: - HTML-formatted string with checkmark or cross indicating job status</p>"},{"location":"settings_model/#get_fernet","title":"<code>get_fernet()</code>","text":"<p>Return a Fernet instance if the key exists.</p> <p>Returns: - <code>Fernet</code> instance or <code>None</code></p>"},{"location":"settings_model/#token-property","title":"<code>token</code> (property)","text":"<p>Getter and setter for the encrypted token.</p> <p>Returns: - Decrypted token (getter) or None if decryption fails - Sets encrypted token (setter)</p>"},{"location":"settings_model/#saveargs-kwargs","title":"<code>save(*args, **kwargs)</code>","text":"<p>Save the Setting instance to the database and schedule system jobs.</p> <p>Parameters: - <code>*args</code>: Positional arguments passed to the model save method - <code>**kwargs</code>: Keyword arguments passed to the model save method</p>"},{"location":"settings_model/#usage-examples","title":"Usage Examples","text":""},{"location":"settings_model/#creating-a-basic-setting-configuration","title":"Creating a Basic Setting Configuration","text":"<pre><code>from netbox_zabbix.models import Setting\n\n# Create a basic setting configuration\nsetting = Setting.objects.create(\n    name=\"Production Zabbix\",\n    api_endpoint=\"https://zabbix.example.com/api_jsonrpc.php\",\n    web_address=\"https://zabbix.example.com/\",\n    # Add other required fields as needed\n)\n</code></pre>"},{"location":"settings_model/#configuring-connection-settings","title":"Configuring Connection Settings","text":"<pre><code># Configure Zabbix server connection\nsetting.api_endpoint = \"https://zabbix.example.com/api_jsonrpc.php\"\nsetting.web_address = \"https://zabbix.example.com/\"\nsetting.token = \"your-api-token-here\"  # Will be encrypted automatically\nsetting.save()\n</code></pre>"},{"location":"settings_model/#setting-up-tls-configuration","title":"Setting Up TLS Configuration","text":"<pre><code>from netbox_zabbix.models import TLSConnectChoices, TLSAcceptChoices\n\n# Configure PSK encryption\nsetting.tls_connect = TLSConnectChoices.PSK\nsetting.tls_accept = TLSAcceptChoices.PSK\nsetting.tls_psk_identity = \"my_plugin_identity\"\nsetting.tls_psk = \"a1b2c3d4e5f67890abcdef1234567890\"  # Should be at least 32 hex digits\nsetting.save()\n</code></pre>"},{"location":"settings_model/#configuring-host-management-settings","title":"Configuring Host Management Settings","text":"<pre><code># Configure deletion settings\nsetting.delete_setting = \"soft\"  # or \"hard\"\nsetting.graveyard = \"archived_hosts\"\nsetting.graveyard_suffix = \"_deleted\"\nsetting.save()\n\n# Configure exclusion settings\nsetting.exclude_custom_field_name = \"Exclude from Monitoring\"\nsetting.exclude_custom_field_enabled = True\nsetting.save()\n</code></pre>"},{"location":"settings_model/#setting-up-snmp-defaults","title":"Setting Up SNMP Defaults","text":"<pre><code>from netbox_zabbix.models import SNMPSecurityLevelChoices, SNMPAuthProtocolChoices, SNMPPrivProtocolChoices\n\n# Configure SNMP defaults\nsetting.snmp_port = 161\nsetting.snmp_securitylevel = SNMPSecurityLevelChoices.authPriv\nsetting.snmp_authprotocol = SNMPAuthProtocolChoices.SHA1\nsetting.snmp_privprotocol = SNMPPrivProtocolChoices.AES128\nsetting.save()\n</code></pre>"},{"location":"settings_model/#configuring-system-job-intervals","title":"Configuring System Job Intervals","text":"<pre><code>from netbox_zabbix.models import SystemJobIntervalChoices\n\n# Configure system job intervals\nsetting.zabbix_import_interval = SystemJobIntervalChoices.INTERVAL_HOURLY\nsetting.host_config_sync_interval = SystemJobIntervalChoices.INTERVAL_EVERY_2_HOURS\nsetting.maintenance_cleanup_interval = SystemJobIntervalChoices.INTERVAL_DAILY\nsetting.save()\n</code></pre>"},{"location":"settings_model/#integration-with-other-models","title":"Integration with Other Models","text":"<p>Setting integrates with several other components in the plugin:</p> <ol> <li> <p>System Jobs: Settings control the frequency and behavior of automated system jobs for importing Zabbix data and synchronizing host configurations.</p> </li> <li> <p>HostConfig Model: Settings provide default values and configuration parameters that are used when creating and managing HostConfig objects.</p> </li> <li> <p>Proxy and ProxyGroup Models: Settings define default TLS and connection parameters that are used for proxy configurations.</p> </li> <li> <p>Interface Models: Settings provide default port numbers, TLS configurations, and connection methods for both AgentInterface and SNMPInterface objects.</p> </li> <li> <p>Zabbix API: Settings store the connection information and authentication credentials needed to communicate with the Zabbix API.</p> </li> </ol>"},{"location":"settings_model/#description","title":"Description","text":"<p>The Setting model provides a comprehensive configuration framework that controls all aspects of the NetBox Zabbix plugin's operation. It centralizes configuration management, making it easier to maintain consistent settings across different environments and deployment scenarios.</p> <p>Key configuration areas managed by the Setting model include:</p> <p>Connection Management: - Zabbix server API endpoint and web interface URLs - Authentication token storage with encryption - Connection status monitoring and verification</p> <p>Host Configuration: - Default interface settings for agent and SNMP connections - IP assignment methods and connection preferences - Inventory mode configurations - Default monitoring sources (server, proxy, or proxy group)</p> <p>Security Configuration: - TLS connection settings for encrypted communications - PSK identity and key management - Certificate-based authentication parameters</p> <p>Operational Parameters: - System job scheduling intervals for imports and synchronization - Deletion policies for soft vs. hard deletion of monitoring objects - Event logging and notification thresholds - Automatic validation settings for importable and quick-add hosts</p> <p>Exclusion Management: - Custom field-based exclusion of NetBox objects from monitoring - Configuration of exclusion field names and enablement</p> <p>Tagging Configuration: - Default tags applied to all synchronized hosts - Tag prefix configurations for namespace organization - Tag name formatting options (uppercase, lowercase, or preserved)</p> <p>The model implements robust validation to prevent misconfiguration and ensures that sensitive data like API tokens are properly encrypted. It also provides programmatic access to settings through helper methods and properties, making it easy for other parts of the plugin to retrieve configuration values safely.</p>"},{"location":"setup/","title":"The Setup Zabbix Management Command","text":""},{"location":"setup/#the-setup-zabbix-management-command","title":"The Setup Zabbix Management Command","text":"<p>The setup zabbix management command initializes required defaults, mappings, and cryptographic keys. Below are a description of each individual step in the setup process. The setup script is divided into two parts. The first part prompts the user to configure the connection to Zabbix and stores this information securely in the NetBox database. The second part allows the user to configure default Device and VM mappings.</p> <p>Part 1 \u2014 Configure Zabbix Connection</p> <p>Step 1. Enter a name for this configuration</p> <p><pre><code>Enter the name of the setting instance [config]:\n</code></pre> This becomes the instance name of the Setting object.</p> <p>Step 2. Enter the Zabbix host and URLs The script auto-detects the machine hostname and proposes defaults:</p> <p><pre><code>Enter the Zabbix host [myserver.example.com]:\nEnter the Zabbix API URL [https://myserver.example.com/api_jsonrpc.php]:\nEnter the Zabbix Web URL [https://myserver.example.com]:\n</code></pre> The user can accept defaults or enter custom values.</p> <p>Step 3. Enter the Zabbix API Token The token cannot be empty. The command will repeat the prompt until a non-empty value is provided:</p> <pre><code>Enter the Zabbix API token:\n</code></pre> <p>Step 4. Provide or confirm the path to the fernet.key file The plugin uses Fernet encryption for secure token storage.</p> <pre><code>Path to Fernet key file [/opt/netbox/netbox_zabbix/fernet.key]:\n</code></pre> <p>The user may: Accept the default path, or Provide a custom path.</p> <p>If the file does not exist, the script creates the file and the fernet key automatically and prints the location.</p> <p>Step 5. The script imports data from Zabbix</p> <p>The plugin now contacts Zabbix and loads:</p> <ul> <li>Templates</li> <li>Host groups</li> <li>Proxies</li> <li>Proxy groups</li> </ul> <p>Part 2 \u2014 Configure Device and VM Mappings</p> <p>The script next asks the user to define default mappings for devices and virtual machines. These values will be used when automatically assigning Zabbix templates and groups to NetBox objects.</p> <p>Important: A new Zabbix installation defines a number of Templates and Host Groups. The default template selected should be compatible with both Zabbix Agent and SNMPv3 interfaces. For broad compatibility, ICMP Ping is recommended.</p> <p>Step 7. Select the default Template (required)</p> <pre><code>Enter Default Template\n 1. ICMP Ping\n 2. Linux by Zabbix agent\n 3. SNMP Device\nSelect a number [1\u20133]:\n</code></pre> <p>Recommendation: Choose ICMP Ping for maximum compatibility across Agents and SNMPv3 devices.</p> <p>Step 8. Select the default Host Group (required) Similar numbered list:</p> <pre><code>Enter Default Host Group\n 1. Linux Servers\n 2. Network Devices\nSelect a number [1\u20132]:\n</code></pre> <p>Step 9. Select the Default Proxy (optional \u2014 may skip with Enter)</p> <pre><code>Enter Default Proxy\n 1. zbx-proxy-eu\n 2. zbx-proxy-us\nSelect a number [1\u20132] (Enter to skip):\n</code></pre> <p>Step 10. Select the Default Proxy Group (optional \u2014 may skip with Enter)</p> <pre><code>Enter Default Proxy Group\n 1. EU Datacenter\n 2. US Datacenter\nSelect a number [1\u20132] (Enter to skip):\n</code></pre> <p>Step 11. The script stores the mappings in the database Both DeviceMapping and VMMapping are created or updated.</p> <p>Step 12. Final Step \u2014 Add FERNET_KEY_PATH to NetBox configuration At the end of the setup, the script prints instructions:</p> <pre><code>Next Required Step\n\nYou must add the path to your fernet.key file in PLUGINS_CONFIG:\n\nPLUGINS_CONFIG = {\n    'netbox_zabbix': {\n        \"FERNET_KEY_PATH\": \"/opt/netbox/netbox_zabbix/fernet.key\"\n    }\n}\n</code></pre>"},{"location":"snmpinterface_model/","title":"SNMPInterface Model","text":""},{"location":"snmpinterface_model/#snmpinterface-model","title":"SNMPInterface Model","text":""},{"location":"snmpinterface_model/#overview","title":"Overview","text":"<p>The <code>SNMPInterface</code> model represents an SNMP interface linked to a HostConfig, defining how a monitored host communicates with Zabbix via the SNMP protocol.</p>"},{"location":"snmpinterface_model/#model-definition","title":"Model Definition","text":"<p>SNMPInterface extends the BaseInterface abstract model and adds fields specific to SNMP monitoring. It defines the configuration for SNMP-based monitoring, including all necessary SNMP parameters like version, authentication, and privacy settings.</p>"},{"location":"snmpinterface_model/#fields","title":"Fields","text":"<p>Inherits all fields from BaseInterface plus:</p> Field Type Description Notes <code>host_config</code> ForeignKey (HostConfig) Link to the parent HostConfig related_name=\"snmp_interfaces\" <code>interface_type</code> ForeignKey (ContentType) Content type of the associated NetBox interface Limited to Interface or VMInterface models <code>interface_id</code> PositiveIntegerField ID of the associated NetBox interface <code>interface</code> GenericForeignKey Generic foreign key to the NetBox interface <code>ip_address</code> ForeignKey (IPAddress) Associated IP address from NetBox IPAM related_name=\"snmp_interface\", nullable <code>type</code> IntegerField Interface type Choices from TypeChoices, default=SNMP <code>port</code> IntegerField Port number used by the interface Default=161 <code>version</code> IntegerField SNMP version Choices from SNMPVersionChoices, default=SNMPv3, nullable <code>bulk</code> IntegerField Whether to use bulk SNMP requests Choices from SNMPBulkChoices, default=1, nullable <code>max_repetitions</code> IntegerField Max repetition value for native SNMP bulk requests Default=10, nullable <code>contextname</code> CharField (max_length=255) SNMP context name Nullable <code>securityname</code> CharField (max_length=255) SNMP security name Default=\"{$SNMPV3_USER}\", nullable <code>securitylevel</code> IntegerField SNMP security level Choices from SNMPSecurityLevelChoices, default=SNMPSecurityLevelChoices.authPriv, nullable <code>authprotocol</code> IntegerField SNMP authentication protocol Choices from SNMPAuthProtocolChoices, default=SNMPAuthProtocolChoices.SHA1, nullable <code>authpassphrase</code> CharField (max_length=255) SNMP authentication passphrase Default=\"{$SNMPV3_AUTHPASS}\", nullable <code>privprotocol</code> IntegerField SNMP privacy protocol Choices from SNMPPrivProtocolChoices, default=SNMPPrivProtocolChoices.AES128, nullable <code>privpassphrase</code> CharField (max_length=255) SNMP privacy passphrase Default=\"{$SNMPV3_PRIVPASS}\", nullable"},{"location":"snmpinterface_model/#methods","title":"Methods","text":""},{"location":"snmpinterface_model/#saveargs-kwargs","title":"<code>save(*args, **kwargs)</code>","text":"<p>Ensure only one main SNMPInterface exists per host_config and validate the instance.</p> <p>Parameters: - <code>*args</code>: Positional arguments passed to the parent save method - <code>**kwargs</code>: Keyword arguments passed to the parent save method</p> <p>Raises: - <code>ValidationError</code>: If the model is invalid</p>"},{"location":"snmpinterface_model/#__str__","title":"<code>__str__()</code>","text":"<p>Return a string representation of the SNMP interface.</p> <p>Returns: - <code>str</code>: String representation of the SNMP interface</p>"},{"location":"snmpinterface_model/#clean","title":"<code>clean()</code>","text":"<p>Validate that the assigned IP address matches the interface.</p> <p>Raises: - <code>ValidationError</code>: If IP does not belong to the selected interface</p>"},{"location":"snmpinterface_model/#get_absolute_url","title":"<code>get_absolute_url()</code>","text":"<p>Return the canonical URL for this SNMP interface within the NetBox plugin UI.</p> <p>Returns: - <code>str</code>: Absolute URL for the SNMP interface</p>"},{"location":"snmpinterface_model/#usage-examples","title":"Usage Examples","text":""},{"location":"snmpinterface_model/#creating-an-snmp-interface","title":"Creating an SNMP Interface","text":"<pre><code>from netbox_zabbix.models import SNMPInterface, HostConfig\nfrom dcim.models import Interface\nfrom ipam.models import IPAddress\n\n# Get the host configuration\nhost_config = HostConfig.objects.get(name=\"z-router-01\")\n\n# Get the NetBox interface\nnetbox_interface = Interface.objects.get(name=\"GigabitEthernet0/1\", device__name=\"router-01\")\n\n# Get the IP address\nip_address = IPAddress.objects.get(address=\"192.168.1.1/24\")\n\n# Create an SNMP interface\nsnmp_interface = SNMPInterface.objects.create(\n    host_config=host_config,\n    interface=netbox_interface,\n    ip_address=ip_address,\n    port=161,\n    version=3,  # SNMPv3\n    securitylevel=2,  # authPriv\n    authprotocol=1,   # SHA1\n    privprotocol=1,   # AES128\n    useip=1,  # Use IP\n    main=1    # Main interface\n)\n</code></pre>"},{"location":"snmpinterface_model/#configuring-snmpv2-interface","title":"Configuring SNMPv2 Interface","text":"<pre><code># Create an SNMPv2 interface\nsnmp_v2_interface = SNMPInterface.objects.create(\n    host_config=host_config,\n    interface=netbox_interface,\n    ip_address=ip_address,\n    port=161,\n    version=2,  # SNMPv2c\n    useip=1,    # Use IP\n    main=1      # Main interface\n)\n</code></pre>"},{"location":"snmpinterface_model/#working-with-snmp-interface-properties","title":"Working with SNMP Interface Properties","text":"<pre><code># Access resolved IP address\nip_address = snmp_interface.resolved_ip_address\nif ip_address:\n    print(f\"SNMP connecting on IP: {ip_address}\")\n\n# Access resolved DNS name\ndns_name = snmp_interface.resolved_dns_name\nif dns_name:\n    print(f\"SNMP connecting on DNS: {dns_name}\")\n\n# Check if this is the main interface\nif snmp_interface.main == 1:\n    print(\"This is the main SNMP interface\")\n\n# Check SNMP version\nif snmp_interface.version == 3:\n    print(f\"Using SNMPv3 with security level: {snmp_interface.securitylevel}\")\n</code></pre>"},{"location":"snmpinterface_model/#updating-snmp-configuration","title":"Updating SNMP Configuration","text":"<pre><code># Change SNMP version\nsnmp_interface.version = 2  # SNMPv2c\nsnmp_interface.save()\n\n# Update SNMPv3 security settings\nsnmp_interface.securitylevel = 1  # authNoPriv\nsnmp_interface.authprotocol = 2   # SHA256\nsnmp_interface.privprotocol = 0   # No privacy\nsnmp_interface.save()\n\n# Disable bulk operations\nsnmp_interface.bulk = 0\nsnmp_interface.save()\n</code></pre>"},{"location":"snmpinterface_model/#integration-with-other-models","title":"Integration with Other Models","text":"<p>SNMPInterface integrates with several other models in the plugin:</p> <ol> <li> <p>HostConfig Model: SNMPInterface instances are associated with specific HostConfig objects through a foreign key relationship.</p> </li> <li> <p>BaseInterface Model: SNMPInterface inherits from BaseInterface, sharing common interface functionality.</p> </li> <li> <p>NetBox Interface Model: SNMPInterface links to NetBox Interface objects for device/VLAN information.</p> </li> <li> <p>NetBox VMInterface Model: SNMPInterface can also link to NetBox VMInterface objects for virtual machine interfaces.</p> </li> <li> <p>NetBox IPAddress Model: SNMPInterface links to NetBox IPAddress objects for IP connectivity.</p> </li> </ol>"},{"location":"snmpinterface_model/#description","title":"Description","text":"<p>SNMPInterface objects define the configuration for SNMP-based monitoring, including all necessary SNMP parameters like version, authentication, and privacy settings.</p> <p>Key features: - Links to a specific HostConfig object - Associates with NetBox Interface or VMInterface objects through generic foreign keys - Can reference a specific IP address from NetBox IPAM - Configures SNMP communication port (default 161) - Supports SNMP versions 1, 2c, and 3 - Configures authentication and privacy settings for SNMPv3 - Supports bulk SNMP operations - Supports designation as the main interface for the host - Ensures only one main SNMP interface exists per host configuration - Validates that assigned IP addresses belong to the selected interface</p> <p>The model provides comprehensive SNMP configuration options: - SNMP version selection (v1, v2c, v3) - Security level configuration (noAuthNoPriv, authNoPriv, authPriv) - Authentication protocol selection (MD5, SHA1, SHA224, SHA256, SHA384, SHA512) - Privacy protocol selection (DES, AES128, AES192, AES256) - Context name support for SNMPv3 - Bulk operation settings for improved performance</p> <p>The model automatically handles ensuring that only one SNMP interface is marked as \"main\" per host configuration, updating other interfaces if needed when changing the main interface designation. This prevents configuration conflicts in Zabbix where multiple main interfaces could cause monitoring issues.</p>"},{"location":"tagmapping_model/","title":"TagMapping Model","text":""},{"location":"tagmapping_model/#netbox-zabbix-plugin---tagmapping-documentation","title":"NetBox Zabbix Plugin - TagMapping Documentation","text":""},{"location":"tagmapping_model/#overview","title":"Overview","text":"<p>The TagMapping in the NetBox Zabbix plugin defines how NetBox object fields are mapped to Zabbix tags for devices and virtual machines. This document explains the TagMapping's structure, fields, properties, methods, and usage.</p>"},{"location":"tagmapping_model/#model-definition","title":"Model Definition","text":"<p>The TagMapping provides a flexible way to configure which NetBox object fields should be exported as tags in Zabbix. Separate mappings can be defined for devices and virtual machines, allowing different tagging strategies for each object type.</p>"},{"location":"tagmapping_model/#fields","title":"Fields","text":"Field Type Description Notes <code>object_type</code> CharField (max_length=20) Type of NetBox object Choices: 'device', 'virtualmachine'. Must be unique. <code>selection</code> JSONField Field paths for Zabbix tags List of field paths to use as tags"},{"location":"tagmapping_model/#object_type","title":"<code>object_type</code>","text":"<p>Specifies which type of NetBox object this mapping applies to. Valid choices are: - <code>device</code>: Applies to NetBox Device objects - <code>virtualmachine</code>: Applies to NetBox VirtualMachine objects</p> <p>This field must be unique, meaning only one TagMapping can exist for each object type.</p>"},{"location":"tagmapping_model/#selection","title":"<code>selection</code>","text":"<p>A JSON array containing field paths that specify which NetBox object attributes should be exported as Zabbix tags. Each field path is a dot-notation string that references attributes of the NetBox object.</p> <p>For example: <pre><code>[\n    \"site.name\",\n    \"role.name\",\n    \"platform.name\"\n]\n</code></pre></p> <p>This would create Zabbix tags for the site name, role name, and platform name of each device or virtual machine.</p>"},{"location":"tagmapping_model/#methods","title":"Methods","text":""},{"location":"tagmapping_model/#__str__","title":"<code>__str__()</code>","text":"<p>Returns a human-readable string representation in the format \"Tag Mapping {object_type}\".</p> <p>Returns: - <code>str</code>: Human-readable string representation</p>"},{"location":"tagmapping_model/#get_absolute_url","title":"<code>get_absolute_url()</code>","text":"<p>Returns the canonical URL for this tag mapping within the NetBox plugin UI.</p> <p>Returns: - <code>str</code>: Absolute URL for the tag mapping</p>"},{"location":"tagmapping_model/#usage-examples","title":"Usage Examples","text":""},{"location":"tagmapping_model/#creating-a-device-tag-mapping","title":"Creating a Device Tag Mapping","text":"<pre><code>from netbox_zabbix.models import TagMapping\nimport json\n\n# Create a tag mapping for devices\ndevice_tag_mapping = TagMapping.objects.create(\n    object_type='device',\n    selection=[\n        'site.name',\n        'site.region.name',\n        'role.name',\n        'platform.name',\n        'location.name'\n    ]\n)\n</code></pre>"},{"location":"tagmapping_model/#creating-a-virtual-machine-tag-mapping","title":"Creating a Virtual Machine Tag Mapping","text":"<pre><code># Create a tag mapping for virtual machines\nvm_tag_mapping = TagMapping.objects.create(\n    object_type='virtualmachine',\n    selection=[\n        'site.name',\n        'cluster.name',\n        'role.name',\n        'platform.name'\n    ]\n)\n</code></pre>"},{"location":"tagmapping_model/#modifying-an-existing-tag-mapping","title":"Modifying an Existing Tag Mapping","text":"<pre><code># Update an existing tag mapping\ntag_mapping = TagMapping.objects.get(object_type='device')\ntag_mapping.selection.append('tenant.name')\ntag_mapping.save()\n</code></pre>"},{"location":"tagmapping_model/#working-with-tag-mappings-in-code","title":"Working with Tag Mappings in Code","text":"<pre><code># Retrieve and use tag mappings\nfrom netbox_zabbix.models import TagMapping\n\ndef get_device_tags(device):\n    \"\"\"Get Zabbix tags for a device based on its tag mapping.\"\"\"\n    try:\n        tag_mapping = TagMapping.objects.get(object_type='device')\n        tags = {}\n        for field_path in tag_mapping.selection:\n            # Navigate the field path to get the value\n            obj = device\n            for attr in field_path.split('.'):\n                if obj is None:\n                    break\n                obj = getattr(obj, attr, None)\n            if obj is not None:\n                # Use the last part of the path as the tag name\n                tag_name = field_path.split('.')[-1].title()\n                tags[tag_name] = str(obj)\n        return tags\n    except TagMapping.DoesNotExist:\n        return {}\n</code></pre>"},{"location":"tagmapping_model/#integration-with-other-models","title":"Integration with Other Models","text":"<p>TagMapping integrates with the core NetBox models: 1. Device Model: Device tag mappings determine which device attributes become Zabbix tags 2. VirtualMachine Model: Virtual machine tag mappings determine which VM attributes become Zabbix tags 3. HostConfig Model: Tag mappings are used when creating Zabbix host configurations</p>"},{"location":"tagmapping_model/#description","title":"Description","text":"<p>The TagMapping model provides a flexible configuration system for exporting NetBox object attributes as Zabbix tags. This allows for rich metadata association with monitored hosts, enabling better organization, filtering, and correlation of monitoring data.</p> <p>Key features include: - Separate mappings for devices and virtual machines - Flexible field path specification using dot notation - Support for nested object attributes - Programmatic access to tag mapping configurations - Integration with the HostConfig model for tag application during provisioning</p>"},{"location":"template_model/","title":"Template Model","text":""},{"location":"template_model/#netbox-zabbix-plugin---template-documentation","title":"NetBox Zabbix Plugin - Template Documentation","text":""},{"location":"template_model/#overview","title":"Overview","text":"<p>The Template in the NetBox Zabbix plugin represents Zabbix templates that can be applied to hosts for monitoring configuration. This document explains the Template's structure, fields, properties, methods, and usage.</p>"},{"location":"template_model/#model-definition","title":"Model Definition","text":"<p>The Template model synchronizes with Zabbix templates and maintains relationships between templates in both NetBox and Zabbix systems. Templates in Zabbix define the monitoring configuration that can be applied to multiple hosts.</p>"},{"location":"template_model/#fields","title":"Fields","text":"Field Type Description Notes <code>name</code> CharField (max_length=255) Name of the Zabbix template Human-readable identifier <code>templateid</code> CharField (max_length=255) Unique identifier in Zabbix Zabbix internal template ID <code>last_synced</code> DateTimeField Last synchronization timestamp Nullable, tracks sync status <code>interface_type</code> IntegerField Required interface type Default: <code>Any</code> (0). Options: <code>Any</code> (0), <code>Agent</code> (1), <code>SNMP</code> (2)"},{"location":"template_model/#name","title":"<code>name</code>","text":"<p>The human-readable name of the Zabbix template as it appears in both NetBox and Zabbix. This field serves as the primary identifier for the template.</p>"},{"location":"template_model/#templateid","title":"<code>templateid</code>","text":"<p>The unique identifier assigned by Zabbix for this template. This field is populated automatically when the template is created or synchronized with Zabbix.</p>"},{"location":"template_model/#last_synced","title":"<code>last_synced</code>","text":"<p>Timestamp indicating when the template was last synchronized with Zabbix. This helps track the freshness of the data in NetBox compared to Zabbix.</p>"},{"location":"template_model/#interface_type","title":"<code>interface_type</code>","text":"<p>Determines what kind of interface is required for hosts using this template: - <code>Any</code> (0): Template can be applied to hosts with any interface type - <code>Agent</code> (1): Template requires a Zabbix agent interface - <code>SNMP</code> (2): Template requires an SNMP interface</p>"},{"location":"template_model/#template-relationships","title":"Template Relationships","text":"<p>Templates can have complex relationships with other templates:</p>"},{"location":"template_model/#parents","title":"<code>parents</code>","text":"<p>Many-to-many relationship to other Template objects representing parent templates (linked as children). This is asymmetrical, meaning if Template A is a parent of Template B, Template B is not automatically a parent of Template A.</p>"},{"location":"template_model/#children","title":"<code>children</code>","text":"<p>Related manager for child templates (reverse of parents). This is automatically created by Django and provides access to templates that have this template as their parent.</p>"},{"location":"template_model/#dependencies","title":"<code>dependencies</code>","text":"<p>Many-to-many relationship to other Template objects representing template dependencies. This is asymmetrical, meaning dependencies are directional.</p>"},{"location":"template_model/#dependents","title":"<code>dependents</code>","text":"<p>Related manager for dependent templates (reverse of dependencies). This is automatically created by Django and provides access to templates that depend on this template.</p>"},{"location":"template_model/#methods","title":"Methods","text":""},{"location":"template_model/#__str__","title":"<code>__str__()</code>","text":"<p>Returns the template name as a human-readable string representation.</p> <p>Returns: - <code>str</code>: Template name</p>"},{"location":"template_model/#get_absolute_url","title":"<code>get_absolute_url()</code>","text":"<p>Returns the canonical URL for this template within the NetBox plugin UI.</p> <p>Returns: - <code>str</code>: Absolute URL for the template</p>"},{"location":"template_model/#usage-examples","title":"Usage Examples","text":""},{"location":"template_model/#creating-a-template-entry","title":"Creating a Template Entry","text":"<pre><code>from netbox_zabbix.models import Template\n\n# Create a new template entry\ntemplate = Template.objects.create(\n    name=\"Template OS Linux by Zabbix agent\",\n    templateid=\"10001\",\n    interface_type=1  # Agent interface required\n)\n</code></pre>"},{"location":"template_model/#working-with-template-relationships","title":"Working with Template Relationships","text":"<pre><code># Create parent-child relationship\nparent_template = Template.objects.get(name=\"Template App HTTP\")\nchild_template = Template.objects.get(name=\"Template App HTTP Service\")\n\n# Add child relationship\nparent_template.children.add(child_template)\n\n# Create dependency relationship\ndependent_template = Template.objects.get(name=\"Template App Database\")\nsource_template = Template.objects.get(name=\"Template OS Linux\")\n\n# Add dependency\ndependent_template.dependencies.add(source_template)\n</code></pre>"},{"location":"template_model/#filtering-templates-by-interface-type","title":"Filtering Templates by Interface Type","text":"<pre><code>from netbox_zabbix.models import Template, InterfaceTypeChoices\n\n# Get all templates that require Agent interface\nagent_templates = Template.objects.filter(\n    interface_type=InterfaceTypeChoices.Agent\n)\n\n# Get all templates that work with any interface\nany_templates = Template.objects.filter(\n    interface_type=InterfaceTypeChoices.Any\n)\n</code></pre>"},{"location":"template_model/#integration-with-other-models","title":"Integration with Other Models","text":"<p>Templates are integrated with several other models in the plugin:</p> <ol> <li> <p>Mapping Models: Templates are referenced in DeviceMapping and VMMapping objects to determine which templates should be applied to specific hosts.</p> </li> <li> <p>HostConfig Model: Templates are assigned to HostConfig objects to define the monitoring configuration for individual hosts.</p> </li> <li> <p>Synchronization: Templates are synchronized with Zabbix to ensure that template information is consistent between both systems.</p> </li> </ol>"},{"location":"template_model/#description","title":"Description","text":"<p>The Template model provides synchronization capabilities between NetBox and Zabbix template structures. It maintains the relationship between monitoring configurations in both systems, enabling consistent template application and management.</p> <p>Key features include: - Automatic synchronization with Zabbix templates - Support for template hierarchies through parent-child relationships - Dependency management between templates - Interface type requirements for proper template-host matching - Integration with Mapping and HostConfig models - Preservation of Zabbix identifiers for recovery operations</p>"},{"location":"user_guide/","title":"User Guide","text":""},{"location":"user_guide/#netbox-zabbix-plugin-user-guide","title":"NetBox Zabbix Plugin User Guide","text":""},{"location":"user_guide/#overview","title":"Overview","text":"<p>This guide is intended for users who work with the NetBox Zabbix plugin via the NetBox web interface. It describes daily operations for managing monitoring configurations and explains how the plugin integrates Zabbix host management into NetBox.</p>"},{"location":"user_guide/#getting-started","title":"Getting Started","text":""},{"location":"user_guide/#accessing-the-plugin","title":"Accessing the Plugin","text":"<p>Once installed and configured, the plugin seamlessly integrates into the NetBox interface. Users will find new menu options that allow interaction with Zabbix hosts, interfaces, importable hosts, NetBox-only hosts, and maintenance windows.</p>"},{"location":"user_guide/#core-concepts","title":"Core Concepts","text":"<p>Before diving into operations, it is useful to understand several key concepts:</p> <ul> <li>Host Configuration represents a Zabbix host linked to a NetBox device or virtual machine, encapsulating all monitoring settings.</li> <li>Mappings define rules that determine how NetBox objects are translated into Zabbix host configurations, including template assignments and proxy selections.</li> <li>Jobs are background processes that ensure synchronization and other tasks occur without blocking the user interface.</li> <li>Sync Status indicates whether a host configuration accurately reflects its corresponding Zabbix host.</li> <li>Interfaces define how Zabbix communicates with monitored hosts, either through Agent or SNMP protocols.</li> </ul>"},{"location":"user_guide/#managing-hosts","title":"Managing Hosts","text":""},{"location":"user_guide/#host-configuration-concept","title":"Host Configuration Concept","text":"<p>A Host Configuration is the core component that connects a NetBox device or virtual machine to its corresponding Zabbix host. It acts as a bridge between asset management and monitoring, defining how each infrastructure element should be monitored.</p> <p>Each host configuration contains all the information needed to create and maintain the Zabbix host. This includes the associated NetBox device or VM, selected monitoring templates, assigned host groups, and proxy or proxy group assignments for distributed monitoring. The configuration also specifies the interface type (Agent, SNMPv3), host status, and descriptive information. This centralized approach ensures consistent monitoring, simplifies management, and provides clear traceability between NetBox and Zabbix.</p>"},{"location":"user_guide/#creating-host-configurations","title":"Creating Host Configurations","text":"<p>Creating a new host configuration begins in the Hosts menu of the plugin. After selecting \u201cAdd,\u201d the user fills in a form specifying the host name, the type of object (device or virtual machine), and the specific device or VM to associate. The interface type must also be chosen, defining whether communication will occur via Agent, SNMP, or both.</p> <p>Templates and host groups are pre-populated based on the mappings that match the selected device or VM. Proxy or proxy group assignment is similarly determined, although users can override these defaults if necessary. Additional fields include host status, monitoring preferences, and optional descriptions. Upon saving the configuration, a background job is automatically queued to create the corresponding host in Zabbix, ensuring that the system remains in sync with NetBox.</p>"},{"location":"user_guide/#viewing-host-details","title":"Viewing Host Details","text":"<p>The details page for a host configuration presents a comprehensive overview of the host\u2019s monitoring setup. Users can examine the current synchronization status, assigned templates, host groups, and interface configurations. Information regarding monitoring state, the last sync timestamp, associated Zabbix host ID, and proxy assignment is also displayed. By centralizing this information, users can quickly understand the status and relationships of each host configuration.</p>"},{"location":"user_guide/#updating-hosts","title":"Updating Hosts","text":"<p>Although background jobs maintain automatic synchronization, users can manually update host configurations when needed. Editing a host configuration and saving the changes queues a background job to propagate updates to Zabbix, ensuring consistency between systems.</p>"},{"location":"user_guide/#deleting-hosts","title":"Deleting Hosts","text":"<p>To remove a host from Zabbix, the user deletes the corresponding Host Configuration object in NetBox. Depending on the system\u2019s settings, this action either performs a soft delete\u2014moving the host to a graveyard\u2014or a hard delete, permanently removing the host from Zabbix. Deletion is managed through background jobs to ensure that all related Zabbix records are correctly updated.</p>"},{"location":"user_guide/#host-sync-operations","title":"Host Sync Operations","text":"<p>The plugin supports multiple synchronization approaches. Users may trigger synchronization for all hosts at once through the Sync All button, or synchronize individual host configurations via the detail view. Background jobs periodically monitor and update synchronization status, keeping NetBox and Zabbix aligned without requiring user intervention.</p>"},{"location":"user_guide/#working-with-interfaces","title":"Working with Interfaces","text":""},{"location":"user_guide/#agent-interfaces","title":"Agent Interfaces","text":"<p>Agent interfaces define how the Zabbix server communicates with hosts using the Zabbix agent protocol. Creating a new Agent Interface involves selecting the host configuration that requires the interface, providing a descriptive name, selecting the NetBox network interface, and specifying the IP address for communication. Default values for port, connection method (IP or DNS), and primary interface designation are automatically populated. Once created, users can modify the port, connection type, or primary status, while the interface name and IP address remain fixed. The DNS name is derived automatically from the chosen IP address. Deletion is allowed only if template dependencies are not affected. If an interface is removable, it is indicated by the \"removable\" column in the table and detailed view, helping you understand which interfaces can be safely deleted without affecting template dependencies.</p>"},{"location":"user_guide/#snmp-interfaces","title":"SNMP Interfaces","text":"<p>SNMP interfaces provide configuration for monitoring hosts via the Simple Network Management Protocol. Users create SNMP interfaces by specifying a name, selecting the NetBox interface, and assigning an IP address. Default SNMP port, connection method, bulk request settings, and maximum repetitions are applied automatically. SNMP interfaces can be edited for protocol parameters, but the interface name and IP remain immutable. The interface supports only SNMPv3. Deletion is allowed only if template dependencies are not affected. If an interface is removable, it is indicated by the \"removable\" column in the table and detailed view, helping you understand which interfaces can be safely deleted without affecting template dependencies.</p>"},{"location":"user_guide/#understanding-mappings","title":"Understanding Mappings","text":"<p>Mappings are the rules that decide how NetBox devices and virtual machines are set up in Zabbix. Instead of manually configuring each host, administrators define mapping policies that automatically apply to matching infrastructure components.</p> <p>When provisioning a new host, the plugin checks all available mappings and applies the first one that matches the NetBox object. This evaluation considers site membership, roles, platforms, and custom fields to select the appropriate monitoring configuration.</p> <p>Two mapping types handle different infrastructure components: Device Mappings for physical hardware like servers and network equipment, and VM Mappings for virtual machines. Both share the same structure but operate independently, allowing different monitoring strategies for physical and virtual infrastructure.</p> <p>Each mapping has two parts: filter criteria that determine which objects it applies to, and configuration settings that define the monitoring elements. Filters can include sites, roles, platforms, and tags for precise targeting. For example, a mapping might target all database servers at a specific location or all Linux VMs.</p> <p>Configuration settings specify the Zabbix elements applied to matching objects, including templates for metrics collection, host groups for organization, proxy assignments for distributed monitoring, and interface types for communication methods.</p> <p>Every mapping system requires one default mapping for devices and one for VMs. This catch-all mapping applies to any object not matched by specific mappings, ensuring all infrastructure gets basic monitoring coverage. Default mappings cannot have restrictive filters and must apply universally.</p> <p>Mappings are predictive, letting users see how any NetBox object will be configured in Zabbix before creating the host. By reviewing mapping criteria, users can determine which templates, host groups, proxies, and interface types will be applied.</p> <p>The plugin enforces validation rules when creating mappings, ensuring only one default mapping exists per object type, non-default mappings include filter criteria, and selected templates are compatible with interface types. These validations maintain mapping integrity and prevent configuration errors.</p>"},{"location":"user_guide/#importable-and-netbox-only-hosts","title":"Importable and NetBox Only Hosts","text":""},{"location":"user_guide/#importable-hosts","title":"Importable Hosts","text":"<p>The Importable Hosts section displays Zabbix hosts that already exist in the Zabbix monitoring system but do not yet have corresponding host configurations in NetBox. This functionality enables organizations to bring existing monitoring configurations under centralized NetBox management, bridging the gap between established Zabbix monitoring and NetBox infrastructure documentation.</p> <p>For a host to appear in this table, the Zabbix host must have the exact same name as an existing NetBox device or virtual machine. This name-based matching ensures that only relevant hosts are presented for import, preventing accidental duplication or mismatched entries.</p> <p>The table presents essential information about each importable host to help users make informed decisions about which hosts to import:</p> <p>Name shows the hostname as configured in Zabbix, which should match the corresponding NetBox object name. This column provides immediate identification of the host to be imported.</p> <p>Type indicates whether the importable host corresponds to a physical Device or a VirtualMachine in NetBox, helping users understand the nature of the infrastructure component.</p> <p>Site displays the NetBox site associated with the matching NetBox object, providing geographical or organizational context for the host.</p> <p>Status shows the current operational status of the NetBox object, such as \"Active,\" \"Offline,\" or \"Planned,\" giving users insight into the object's current state.</p> <p>Role displays the functional role assigned to the NetBox object, such as \"server,\" \"switch,\" or \"firewall,\" which often influences how the object should be managed and monitored.</p> <p>Valid indicates whether the host passes automated validation checks for import into NetBox. When validation succeeds, this field confirms that the system has verified the host can be successfully imported without conflicts. Failed validation signals potential issues that need to be addressed before proceeding with the import.</p> <p>Invalid Reason provides detailed explanations when validation fails, describing specific issues such as naming conflicts with existing NetBox objects, IP address conflicts, missing site associations, or unsupported characters in hostnames. This information guides users in resolving obstacles before importing.</p> <p>Each row in the table represents a Zabbix host ready for import into NetBox. Users can select one or multiple hosts using the checkboxes provided in the first column, then apply bulk operations.</p> <p>When the plugin administrator has enabled the Auto Validate Importables option in the Settings, the Valid and Invalid Reason fields are automatically populated for all displayed hosts without user intervention. This automatic validation continuously checks import readiness and provides immediate feedback on potential issues.</p> <p>However, when automatic validation is disabled or when users want to refresh validation status after making configuration changes, the Validate button becomes essential. By selecting one or more hosts and clicking Validate, users can manually trigger the validation process for those specific hosts. The system then evaluates each selected host against import requirements, populating the Valid and Invalid Reason columns with current status information.</p> <p>To import validated hosts into NetBox, users select the desired hosts using checkboxes and click the Import button. This action initiates the import process, creating corresponding Device or VirtualMachine objects in NetBox with appropriate attributes derived from Zabbix host information. The system establishes relationships between the imported objects and existing NetBox entities such as sites, roles, and IP addresses, while preserving the original Zabbix monitoring configuration. Background jobs handle the technical aspects of the import process, ensuring that NetBox accurately reflects the imported infrastructure while maintaining the existing monitoring setup in Zabbix.</p>"},{"location":"user_guide/#netbox-only-hosts","title":"NetBox Only Hosts","text":"<p>The NetBox Only Hosts section displays devices and virtual machines that exist in NetBox but do not yet have corresponding Zabbix host configurations. This view serves as a provisioning queue, enabling administrators to quickly identify and add NetBox-managed infrastructure to Zabbix monitoring.</p> <p>The table presents key information about each NetBox object to help users make informed provisioning decisions:</p> <p>Name shows the hostname as configured in NetBox, providing immediate identification of the object.</p> <p>Type indicates whether each entry is a physical Device or a VirtualMachine, helping users understand the nature of the infrastructure component.</p> <p>Site displays the NetBox site where the object is physically or logically located, offering geographical or organizational context.</p> <p>Role shows the functional role assigned to the object in NetBox, such as \"server,\" \"router,\" or \"database,\" which often influences monitoring requirements.</p> <p>Platform identifies the operating system or platform of the object, such as \"Linux\" or \"Windows,\" which can affect template selection and monitoring approaches.</p> <p>Agent Mapping displays the DeviceMapping or VMMapping that would be applied during Agent interface provisioning. This column shows which mapping rule matches the object's characteristics and what configuration would be used for Agent-based monitoring.</p> <p>SNMP Mapping displays the DeviceMapping or VMMapping that would be applied during SNMP interface provisioning. Like the Agent Mapping column, this shows the matching rule and configuration that would be used for SNMP-based monitoring.</p> <p>Valid indicates whether the object passes automated validation checks for provisioning. A positive validation means the system has confirmed that the object can be successfully provisioned to Zabbix, while a negative validation signals potential issues that require attention.</p> <p>Invalid Reason provides specific details when validation fails, explaining issues such as missing primary IP addresses, absent matching mappings, or unavailable templates. This information guides users in resolving obstacles before provisioning.</p> <p>Each row in the table represents a NetBox object ready for monitoring integration. Users can select one or multiple objects using the checkboxes provided in the first column, then apply bulk operations.</p> <p>Above the table, the Valid button initiates validation for all currently displayed objects. When clicked, the system evaluates each selected object against provisioning requirements, populating the Valid and Invalid Reason columns with current status information. This is particularly useful when automatic validation is disabled in plugin settings, or when users want to refresh validation status after making configuration changes.</p> <p>The Quick Add Agent button enables rapid provisioning of selected objects with Agent interfaces. When activated, the system applies Agent-specific mappings to create host configurations, automatically generating Agent interfaces using primary IP addresses, applying appropriate templates, assigning proxies as defined in mappings, and adding hosts to designated host groups. This feature requires that objects have primary IPv4 addresses and valid Agent mappings with available templates.</p> <p>The Quick Add SNMP button provides equivalent functionality for SNMP interface provisioning. Activation triggers creation of host configurations using SNMP-specific mappings, automatic generation of SNMP interfaces with primary IP addresses, application of SNMP-appropriate templates, proxy assignments, host group memberships, and configuration of SNMP settings according to mapping definitions. Like Quick Add Agent, this requires valid SNMP mappings and available templates, along with properly configured primary IP addresses.</p> <p>Both Quick Add features streamline the provisioning process by eliminating manual configuration steps while ensuring consistent application of organizational monitoring policies through predefined mappings. The system automatically queues background jobs to create corresponding hosts in Zabbix and establish the configured interfaces, maintaining synchronization between NetBox and Zabbix without requiring user intervention beyond the initial selection and button click.</p>"},{"location":"user_guide/#maintenance-windows","title":"Maintenance Windows","text":"<p>Maintenance windows provide a mechanism for temporarily suspending monitoring activities during planned downtime or maintenance periods. This functionality prevents false alerts and monitoring noise when systems are intentionally offline for maintenance, upgrades, or repairs.</p> <p>Creating a maintenance window requires several inputs: a descriptive name that identifies the maintenance activity, precise start and end times that define the maintenance period, target selections that determine which infrastructure components are affected, and an optional description that provides context about the maintenance work. The time-based scheduling ensures that monitoring suspension occurs automatically at the appropriate moments without requiring manual intervention.</p> <p>You can target individual hosts for specific device maintenance, entire host groups for broader infrastructure work, sites for location-based maintenance activities or clusters for virtualization environment maintenance. This granular targeting ensures that only the relevant monitoring elements are suspended while maintaining visibility into unaffected infrastructure.</p> <p>During an active maintenance period, the plugin enforces configuration restrictions to maintain the integrity of the maintenance window. Hosts under maintenance cannot have their configuration settings modified, including changes to templates, host groups, proxy assignments, or interface configurations. These restrictions prevent conflicts between ongoing maintenance activities and configuration changes that might interfere with the maintenance process or produce inconsistent monitoring states.</p>"},{"location":"user_guide/#understanding-jobs","title":"Understanding Jobs","text":"<p>The plugin uses background jobs to perform tasks ensuring that time-consuming tasks don't block the user interface. </p> <p>There are two main types of jobs:</p> <ul> <li>System Jobs \u2013 Keep NetBox and Zabbix in sync. Examples include importing Zabbix settings, updating synchronization status, and cleaning up maintenance windows.</li> <li>Host Management Jobs \u2013 Handle individual hosts. This includes creating new hosts with Agent or SNMP interfaces, updating existing hosts, and removing hosts based on deletion rules.</li> </ul>"},{"location":"user_guide/#monitoring-jobs","title":"Monitoring Jobs","text":"<p>You can track jobs and see their progress in several places:</p> <ul> <li>The Jobs section shows all background operations.</li> <li>Individual host pages display job-related information for that host.</li> <li>Notifications inform you when a job finishes or fails.</li> </ul> <p>Each job shows details like progress, completion time, and error messages. This helps administrators confirm that operations completed successfully or quickly diagnose problems if they occur.</p>"},{"location":"user_guide/#common-job-issues","title":"Common Job Issues","text":"<p>Some jobs may fail or get stuck. Common reasons include:</p> <ul> <li>Configuration errors \u2013 Incorrect settings prevent a job from completing.</li> <li>Permission problems \u2013 Zabbix API tokens may lack the needed privileges, or credentials may have expired.</li> <li>Connectivity issues \u2013 Network problems between NetBox and Zabbix can cause timeouts or failures.</li> <li>Resource constraints \u2013 Jobs may get stuck if the system doesn\u2019t have enough resources.</li> </ul> <p>For administrative configuration details, see the Admin Guide. For developers and integrators, see the Programmer's Guide.</p>"},{"location":"vmmapping_model/","title":"VMMapping Model","text":""},{"location":"vmmapping_model/#vmmapping-model","title":"VMMapping Model","text":""},{"location":"vmmapping_model/#overview","title":"Overview","text":"<p>The <code>VMMapping</code> model defines how NetBox VirtualMachine objects should be mapped to Zabbix host configurations, including templates, host groups, proxies, and filtering criteria.</p>"},{"location":"vmmapping_model/#model-definition","title":"Model Definition","text":"<p>VMMapping inherits from the base <code>Mapping</code> model and provides specific functionality for mapping NetBox VirtualMachine objects to Zabbix configurations.</p>"},{"location":"vmmapping_model/#fields","title":"Fields","text":"<p>Inherits all fields from the base <code>Mapping</code> model:</p> Field Type Description Notes <code>name</code> CharField (max_length=255) Name of the mapping Human-readable identifier <code>description</code> TextField Optional description May be blank <code>default</code> BooleanField Whether this is the default mapping Only one default mapping allowed <code>host_groups</code> ManyToManyField (HostGroup) Assigned Host Groups Used for matching hosts <code>templates</code> ManyToManyField (Template) Assigned Templates Multiple templates can be selected <code>proxy</code> ForeignKey (Proxy) Assigned Proxy Optional proxy for matching hosts <code>proxy_group</code> ForeignKey (ProxyGroup) Assigned Proxy Group Optional proxy group for matching hosts <code>interface_type</code> IntegerField Limit mapping to specific interface types Default: Any. Options: Any (0), Agent (1), SNMP (2) <code>sites</code> ManyToManyField (Site) Restrict mapping to specific sites Filter by site <code>roles</code> ManyToManyField (DeviceRole) Restrict mapping to specific VM roles Filter by role <code>platforms</code> ManyToManyField (Platform) Restrict mapping to specific platforms Filter by platform"},{"location":"vmmapping_model/#methods","title":"Methods","text":""},{"location":"vmmapping_model/#get_matching_filtercls-virtual_machine-interface_typeinterfacetypechoicesany","title":"<code>get_matching_filter(cls, virtual_machine, interface_type=InterfaceTypeChoices.Any)</code>","text":"<p>Return the most specific VMMapping that matches a virtual machine based on its characteristics.</p> <p>Parameters: - <code>virtual_machine</code> (VirtualMachine): VM instance to match - <code>interface_type</code> (int): Interface type to filter by (default: Any)</p> <p>Returns: - <code>VMMapping</code>: Matching mapping object</p>"},{"location":"vmmapping_model/#get_matching_virtual_machinesself","title":"<code>get_matching_virtual_machines(self)</code>","text":"<p>Return queryset of VirtualMachines that match this mapping, excluding VMs already covered by more specific mappings.</p> <p>Returns: - <code>QuerySet</code>: Matching VirtualMachine instances</p>"},{"location":"vmmapping_model/#get_absolute_urlself","title":"<code>get_absolute_url(self)</code>","text":"<p>Return URL for the VM mapping detail page in the NetBox UI.</p> <p>Returns: - <code>str</code>: Absolute URL for the VM mapping</p>"},{"location":"vmmapping_model/#usage-examples","title":"Usage Examples","text":""},{"location":"vmmapping_model/#creating-a-basic-vm-mapping","title":"Creating a Basic VM Mapping","text":"<pre><code>from netbox_zabbix.models import VMMapping, HostGroup, Template\n\n# Create a basic VM mapping\nvm_mapping = VMMapping.objects.create(\n    name=\"Linux VMs\",\n    description=\"Mapping for Linux-based virtual machines\",\n    default=False\n)\n\n# Add host groups and templates\nlinux_host_group = HostGroup.objects.get(name=\"Linux Servers\")\ngeneric_template = Template.objects.get(name=\"Template OS Linux by Zabbix agent\")\n\nvm_mapping.host_groups.add(linux_host_group)\nvm_mapping.templates.add(generic_template)\n</code></pre>"},{"location":"vmmapping_model/#creating-a-filtered-vm-mapping","title":"Creating a Filtered VM Mapping","text":"<pre><code>from dcim.models import Site\nfrom virtualization.models import ClusterType, Platform\n\n# Create a mapping for specific sites and platforms\nfiltered_mapping = VMMapping.objects.create(\n    name=\"Production Linux VMs\",\n    description=\"Linux VMs in production environment\"\n)\n\n# Add filters\nproduction_site = Site.objects.get(name=\"Production DC\")\nlinux_platform = Platform.objects.get(name=\"Ubuntu 20.04\")\n\nfiltered_mapping.sites.add(production_site)\nfiltered_mapping.platforms.add(linux_platform)\n</code></pre>"},{"location":"vmmapping_model/#creating-a-default-mapping","title":"Creating a Default Mapping","text":"<pre><code># Create a default mapping that applies to all VMs not matched by specific mappings\ndefault_vm_mapping = VMMapping.objects.create(\n    name=\"Default VM Mapping\",\n    description=\"Default mapping for all unmatched VMs\",\n    default=True\n)\n</code></pre>"},{"location":"vmmapping_model/#finding-matching-mappings","title":"Finding Matching Mappings","text":"<pre><code>from virtualization.models import VirtualMachine\nfrom netbox_zabbix.models import VMMapping\n\n# Find the appropriate mapping for a VM\nvm = VirtualMachine.objects.get(name=\"web-vm-01\")\nmatching_mapping = VMMapping.get_matching_filter(vm)\n\n# Get all VMs that match a specific mapping\nvms = matching_mapping.get_matching_virtual_machines()\n</code></pre>"},{"location":"vmmapping_model/#integration-with-other-models","title":"Integration with Other Models","text":"<p>VMMapping integrates with several other models in the plugin:</p> <ol> <li> <p>HostConfig Model: VM mappings determine which Zabbix configuration is applied to VirtualMachine objects when they are provisioned for monitoring.</p> </li> <li> <p>Template Model: Templates are assigned to VMs through VM mappings.</p> </li> <li> <p>HostGroup Model: Host groups are assigned to VMs through VM mappings.</p> </li> <li> <p>Proxy/ProxyGroup Models: Proxies or proxy groups can be specified for VMs through VM mappings.</p> </li> </ol>"},{"location":"vmmapping_model/#description","title":"Description","text":"<p>VMMapping objects allow administrators to define rules for automatically configuring Zabbix monitoring for NetBox virtual machines based on their characteristics. More specific mappings (those with more filter criteria) take precedence over less specific ones.</p> <p>Mappings can filter virtual machines by: - Site - Role - Platform</p> <p>And can assign: - Templates - Host groups - Proxy or proxy group - Interface type restrictions</p> <p>When a virtual machine matches multiple mappings, the most specific one (with the most restrictive filters) is applied. A default mapping should always exist to catch virtual machines that don't match any specific mapping.</p>"},{"location":"zabbixadminpermission_model/","title":"ZabbixAdminPermission Model","text":""},{"location":"zabbixadminpermission_model/#zabbixadminpermission-model","title":"ZabbixAdminPermission Model","text":""},{"location":"zabbixadminpermission_model/#overview","title":"Overview","text":"<p>The <code>ZabbixAdminPermission</code> model is a simple permission model that defines administrative access rights for the NetBox Zabbix plugin.</p>"},{"location":"zabbixadminpermission_model/#model-definition","title":"Model Definition","text":"<p>The ZabbixAdminPermission model is an empty model that exists solely to define custom permissions. It does not store any data fields but provides a way to grant administrative privileges for plugin operations.</p> <pre><code>class ZabbixAdminPermission(NetBoxModel):\n    class Meta:\n        verbose_name = \"Zabbix Admin Permission\"\n        permissions = [ (\"admin\", \"NetBox-Zabbix plugin administrator\"), ]\n    pass\n</code></pre>"},{"location":"zabbixadminpermission_model/#fields","title":"Fields","text":"<p>The ZabbixAdminPermission model does not define any custom fields. It inherits standard NetBoxModel fields but does not add any additional data storage.</p>"},{"location":"zabbixadminpermission_model/#model-metadata","title":"Model Metadata","text":"<p>The model defines specific metadata options:</p>"},{"location":"zabbixadminpermission_model/#verbose_name","title":"<code>verbose_name</code>","text":"<p>Human-readable name for the model: \"Zabbix Admin Permission\"</p>"},{"location":"zabbixadminpermission_model/#permissions","title":"<code>permissions</code>","text":"<p>Custom permissions defined for the model: [(\"admin\", \"NetBox-Zabbix plugin administrator\")]</p> <p>This single custom permission controls access to administrative features of the plugin and integrates seamlessly with Django's existing permission framework.</p>"},{"location":"zabbixadminpermission_model/#methods","title":"Methods","text":""},{"location":"zabbixadminpermission_model/#__str__","title":"<code>__str__()</code>","text":"<p>Return a string representation of the permission model.</p> <p>Returns: - <code>str</code>: String representation of the permission model</p>"},{"location":"zabbixadminpermission_model/#get_absolute_url","title":"<code>get_absolute_url()</code>","text":"<p>Return the canonical URL for this permission model within the NetBox plugin UI.</p> <p>Returns: - <code>str</code>: Absolute URL for the permission model</p>"},{"location":"zabbixadminpermission_model/#usage-examples","title":"Usage Examples","text":""},{"location":"zabbixadminpermission_model/#checking-permissions","title":"Checking Permissions","text":"<pre><code>from django.contrib.auth.models import User\nfrom netbox_zabbix.models import ZabbixAdminPermission\n\n# Get a user\nuser = User.objects.get(username=\"admin\")\n\n# Check if user has admin permission\nif user.has_perm(\"netbox_zabbix.admin\"):\n    print(\"User has Zabbix admin permission\")\nelse:\n    print(\"User does not have Zabbix admin permission\")\n</code></pre>"},{"location":"zabbixadminpermission_model/#assigning-permissions","title":"Assigning Permissions","text":"<pre><code>from django.contrib.auth.models import Group, Permission\nfrom django.contrib.contenttypes.models import ContentType\nfrom netbox_zabbix.models import ZabbixAdminPermission\n\n# Get the content type for ZabbixAdminPermission\ncontent_type = ContentType.objects.get_for_model(ZabbixAdminPermission)\n\n# Get the admin permission\nadmin_permission = Permission.objects.get(\n    content_type=content_type,\n    codename=\"admin\"\n)\n\n# Assign permission to a group\nadmin_group = Group.objects.get(name=\"Zabbix Admins\")\nadmin_group.permissions.add(admin_permission)\n\n# Assign permission to a user\nuser = User.objects.get(username=\"specific_user\")\nuser.user_permissions.add(admin_permission)\n</code></pre>"},{"location":"zabbixadminpermission_model/#integration-with-other-models","title":"Integration with Other Models","text":"<p>ZabbixAdminPermission integrates with Django's authentication and authorization system:</p> <ol> <li> <p>Django User Model: Permissions can be assigned directly to User objects through the user_permissions relationship.</p> </li> <li> <p>Django Group Model: Permissions can be assigned to Group objects, which can then be assigned to multiple users.</p> </li> <li> <p>Django Permission Model: The custom \"admin\" permission is stored as a standard Django Permission object.</p> </li> </ol>"},{"location":"zabbixadminpermission_model/#description","title":"Description","text":"<p>This model exists solely to define a custom permission that can be assigned to users or groups who need administrative access to the NetBox Zabbix plugin functionality. It does not store any data fields but provides a way to grant administrative privileges for plugin operations.</p> <p>The permission can be assigned through Django's standard permission system, allowing fine-grained control over who can perform administrative tasks within the plugin.</p> <p>Key aspects: - The model is intentionally empty, serving only as a container for permissions - Only one custom permission is defined: \"admin\" with the description \"NetBox-Zabbix plugin administrator\" - This permission controls access to administrative features of the plugin - The permission integrates seamlessly with Django's existing permission framework - Multiple users or groups can be granted this permission independently</p> <p>This approach follows Django best practices for defining custom permissions, using an empty model as a namespace for related permissions rather than attaching permissions directly to functional models.</p>"}]}