# Installation

1. **Install the plugin into your NetBox environment**:

Install the plugin directly from GitHub and ensure the required Zabbix API library is installed:

```bash
pip install git+https://github.com/pergus/netbox-zabbix.git'
pip install pyzabbix==1.3.1
```
Note: This must be done inside the same virtual environment where NetBox is installed.

2. **Add the plugin to NetBox configuration** (`configuration.py`):

Open your NetBox configuration file (usually netbox/netbox/configuration.py) and add:

```python
PLUGINS = [
    'netbox_zabbix',
]
```
If you already have other plugins listed, simply append 'netbox_zabbix'.


3. **Apply database migrations**:

Generate and apply the database migrations for the plugin:

```bash
manage.py makemigrations netbox_zabbix
manage.py migrate netbox_zabbix
```

4. **Run the setup zabbix management command**:
The setup zabbix management command initializes required defaults, mappings, and cryptographic keys.

```bash
manage.py setup_zabbix
```

This interactive command walks the user through two required setup phases,
followed by a required configuration change in configuration.py.


5. **Copy the PLUGINS_CONFIG to NetBox configuration** (`configuration.py`):
Copy the configuration block printed after the setup command and add it to your NetBox configuration.py.

```bash
PLUGINS_CONFIG = {
    'netbox_zabbix': {
        "FERNET_KEY_PATH": "/opt/netbox/netbox-zabbix/netbox_zabbix/fernet.key"
    }
}
```

The FERNET_KEY_PATH must point to the fernet.key file generated by the setup script.
Ensure this path is readable only by the NetBox service user.


6. **Restart NetBox**:
After modifying the configuration or installing plugins, restart all NetBox services:

```bash
sudo systemctl restart netbox netbox-rq
```